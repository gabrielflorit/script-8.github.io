{"version":3,"sources":["images/loshermanosbros-lite.gif","images/breakout-lite.gif","images/brospipe-lite.gif","images/livecoding480.gif","images/slider480.gif","images/pauserewind.gif","images/toggle.gif","images/spritedemo.gif","images/mapdemo.gif","images/musicdemo.gif","iframe/src/colors.js","iframe/src/utils/screenTypes.js","actions/actionTypes.js","iframe/src/blankTemplate.js","iframe/src/store/initialState.js","iframe/src/toLetter.js","iframe/src/gistParsers/phrases.js","utils/throwError.js","iframe/src/utils/runningSum.js","iframe/src/gistParsers/game.js","reducers/game.js","actions/actions.js","containers/Boot.js","containers/Home.js","iframe/src/utils/bios.js","iframe/src/skeleton.js","iframe/src/gistParsers/map.js","iframe/src/gistParsers/sprites.js","iframe/src/gistParsers/chains.js","iframe/src/gistParsers/songs.js","iframe/src/gistParsers/iframeVersion.js","utils/isDirty.js","utils/canRecord.js","utils/setupLinter.js","utils/getGameTitle.js","iframe/src/utils/gameLineToTabLine.js","containers/Output.js","utils/string.js","iframe/src/contextCanvasAPI/circle.js","iframe/src/contextCanvasAPI/line.js","iframe/src/contextCanvasAPI/polyStroke.js","iframe/src/contextCanvasAPI/alphabet.js","iframe/src/contextCanvasAPI/print.js","iframe/src/contextCanvasAPI/sprite.js","iframe/src/contextCanvasAPI/index.js","iframe/src/contextCanvasAPI/pixel.js","containers/Sprite.js","iframe/src/frameBufferCanvasAPI/line.js","iframe/src/frameBufferCanvasAPI/polyStroke.js","iframe/src/frameBufferCanvasAPI/circle.js","iframe/src/frameBufferCanvasAPI/sprite.js","iframe/src/frameBufferCanvasAPI/alphabet.js","iframe/src/frameBufferCanvasAPI/print.js","iframe/src/frameBufferCanvasAPI/index.js","iframe/src/frameBufferCanvasAPI/rect.js","iframe/src/frameBufferCanvasAPI/pixelData.js","containers/Map.js","iframe/src/settings.js","iframe/src/normalize.js","iframe/src/soundAPI/index.js","components/TextInput.js","containers/Phrase.js","containers/Chain.js","containers/Song.js","utils/patcher.js","containers/Tutorial.js","containers/Run.js","utils/commands.js","components/CodeEditor.js","containers/Code.js","containers/Help.js","utils/frecency.js","utils/timeAgo.js","components/ShelfCassettes.js","containers/Shelf.js","containers/Notice.js","containers/Updater.js","utils/isBlank.js","containers/Menu.js","components/TopBar.js","components/ErrorBoundary.js","containers/App.js","reducers/screen.js","reducers/gist.js","reducers/booted.js","reducers/token.js","reducers/nextAction.js","reducers/sprites.js","reducers/map.js","reducers/phrases.js","reducers/chains.js","reducers/songs.js","reducers/tutorial.js","reducers/sound.js","reducers/shelving.js","reducers/docHistories.js","reducers/dismissedNotices.js","reducers/selectedUi.js","reducers/errorLine.js","reducers/iframeVersion.js","reducers/hideMenu.js","reducers/reducer.js","store/store.js","store/localStorage.js","index.js","images/logo.png"],"names":["module","exports","__webpack_require__","p","screenTypes","BOOT","HOME","RUN","HELP","CODE","SPRITE","MAP","SONG","CHAIN","PHRASE","SHELF","cycleOrder","getNextScreen","screen","index","indexOf","length","getPreviousScreen","actionTypes","TOGGLE_MENU","UPDATE_IFRAME_VERSION","SET_ERROR_LINE","CLEAR_TOKEN","SELECT_UI","TOGGLE_SOUND","DISMISS_NOTICES","SET_SCREEN","FETCH_GIST_REQUEST","FETCH_GIST_SUCCESS","FINISH_BOOT","UPDATE_GAME","NEW_GAME","TOKEN_REQUEST","TOKEN_SUCCESS","SET_NEXT_ACTION","CLEAR_NEXT_ACTION","SAVE_GIST_REQUEST","SAVE_GIST_SUCCESS","UPDATE_SFX","UPDATE_SPRITE","UPDATE_MAP","UPDATE_PHRASE","UPDATE_CHAIN","UPDATE_SONG","SET_TUTORIAL_SLIDE","CLOSE_TUTORIAL","SHELVE_CASSETTE_REQUEST","SHELVE_CASSETTE_SUCCESS","UNSHELVE_CASSETTE_REQUEST","UNSHELVE_CASSETTE_SUCCESS","SET_VISIBILITY_REQUEST","SET_VISIBILITY_SUCCESS","COUNTER_CASSETTE_REQUEST","COUNTER_CASSETTE_SUCCESS","SET_SCROLL_DATA","SET_CODE_TAB","UPDATE_HISTORY","blankTemplate","initialState","hideMenu","iframeVersion","version","errorLine","booted","gist","game","0","text","active","key","token","nextAction","sprites","map","phrases","chains","songs","docHistories","dismissedNotices","selectedUi","phrase","chain","song","tutorial","sound","shelving","notes","toLetter","number","includeOctave","normalize","letter","numberToNote","octave","Math","floor","numberToOctave","concat","compressPhrases","_","mapValues","note","noteIndex","volume","join","tempo","isNil","extractGistPhrases","data","JSON","parse","get","stringify","omitEmpty","phraseIsArray","Array","isArray","match","slice","keyBy","d","omit","value","isEmpty","throwError","_ref","error","message","Error","runningSum","array","push","reduce","acc","cur","idx","previous","Object","toConsumableArray","assembleOrderedGame","orderBy","filter","parseGistGame","misc","content","lines","ranges","contentLines","split","objectSpread","defineProperty","apply","assembleMiscLines","range","getActive","keys","handleActions","_handleActions","state","action","payload","toString","_ref2","tab","_ref3","scrollData","actions","createActions","_createActions","IS_NEW_USER","saveGist","_ref7","toFork","dispatch","saveGistRequest","gh","GitHub","preparePayload","id","link","createLink","README","miscJson","public","description","files","sprites.json","map.json","phrases.json","chains.json","songs.json","README.md","gistGame","assembledGistGame","assembledGame","createGist","getGist","create","then","response","saveGistSuccess","user","login","fork","read","catch","update","Boot","_this$props","this","props","fetchGist","setScreen","search","window","location","params","URLSearchParams","shelfUser","_this$props2","counterCassette","isFetching","react_default","a","createElement","className","Component","connect","counterCassetteRequest","fetch","process","json","counterCassetteSuccess","_ref5","fetchGistRequest","fetchGistSuccess","Home","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","handleStartTutorial","bind","assertThisInitialized","handleSeeLessons","handleClickGifs","startTutorial","src","logo","alt","timestamp","href","onClick","loshermanosbrosgif","breakoutgif","brospipegif","classNames","invisible","livecoding480","slider480","pauserewind","toggle","title","width","height","frameBorder","allow","allowFullScreen","spritedemo","mapdemo","musicdemo","setTutorialSlide","lessonIndex","slideIndex","boot","extractGistMap","extractGistSprites","extractGistChains","extractGistSongs","parseGistIframeVersion","isDirty","thisGame","gameIsDirty","equal","mapIsDirty","spritesIsDirty","phrasesIsDirty","chainsIsDirty","songsIsDirty","iframeVersionIsDirty","canRecord","dirty","gistLogin","currentLogin","parseOptions","ecmaVersion","sourceType","locations","InvalidTokenError","loc","raisedAt","name","findInvalidNode","nodes","Promise","resolve","channel","MessageChannel","type","tokens","document","querySelector","contentWindow","postMessage","port2","port1","onmessage","getLintErrors","asyncToGenerator","regenerator_default","mark","_callee","errors","parsed","node","wrap","_context","prev","next","acorn","walk","Identifier","sent","start","end","t0","from","line","ch","column","to","replace","severity","abrupt","stop","_x","arguments","setupLinter","CodeMirror","registerHelper","getGameTitle","trim","toUpperCase","gameLineToTabLine","gameLine","miscLines","sum","findIndex","pair","tabLine","throttledTokenCount","throttle","x","parts","numberWithCommas","tokenizer","Output","handleToggleMenuClick","evaluate","handleClickSize","handleClickError","resize","debounce","handleBlur","addEventListener","showSize","logs","isLoaded","toggleMenu","setState","e","run","currentTarget","focus","setCodeTab","setErrorLine","tabAndTabLine","Date","now","_iframe","prevProps","finishBoot","removeEventListener","_this2","sendPayload","callbacks","undefined","isDoneFetching","callback","_e$data","shortcut","endCallback","console","warn","_this3","_this$state","_this$props3","gameTitle","tokenCount","iframeUrl","in-tutorial","sandbox","onBlur","ref","onLoad","log","_ref4","_ref4$data","position","bios","includes","triplets","rgbStrings","slicedToArray","r","g","b","intLookup","i","values","possiblyNegativeInteger","reverseIntLookup","colors","rgb","triplet","int","lookupInt","circle","cx","cy","radius","ctx","color","onlyStroke","y","dx","dy","err","fillStyle","strokeStyle","drawPixel","fillRect","drawLine","x0","x1","beginPath","moveTo","lineTo","stroke","y1","x2","y2","steep","abs","derror","polyStroke","points","args","c","newPoints","xRot","yRot","midX","midY","cos","PI","sin","xs","ys","min","max","round","alphabet","<",">","/",":","|","(",")","1","2","3","4","5","6","7","8","9"," ",".",",","+","-","!","?","f","h","j","k","l","m","n","o","q","s","t","u","v","w","z","print","letters","pixels","toLowerCase","current","xOffset","yOffset","forEach","grid","imageData","getImageData","pixel","pixelIndex","offset","putImageData","sprite","spriteIndex","_ref$darken","darken","_ref$flipH","flipH","_ref$flipV","flipV","cells","rowIndex","colIndex","clamped","clamp","canvasAPI","canvasWidth","canvasHeight","_ref$map","_runningMap","setTransform","_cameraX","_cameraY","_memoryCanvas","_mCtx","getContext","entries","skey","pixelSprite","_len","_key","getTile","mx","my","tile","result","setTile","spriteNumber","rectStroke","strokeRect","camera","translate","rectFill","resetMap","row","rowNumber","colNumber","sx","sy","drawImage","circStroke","circFill","clear","save","clearRect","restore","getPixel","_ctx$getImageData$dat","alpha","lookup","setPixel","Sprite","draw","handleTypeClick","handleColorClick","handleCanvasClick","handleOnMouseDown","handleOnMouseEnter","handleOnMouseUp","handleOnTouchMove","getCurrentSprite","setMode","colorIndex","mouseDown","mode","_canvas","col","typeIndex","updateSprite","_e$target$dataset","target","dataset","_e$target$dataset2","touchLocation","changedTouches","elementFromPoint","clientX","clientY","str","replacement","newSprite","substr","_this$state2","onMouseUp","onTouchEnd","data-row","data-col","onMouseDown","onMouseEnter","onTouchStart","onTouchMove","hide","thisSpriteIndex","drawPolyStroke","drawCircle","drawReflectedPair","drawSprite","drawText","currentX","currentY","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","letterWidth","return","initialMap","_colorSwaps","newColor","fill","colorSwap","left","right","top","bottom","drawRectStroke","rectX","drawRectFill","pixelData","_pixelData","ImageData","_pixelBuffer","ArrayBuffer","_pixelBytes","Uint8ClampedArray","Uint32Array","writePixelDataToCanvas","set","Map","handleSpriteClick","handleRoomClick","spritePixelData","roomPixelData","drawRoom","mapPixelData","drawMap","getCurrentRoom","roomIndex","drawSprites","spriteCanvasAPI","_spriteCanvas","before","roomCanvasAPI","rowN","colN","_roomCanvas","after","_this4","mapCanvasAPI","_mapCanvas","updateMap","newMap","createBlankMap","_this5","thisRoomIndex","settings","octaves","volumes","matrixLength","chainChannels","startOffset","startOffsetDouble","bpm","subdivision","vol","pulseOptions","oscillator","envelope","release","tempoToPlaybackRate","createSynth","volumeNode","pulseSynth","Tone","playNote","_ref$time","time","currentTime","synth","normalizedVolume","tempoToSubdivision","triggerAttackRelease","TextInput","label","handleChange","options","assign","onChange","getCurrentPhrase","Phrase","createSequence","handleTempoChange","handlePhraseIndexChange","handleNoteClick","handleVolumeClick","handlePlay","drawCallback","isPlaying","playingIndex","resume","sequence","playbackRate","schedule","_e$target","validity","valid","updatePhrase","phraseIndex","_e$target2","selectUi","newPosition","newNote","_this$props4","oldPhrase","newPhrase","components_TextInput","highlighter","highlight","synths","Chain","handleChainIndexChange","handlePhraseClick","getCurrentChain","_$padStart$split$map","padStart","parseInt","_$padStart$split$map2","phrasePosition","notePosition","phrasesIndices","noteElement","pow","updateChain","chainIndex","newChain","cloneDeep","allPhrases","sortBy","uniq","last","newPhraseIndex","setWith","Song","handleSongIndexChange","handleChainClick","getCurrentSong","chainPosition","updateSong","songIndex","sortedChains","newChainIndex","patcher","slides","accumulator","deleteOne","deleteRange","replaceOne","replaceRange","add","same","lineNumberToDelete","lineNumberToDeleteStart","lineNumberToDeleteEnd","lineNumberToReplaceStart","lineNumberToReplaceEnd","substring","lineNumberToReplace","lineNumberToAdd","areRequirementsMet","requirements","every","Tutorial","handleClose","handlePrevious","handleNextSlide","handleNextLesson","handleSlide","fireActions","buttonsElement","setButtonsRef","_ref6","updateGame","lessons","slide","slideScreen","slideMap","patchedGame","_d$split","_d$split2","prevState","scrollIntoView","closeTutorial","_ref8","_this$props$tutorial","newGameOnNext","newGame","_this$props$tutorial2","tutorialRef","_lessons$lessonIndex","close","enableNextSlide","nextSlide","disabled","nextLesson","buttons","progress","in-run","code","startsWith","dangerouslySetInnerHTML","__html","Run","commands","cm","spaces","getOption","replaceSelection","comment","toggleComment","format","setContents","oldCode","getValue","indexFromPos","getCursor","_prettier$formatWithC","prettier","formatWithCursor","cursorOffset","parser","plugins","babel","prettierParser","semi","singleQuote","prettierOpts","formatted","newCursor","posFromIndex","setCursor","platform","navigator","CodeEditor","handleSlider","activateSlider","hideSlider","highlightText","activeGame","codeMirror","_editor","theme","lint","lineNumbers","tabSize","cursorBlinkRate","scrollbarStyle","extraKeys","Tab","Cmd-/","Ctrl-/","Alt-F","Esc","docHistory","getDoc","setHistory","clearHistory","on","classList","updateContent","scrollTo","cursorPosition","_slider","firstLine","lastLine","cmLines","getLine","whiteSpaces","defaultCharWidth","defaultTextHeight","remove","addWidget","_highlighterBox","style","cursor","getTokenAt","markText","middleCoords","charCoords","wrapperRect","_wrapper","getBoundingClientRect","string","valueNumber","_this$mark$find","find","newToken","setValue","refresh","nextProps","linesToHighlight","updateHistory","history","getHistory","oldScrollInfo","getScrollInfo","oldCursorPosition","setScrollData","counter","isReady","setInterval","clearInterval","scrollInfo","step","onInput","Code","handleTabUpdates","components_CodeEditor","Help","handleLesson","setLessonIndex","lesson","shortTitle","howTo","dt","dd","react","shortcuts","apiDocs","section","dl","parseDate","mdy","frecency","visits","date","first","second","daysAgo","getScore","times","timeAgo","diff","ShelfCassettes","renderCassette","handleNext","cassette","handleOnClick","tokenLogin","handleSetVisibility","handleRemove","isPrivate","tooLong","finalTitle","updated","rel","cover","gistId","cassettes","showAllButton","handleOnShowAllClick","defaultProps","Shelf","fetchCassettes","makeShelfCassettes","fetching","popularCassettes","recentCassettes","_isMounted","method","body","yourPrivateCassettes","reverse","score","yourPublicCassettes","isFork","pushState","preventDefault","setVisibility","unshelveCassette","confirm","components_ShelfCassettes","userPublicCassettes","shelveCassetteRequest","shelveCassetteSuccess","setVisibilityRequest","setVisibilitySuccess","Notice","handleDismissNotices","dismissNotices","notices","newNoticeIds","difference","notice","Updater","updateUrl","oldId","newId","isBlank","Menu","keydown","onExport","onRecordClick","onLoginClick","onInsertBlankClick","onPutOnShelfClick","record","onClose","onUpdateIframeVersion","script8","handleCode","fetchToken","clearNextAction","event","altKey","metaKey","ctrlKey","codeTab","updateIframeVersion","html","element","setAttribute","encodeURIComponent","display","appendChild","click","removeChild","downloadHtml","returnValue","_this$props5","clearToken","open","_this$props6","_this$props7","putOnShelf","gistUser","iframe","_this$props8","setNextAction","_this$props9","_this$props10","toggleSound","blank","contentIsEmpty","enableInsertBlank","enableRecord","enableRecordToFork","isMine","canShelve","isMusicScreen","isArtScreen","codeTabSuffix","loggedIn","canUpdateIframeVersion","is-fetching","tokenRequest","getUser","getProfile","tokenSuccess","TopBar","show","containers_Updater","containers_Menu","ErrorBoundary","hasError","errorInfo","whiteSpace","componentStack","children","shouldShowNotice","_options","containers_Boot","containers_Home","containers_Sprite","containers_Map","containers_Phrase","containers_Chain","containers_Song","containers_Run","containers_Code","containers_Help","containers_Shelf","App","tutorialElement","React","createRef","appElement","setAppElementRef","clientHeight","paddingBottom","showNotice","components_ErrorBoundary","full-height","components_TopBar","containers_Output","containers_Tutorial","in-RUN","containers_Notice","gist_handleActions","token_handleActions","nextAction_handleActions","sprites_handleActions","map_handleActions","phrases_handleActions","chains_handleActions","songs_handleActions","tutorial_handleActions","shelving_handleActions","docHistories_handleActions","iframeVersion_handleActions","hideMenu_handleActions","reducer","combineReducers","persistedState","serializedState","localStorage","getItem","loadState","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunkMiddleware","subscribe","setItem","saveState","getState","render","es","containers_App","getElementById"],"mappings":"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","file":"static/js/main.623c64fa.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/loshermanosbros-lite.c3b13663.gif\";","module.exports = __webpack_public_path__ + \"static/media/breakout-lite.a4d778a2.gif\";","module.exports = __webpack_public_path__ + \"static/media/brospipe-lite.82f3b93a.gif\";","module.exports = __webpack_public_path__ + \"static/media/livecoding480.20d1866a.gif\";","module.exports = __webpack_public_path__ + \"static/media/slider480.dc4d8c4b.gif\";","module.exports = __webpack_public_path__ + \"static/media/pauserewind.741e69fa.gif\";","module.exports = __webpack_public_path__ + \"static/media/toggle.4ab6d6b6.gif\";","module.exports = __webpack_public_path__ + \"static/media/spritedemo.76159464.gif\";","module.exports = __webpack_public_path__ + \"static/media/mapdemo.23680514.gif\";","module.exports = __webpack_public_path__ + \"static/media/musicdemo.c1b0f3bd.gif\";","// Lookup table for triplet arrays containing R, G, and B values.\nconst triplets = [\n  [246, 214, 189],\n  [195, 163, 138],\n  [153, 117, 119],\n  [129, 98, 113],\n  [78, 73, 95],\n  [32, 57, 79],\n  [15, 42, 63],\n  [8, 20, 30]\n]\n\n// Lookup table for the css color strings.\nconst rgbStrings = triplets.map(([r, g, b]) => `rgb(${r},${g},${b})`)\n\n// Lookup tree for the combined integer representation of each color.\nlet intLookup = []\n\n// Loops over each of the color indexes, looks up associated color triplet, and\n// calculates the equivalent integer representation by bit shifting each byte\n// into the correct position.\nfor (let i = 0; i < 8; i++) {\n  let values = triplets[i]\n\n  // Shift each byte into the correct integer position.\n  let possiblyNegativeInteger =\n    (255 << 24) | // Alpha byte\n    (values[2] << 16) | // B byte\n    (values[1] << 8) | // G byte\n    values[0] // R byte\n\n  // Set the positive version of the above calculated integer into the lookup\n  // table. A bitwise right shift of 0 places forces the number to be\n  // interpreted as a positive integer.\n  intLookup[i] = possiblyNegativeInteger >>> 0\n\n  // For example, intLookup[0] = 4290631414.\n}\n\n// The opposite of the intLookup. Each index is the color integer, and the value\n// is the SCRIPT-8 integer color.\nconst reverseIntLookup = {}\nfor (let i = 0; i < 8; i++) {\n  reverseIntLookup[intLookup[i]] = i\n}\n\nconst colors = {\n  rgb(i) {\n    return rgbStrings[i % rgbStrings.length]\n  },\n\n  triplet(i) {\n    return triplets[i % triplets.length]\n  },\n\n  int(i) {\n    return intLookup[i % intLookup.length]\n  },\n\n  // Looks up the integer value in the reverseIntLookup table. If it doesn't\n  // exist, then the background color of 7 is returned instead.\n  lookupInt(int) {\n    if (int in reverseIntLookup) {\n      return reverseIntLookup[int]\n    }\n    return 7\n  }\n}\n\nexport default colors\n","const screenTypes = {\n  BOOT: 'BOOT',\n  HOME: 'HOME',\n  RUN: 'RUN',\n  HELP: 'HELP',\n  CODE: 'CODE',\n  SPRITE: 'SPRITE',\n  MAP: 'MAP',\n  SONG: 'SONG',\n  CHAIN: 'CHAIN',\n  PHRASE: 'PHRASE',\n  SHELF: 'SHELF'\n}\n\nconst cycleOrder = [\n  screenTypes.HOME,\n  screenTypes.CODE,\n  screenTypes.SPRITE,\n  screenTypes.MAP,\n  screenTypes.PHRASE,\n  screenTypes.CHAIN,\n  screenTypes.SONG,\n  screenTypes.HELP,\n  screenTypes.SHELF,\n  screenTypes.RUN\n]\n\nconst getNextScreen = screen => {\n  const index = cycleOrder.indexOf(screen)\n  return cycleOrder[(index + 1) % cycleOrder.length]\n}\n\nconst getPreviousScreen = screen => {\n  const index = cycleOrder.indexOf(screen)\n  return cycleOrder[(index - 1 + cycleOrder.length) % cycleOrder.length]\n}\n\nexport { getNextScreen, getPreviousScreen }\n\nexport default screenTypes\n","const actionTypes = {\n  TOGGLE_MENU: 'TOGGLE_MENU',\n  UPDATE_IFRAME_VERSION: 'UPDATE_IFRAME_VERSION',\n  SET_ERROR_LINE: 'SET_ERROR_LINE',\n  CLEAR_TOKEN: 'CLEAR_TOKEN',\n  SELECT_UI: 'SELECT_UI',\n  TOGGLE_SOUND: 'TOGGLE_SOUND',\n  DISMISS_NOTICES: 'DISMISS_NOTICES',\n  SET_SCREEN: 'SET_SCREEN',\n  FETCH_GIST_REQUEST: 'FETCH_GIST_REQUEST',\n  FETCH_GIST_SUCCESS: 'FETCH_GIST_SUCCESS',\n  FINISH_BOOT: 'FINISH_BOOT',\n  UPDATE_GAME: 'UPDATE_GAME',\n  NEW_GAME: 'NEW_GAME',\n  TOKEN_REQUEST: 'TOKEN_REQUEST',\n  TOKEN_SUCCESS: 'TOKEN_SUCCESS',\n  SET_NEXT_ACTION: 'SET_NEXT_ACTION',\n  CLEAR_NEXT_ACTION: 'CLEAR_NEXT_ACTION',\n  SAVE_GIST_REQUEST: 'SAVE_GIST_REQUEST',\n  SAVE_GIST_SUCCESS: 'SAVE_GIST_SUCCESS',\n  UPDATE_SFX: 'UPDATE_SFX',\n  UPDATE_SPRITE: 'UPDATE_SPRITE',\n  UPDATE_MAP: 'UPDATE_MAP',\n  UPDATE_PHRASE: 'UPDATE_PHRASE',\n  UPDATE_CHAIN: 'UPDATE_CHAIN',\n  UPDATE_SONG: 'UPDATE_SONG',\n  SET_TUTORIAL_SLIDE: 'SET_TUTORIAL_SLIDE',\n  CLOSE_TUTORIAL: 'CLOSE_TUTORIAL',\n  SHELVE_CASSETTE_REQUEST: 'SHELVE_CASSETTE_REQUEST',\n  SHELVE_CASSETTE_SUCCESS: 'SHELVE_CASSETTE_SUCCESS',\n  UNSHELVE_CASSETTE_REQUEST: 'UNSHELVE_CASSETTE_REQUEST',\n  UNSHELVE_CASSETTE_SUCCESS: 'UNSHELVE_CASSETTE_SUCCESS',\n  SET_VISIBILITY_REQUEST: 'SET_VISIBILITY_REQUEST',\n  SET_VISIBILITY_SUCCESS: 'SET_VISIBILITY_SUCCESS',\n  COUNTER_CASSETTE_REQUEST: 'COUNTER_CASSETTE_REQUEST',\n  COUNTER_CASSETTE_SUCCESS: 'COUNTER_CASSETTE_SUCCESS',\n  SET_SCROLL_DATA: 'SET_SCROLL_DATA',\n  SET_CODE_TAB: 'SET_CODE_TAB',\n  UPDATE_HISTORY: 'UPDATE_HISTORY'\n}\n\nexport default actionTypes\n","export default `init = state => {\n}\n\nupdate = (state, input, elapsed) => {\n}\n\ndraw = state => {\n}`\n","import screenTypes from '../utils/screenTypes.js'\nimport blankTemplate from '../blankTemplate.js'\nimport { version } from '../../package.json'\n\n// TODO: why do we have to make game keys?\nconst initialState = {\n  hideMenu: true,\n  iframeVersion: version,\n  errorLine: null,\n  screen: screenTypes.BOOT,\n  // screen: screenTypes.HOME,\n  booted: false,\n  gist: {},\n  game: {\n    0: {\n      text: blankTemplate,\n      active: true,\n      key: 0\n    }\n  },\n  token: {},\n  nextAction: null,\n  sprites: {},\n  map: [],\n  phrases: {},\n  chains: {},\n  songs: {},\n  docHistories: {},\n  dismissedNotices: [],\n  selectedUi: {\n    phrase: 0,\n    chain: 0,\n    song: 0\n  },\n  // tutorial: {\n  //   lessonIndex: 1,\n  //   slideIndex: 0\n  // },\n  tutorial: null,\n  sound: true,\n  shelving: false\n}\n\nexport default initialState\n","const notes = ['c', 'c#', 'd', 'd#', 'e', 'f', 'f#', 'g', 'g#', 'a', 'a#', 'b']\n\nconst numberToNote = number => notes[number % notes.length]\n\nconst numberToOctave = number => Math.floor(number / notes.length)\n\nconst toLetter = (number, includeOctave, normalize) => {\n  const letter = numberToNote(number)\n  const octave = numberToOctave(number) + (normalize ? 2 : 0)\n  return !includeOctave ? letter : `${letter}${octave}`\n}\n\nconst letterToNumber = letter => notes.indexOf(letter)\n\nexport { numberToOctave, letterToNumber }\n\nexport default toLetter\n","import _ from 'lodash'\nimport omitEmpty from 'omit-empty'\nimport initialState from '../store/initialState.js'\nimport toLetter, { letterToNumber } from '../toLetter.js'\n\nconst compressPhrases = phrases => {\n  const result = _.mapValues(phrases, phrase => {\n    const notes = _.map(phrase.notes, (note, noteIndex) =>\n      [noteIndex, toLetter(note.note), note.octave, note.volume].join('')\n    )\n    return {\n      notes,\n      tempo: _.isNil(phrase.tempo) ? 0 : phrase.tempo\n    }\n  })\n  return result\n}\n\nconst expandPhrases = phrases => {\n  // `phrases` is an object, e.g. (old style)\n  // {\n  //   \"0\": [\n  //     \"0f17\",\n  //     \"1g17\",\n  //     \"2a17\",\n\n  const result = omitEmpty(\n    _.mapValues(phrases, phrase => {\n      // If phrase is an array, it's an old kind. We have to convert it.\n      const phraseIsArray = Array.isArray(phrase)\n      const notes = _(phraseIsArray ? phrase : phrase.notes)\n        .map(note => note.match(/^(\\d+)(.*)(\\d)(\\d)/).slice(1, 5))\n        .map(match => ({\n          index: match[0],\n          note: letterToNumber(match[1]),\n          octave: +match[2],\n          volume: +match[3]\n        }))\n        .keyBy('index')\n        .mapValues(d => _.omit(d, 'index'))\n        .value()\n\n      return _.isEmpty(notes)\n        ? null\n        : {\n            notes,\n            tempo: phraseIsArray ? 0 : _.isNil(phrase.tempo) ? 0 : phrase.tempo\n          }\n    })\n  )\n\n  return result\n}\n\nconst extractGistPhrases = data =>\n  expandPhrases(\n    JSON.parse(\n      _.get(\n        data,\n        'files[\"phrases.json\"].content',\n        JSON.stringify(initialState.phrases, null, 2)\n      )\n    )\n  )\n\nexport { extractGistPhrases, compressPhrases, expandPhrases }\n","const throwError = ({ error, message }) => {\n  error.message = [error.message, message].join('. ')\n  throw new Error(error)\n}\n\nexport default throwError\n","const runningSum = array => {\n  if (!array.length) array.push(0)\n  return array.reduce((acc, cur, idx) => {\n    if (idx > 0) {\n      const previous = acc[idx - 1]\n      return [...acc, [previous[1], previous[1] + cur]]\n    } else {\n      return [[0, cur]]\n    }\n  }, [])\n}\n\nexport default runningSum\n","import _ from 'lodash'\nimport runningSum from '../utils/runningSum.js'\n\nconst assembleOrderedGame = game =>\n  _(game)\n    .orderBy((value, key) => key)\n    .map('text')\n    .filter(d => !_.isEmpty(d))\n    .value()\n    .join('\\n')\n\nconst parseGistGame = data => {\n  const misc = JSON.parse(_.get(data, 'files[\"misc.json\"].content', '{}'))\n  const content = _.get(data, 'files[\"code.js\"].content', '')\n  if (misc.lines) {\n    const ranges = runningSum(misc.lines)\n    const contentLines = content.split('\\n')\n    return ranges.reduce(\n      (acc, cur, idx) => ({\n        ...acc,\n        [idx]: {\n          text: contentLines.slice(...cur).join('\\n'),\n          active: idx === 0,\n          key: idx\n        }\n      }),\n      {}\n    )\n  } else {\n    return {\n      0: {\n        text: content,\n        active: true,\n        key: 0\n      }\n    }\n  }\n}\n\nexport { parseGistGame, assembleOrderedGame }\n","import _ from 'lodash'\nimport { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\nimport blankTemplate from '../iframe/src/blankTemplate.js'\nimport { parseGistGame } from '../iframe/src/gistParsers/game.js'\n\nconst assembleMiscLines = game =>\n  _.range(8).map(d => {\n    if (game[d] && game[d].text) {\n      return game[d].text.split('\\n').length\n    } else {\n      return 0\n    }\n  })\n\nconst getActive = game => ({\n  ...game[Object.keys(game).filter(key => game[key].active)],\n  key: Object.keys(game).filter(key => game[key].active)[0]\n})\n\nconst game = handleActions(\n  {\n    [actionTypes.NEW_GAME]: (state, action) =>\n      action.payload === screenTypes.CODE\n        ? { 0: { text: 'SCRIPT-8 NEW', active: true, key: 0 } }\n        : { 0: { text: blankTemplate, active: true, key: 0 } },\n\n    [actionTypes.SET_CODE_TAB]: (state, { payload }) =>\n      _.mapValues(\n        {\n          ...state,\n          [payload]: { ...state[payload], key: payload, active: true }\n        },\n        (value, key) => ({\n          ...value,\n          active: key === payload.toString()\n        })\n      ),\n\n    [actionTypes.UPDATE_GAME]: (state, { payload }) => ({\n      ...state,\n      [payload.tab]: {\n        ...state[payload.tab],\n        text: payload.content\n      }\n    }),\n\n    [actionTypes.SET_SCROLL_DATA]: (state, { payload }) => ({\n      ...state,\n      [payload.tab]: { ...state[payload.tab], scrollData: payload.scrollData }\n    }),\n\n    [actionTypes.FETCH_GIST_SUCCESS]: (state, action) =>\n      parseGistGame(action.payload)\n  },\n  initialState.game\n)\n\nexport default game\nexport { getActive, assembleMiscLines }\n","import { createActions } from 'redux-actions'\nimport GitHub from 'github-api'\nimport _ from 'lodash'\nimport actionTypes from './actionTypes.js'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\nimport { compressPhrases } from '../iframe/src/gistParsers/phrases.js'\nimport throwError from '../utils/throwError.js'\nimport { assembleMiscLines } from '../reducers/game.js'\nimport {\n  parseGistGame,\n  assembleOrderedGame\n} from '../iframe/src/gistParsers/game.js'\n\nconst actions = createActions({\n  [actionTypes.TOGGLE_MENU]: () => {},\n  [actionTypes.UPDATE_IFRAME_VERSION]: () => {},\n  [actionTypes.SET_ERROR_LINE]: d => d,\n  [actionTypes.CLEAR_TOKEN]: () => {},\n  [actionTypes.SELECT_UI]: d => d,\n  [actionTypes.DISMISS_NOTICES]: d => d,\n  [actionTypes.TOGGLE_SOUND]: () => {},\n  [actionTypes.SET_SCREEN]: d => d,\n  [actionTypes.FETCH_GIST_REQUEST]: () => {},\n  [actionTypes.FETCH_GIST_SUCCESS]: d => d,\n  [actionTypes.FINISH_BOOT]: () => {},\n  [actionTypes.UPDATE_GAME]: d => d,\n  [actionTypes.NEW_GAME]: d => d,\n  [actionTypes.TOKEN_REQUEST]: () => {},\n  [actionTypes.TOKEN_SUCCESS]: d => d,\n  [actionTypes.SET_NEXT_ACTION]: d => d,\n  [actionTypes.CLEAR_NEXT_ACTION]: () => {},\n  [actionTypes.SAVE_GIST_REQUEST]: () => {},\n  [actionTypes.SAVE_GIST_SUCCESS]: d => d,\n  [actionTypes.UPDATE_SFX]: d => d,\n  [actionTypes.UPDATE_SPRITE]: d => d,\n  [actionTypes.UPDATE_MAP]: d => d,\n  [actionTypes.UPDATE_PHRASE]: d => d,\n  [actionTypes.UPDATE_CHAIN]: d => d,\n  [actionTypes.UPDATE_SONG]: d => d,\n  [actionTypes.IS_NEW_USER]: () => {},\n  [actionTypes.SET_TUTORIAL_SLIDE]: d => d,\n  [actionTypes.CLOSE_TUTORIAL]: () => {},\n  [actionTypes.SHELVE_CASSETTE_REQUEST]: () => {},\n  [actionTypes.SHELVE_CASSETTE_SUCCESS]: d => d,\n  [actionTypes.UNSHELVE_CASSETTE_REQUEST]: () => {},\n  [actionTypes.UNSHELVE_CASSETTE_SUCCESS]: d => d,\n  [actionTypes.SET_VISIBILITY_REQUEST]: d => d,\n  [actionTypes.SET_VISIBILITY_SUCCESS]: d => d,\n  [actionTypes.COUNTER_CASSETTE_REQUEST]: () => {},\n  [actionTypes.COUNTER_CASSETTE_SUCCESS]: d => d,\n  [actionTypes.SET_SCROLL_DATA]: d => d,\n  [actionTypes.SET_CODE_TAB]: d => d,\n  [actionTypes.UPDATE_HISTORY]: d => d\n})\n\nexport default actions\n\nexport const counterCassette = ({ id }) => dispatch => {\n  dispatch(actions.counterCassetteRequest())\n\n  return window\n    .fetch(`${process.env.REACT_APP_NOW}/counter/${id}`)\n    .then(response => response.json())\n    .then(json => dispatch(actions.counterCassetteSuccess(json)))\n    .catch(error =>\n      throwError({\n        error,\n        message: `Could not increase counter from the hosted oauth service.`\n      })\n    )\n}\n\nexport const setVisibility = ({ token, gistId, isPrivate }) => dispatch => {\n  dispatch(actions.setVisibilityRequest())\n\n  return window\n    .fetch(`${process.env.REACT_APP_NOW}/set-visibility`, {\n      method: 'POST',\n      body: JSON.stringify({\n        token: token.value,\n        gist: gistId,\n        isPrivate\n      })\n    })\n    .then(\n      response => response.json(),\n      error =>\n        throwError({\n          error,\n          message: `Could not set visibility.`\n        })\n    )\n    .then(() => dispatch(actions.setVisibilitySuccess()))\n}\n\nexport const unshelveCassette = ({ token, gistId }) => dispatch => {\n  dispatch(actions.shelveCassetteRequest())\n\n  return window\n    .fetch(`${process.env.REACT_APP_NOW}/delete`, {\n      method: 'POST',\n      body: JSON.stringify({\n        token: token.value,\n        gist: gistId\n      })\n    })\n    .then(\n      response => response.json(),\n      error =>\n        throwError({\n          error,\n          message: `Could not delete.`\n        })\n    )\n    .then(() => dispatch(actions.shelveCassetteSuccess()))\n}\n\nexport const putOnShelf = ({\n  user,\n  gist,\n  cover,\n  title,\n  isFork,\n  isPrivate,\n  token\n}) => dispatch => {\n  dispatch(actions.shelveCassetteRequest())\n\n  return window\n    .fetch(`${process.env.REACT_APP_NOW}/cassette`, {\n      method: 'POST',\n      body: JSON.stringify({\n        user,\n        gist,\n        cover,\n        title,\n        isFork,\n        isPrivate,\n        token: token.value\n      })\n    })\n    .then(\n      response => response.json(),\n      error =>\n        throwError({\n          error,\n          message: `Could not post cassette via appspot service.`\n        })\n    )\n    .then(() => dispatch(actions.shelveCassetteSuccess()))\n    .then(() => dispatch(actions.setScreen(screenTypes.SHELF)))\n}\n\nexport const fetchGist = ({ id, token }) => dispatch => {\n  dispatch(actions.fetchGistRequest())\n\n  if (token && token.value) {\n    const gh = new GitHub({ token: token.value })\n    return gh\n      .getGist(id)\n      .read()\n      .then(\n        response => response.data,\n        error =>\n          throwError({\n            error,\n            message: `Could not fetch gist ${id} from GitHub while using an oauth token.`\n          })\n      )\n      .then(json => dispatch(actions.fetchGistSuccess(json)))\n  } else {\n    return window\n      .fetch(`${process.env.REACT_APP_NOW}/gist/${id}`)\n      .then(response => response.json())\n      .then(json => dispatch(actions.fetchGistSuccess(json)))\n      .catch(error =>\n        throwError({\n          error,\n          message: `Could not fetch gist ${id} from the hosted oauth service.`\n        })\n      )\n  }\n}\n\nexport const fetchToken = code => dispatch => {\n  dispatch(actions.tokenRequest())\n\n  return window\n    .fetch(`${process.env.REACT_APP_AUTHENTICATOR}/authenticate/${code}`)\n    .then(\n      response => response.json(),\n      error => throwError({ error, message: 'Could not fetch oauth token.' })\n    )\n    .then(({ token }) => {\n      const gh = new GitHub({ token })\n\n      return gh\n        .getUser()\n        .getProfile()\n        .then(\n          response => ({\n            token,\n            user: response.data\n          }),\n          error =>\n            throwError({\n              error,\n              message: 'Could not fetch GitHub user despite valid oauth token.'\n            })\n        )\n    })\n    .then(json => dispatch(actions.tokenSuccess(json)))\n}\n\nexport const saveGist = ({\n  iframeVersion,\n  toFork,\n  game,\n  token,\n  gist,\n  sprites,\n  map,\n  phrases,\n  chains,\n  songs\n}) => dispatch => {\n  dispatch(actions.saveGistRequest())\n\n  const gh = new GitHub({\n    token: token.value\n  })\n\n  const createLink = id =>\n    id ? ` Click [here](https://script-8.github.io/?id=${id}) to boot it.` : ''\n\n  const preparePayload = id => {\n    const link = createLink(id)\n    const README = `This is a [SCRIPT-8](https://script-8.github.io) cassette.${link}`\n\n    const miscJson = {\n      iframeVersion\n    }\n\n    let payload = {\n      public: true,\n      description: 'SCRIPT-8',\n      files: {\n        'sprites.json': {\n          content: JSON.stringify(sprites, null, 2)\n        },\n        'map.json': {\n          content: JSON.stringify(map, null, 2)\n        },\n        'phrases.json': {\n          content: JSON.stringify(compressPhrases(phrases), null, 2)\n        },\n        'chains.json': {\n          content: JSON.stringify(chains, null, 2)\n        },\n        'songs.json': {\n          content: JSON.stringify(songs, null, 2)\n        },\n        'README.md': {\n          content: README\n        }\n      }\n    }\n\n    const gistGame = parseGistGame(gist.data)\n    const assembledGistGame = assembleOrderedGame(gistGame)\n    const assembledGame = assembleOrderedGame(game)\n\n    // If game has length, send it.\n    if (assembledGame.length) {\n      payload.files['code.js'] = {\n        content: assembledGame\n      }\n      miscJson.lines = assembleMiscLines(game)\n    } else {\n      // So the game has no length.\n      // But if the previous gist had game,\n      // send 'code.js': null.\n      if (assembledGistGame.length) {\n        payload.files['code.js'] = null\n      }\n    }\n\n    payload.files['misc.json'] = {\n      content: JSON.stringify(miscJson, null, 2)\n    }\n\n    return payload\n  }\n\n  const createGist = () =>\n    gh\n      .getGist()\n      .create(preparePayload())\n      .then(\n        response => response.data,\n        error => throwError({ error, message: 'Could not create gist.' })\n      )\n      .then(data => dispatch(actions.saveGistSuccess(data)))\n\n  const updateGist = () =>\n    gh\n      .getGist(gist.data.id)\n      .update(preparePayload(gist.data.id))\n      .then(\n        response => response.data,\n        error => throwError({ error, message: 'Could not update gist.' })\n      )\n      .then(data => dispatch(actions.saveGistSuccess(data)))\n\n  const forkGist = () =>\n    gh\n      .getGist(gist.data.id)\n      .fork()\n      .then(response => response.data.id)\n      .then(id => gh.getGist(id).read())\n      .then(response => response.data)\n      .then(data => dispatch(actions.saveGistSuccess(data)))\n      .catch(error =>\n        throwError({\n          error,\n          message: `Could not fork gist ${\n            gist.data.id\n          } from the hosted oauth service.`\n        })\n      )\n\n  // If there is no gist, create it.\n  if (!gist.data) {\n    return createGist()\n  } else if (toFork) {\n    // If we want to record to blank,\n    // if it's ours, create a new one.\n    if (_.get(gist, 'data.owner.login', null) === token.user.login) {\n      return createGist()\n    } else {\n      // If it's not ours, fork it.\n      return forkGist()\n    }\n  } else {\n    // If there is a gist, and it is ours,\n    if (_.get(gist, 'data.owner.login', null) === token.user.login) {\n      // update it.\n      return updateGist()\n    } else {\n      // If it is not ours, create it.\n      return createGist()\n    }\n  }\n}\n","import React, { Component } from 'react'\nimport _ from 'lodash'\nimport { connect } from 'react-redux'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\nimport actions, { fetchGist, counterCassette } from '../actions/actions.js'\n\nconst mapStateToProps = ({ gist, booted, token }) => ({\n  gist,\n  booted,\n  token\n})\n\nconst mapDispatchToProps = dispatch => ({\n  setScreen: screen => dispatch(actions.setScreen(screen)),\n  counterCassette: id => dispatch(counterCassette({ id })),\n  fetchGist: ({ id, token }) => dispatch(fetchGist({ id, token }))\n})\n\nclass Boot extends Component {\n  componentDidMount() {\n    const { fetchGist, token, setScreen } = this.props\n\n    const { search } = window.location\n    const params = new window.URLSearchParams(search)\n    const id = params.get('id')\n    const shelfUser = params.get('shelf')\n    // If there's an id in the query string,\n    if (id) {\n      // try fetching the gist.\n      fetchGist({ id, token })\n    } else if (shelfUser) {\n      // If there's a user in the query string,\n      // show shelf.\n      setScreen(screenTypes.SHELF)\n    } else {\n      // If there is no id,\n      // show home.\n      setScreen(screenTypes.HOME)\n    }\n  }\n\n  componentDidUpdate() {\n    const { gist, setScreen, booted, counterCassette, token } = this.props\n\n    // If we are done fetching, and we have a gist,\n    // AND we are done booting,\n    if (!gist.isFetching && gist.data && booted) {\n      // set screen to RUN,\n      setScreen(screenTypes.RUN)\n\n      const tokenLogin = _.get(token, 'user.login', null)\n      const gistLogin = _.get(gist, 'data.owner.login', null)\n      if (tokenLogin !== gistLogin) {\n        // and if this is not our cassette,\n        // increment cassette hit counter.\n        counterCassette(gist.data.id)\n      }\n    }\n  }\n\n  render() {\n    return <div className=\"Boot\" />\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Boot)\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport classNames from 'classnames'\nimport actions from '../actions/actions.js'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\nimport logo from '../images/logo.png'\nimport { timestamp } from '../utils/timestamp.json'\nimport loshermanosbrosgif from '../images/loshermanosbros-lite.gif'\nimport breakoutgif from '../images/breakout-lite.gif'\nimport brospipegif from '../images/brospipe-lite.gif'\nimport livecoding480 from '../images/livecoding480.gif'\nimport slider480 from '../images/slider480.gif'\nimport pauserewind from '../images/pauserewind.gif'\nimport toggle from '../images/toggle.gif'\nimport spritedemo from '../images/spritedemo.gif'\nimport mapdemo from '../images/mapdemo.gif'\nimport musicdemo from '../images/musicdemo.gif'\nimport { version } from '../iframe/package.json'\n\nconst mapStateToProps = ({ tutorial }) => ({\n  tutorial\n})\n\nconst mapDispatchToProps = dispatch => ({\n  setScreen: screen => dispatch(actions.setScreen(screen)),\n  startTutorial: () =>\n    dispatch(\n      actions.setTutorialSlide({\n        lessonIndex: 0,\n        slideIndex: 0\n      })\n    )\n})\n\nclass Home extends Component {\n  constructor(props) {\n    super(props)\n    this.handleStartTutorial = this.handleStartTutorial.bind(this)\n    this.handleSeeLessons = this.handleSeeLessons.bind(this)\n    this.handleClickGifs = this.handleClickGifs.bind(this)\n  }\n\n  handleStartTutorial() {\n    this.props.startTutorial()\n  }\n\n  handleSeeLessons() {\n    this.props.setScreen(screenTypes.HELP)\n  }\n\n  handleClickGifs() {\n    this.props.setScreen(screenTypes.SHELF)\n  }\n\n  render() {\n    return (\n      <div className=\"Home\">\n        <div className=\"main\">\n          <img className=\"logo\" src={logo} alt=\"SCRIPT-8 logo\" />\n          <p className=\"last-updated\">\n            <span>updated {timestamp}</span>\n            <span>v{version}</span>\n          </p>\n          <p>\n            SCRIPT-8 is a fantasy computer for making, sharing, and playing tiny\n            retro-looking games (called cassettes). It's free, browser-based,\n            and{' '}\n            <a\n              className=\"text\"\n              href=\"https://github.com/script-8/script-8.github.io\"\n            >\n              open-source\n            </a>\n            . Cassettes are written in JavaScript.\n          </p>\n          <p className=\"gifs\">\n            <button onClick={this.handleClickGifs}>\n              <img\n                className=\"gif\"\n                src={loshermanosbrosgif}\n                alt=\"Los hermanos bros\"\n              />\n            </button>\n            <button onClick={this.handleClickGifs}>\n              <img className=\"gif\" src={breakoutgif} alt=\"break-8 game\" />\n            </button>\n            <button onClick={this.handleClickGifs}>\n              <img className=\"gif\" src={brospipegif} alt=\"the plumber\" />\n            </button>\n          </p>\n          <p className=\"start\">\n            <button\n              className={classNames('button', {\n                invisible: this.props.tutorial\n              })}\n              onClick={this.handleStartTutorial}\n            >\n              > New? Start here\n            </button>\n            <button\n              className={classNames('button', {\n                invisible: this.props.tutorial\n              })}\n              onClick={this.handleSeeLessons}\n            >\n              > See lessons\n            </button>\n          </p>\n          <p>\n            SCRIPT-8 is designed to encourage play  the kind of wonder-filled\n            play children experience as they explore and learn about the world.\n            In order to support this goal, everything in SCRIPT-8 has immediate\n            feedback. It is what some call a \"livecoding\" environment.\n          </p>\n          <p>It features:</p>\n          <ul>\n            <li>\n              a code editor where the game changes as you type.\n              <img className=\"gif wide\" src={livecoding480} alt=\"livecoding\" />\n            </li>\n            <li>\n              a slider to help you tweak numbers without typing.\n              <img className=\"gif wide\" src={slider480} alt=\"slider\" />\n            </li>\n            <li>\n              <span>a time-traveling tool so you can pause and rewind.</span>\n              <img\n                className=\"gif wide single\"\n                src={pauserewind}\n                alt=\"pause and rewind\"\n              />\n            </li>\n            <li>\n              <span>\n                buttons that show a character's past and future paths.\n              </span>\n              <img className=\"gif wide single\" src={toggle} alt=\"toggle\" />\n            </li>\n            <li>\n              the ability to combine all the above so you can manipulate time.\n              <iframe\n                title=\"Demonstration of SCRIPT-8's time-traveling tool\"\n                width=\"560\"\n                height=\"315\"\n                src=\"https://www.youtube.com/embed/0rg5GGFaIY0\"\n                frameBorder=\"0\"\n                allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\"\n                allowFullScreen\n              />{' '}\n            </li>\n            <li>\n              <span>\n                a sprite editor where the game instantly displays your edits.\n              </span>\n              <img\n                className=\"gif wide single\"\n                src={spritedemo}\n                alt=\"sprite demo\"\n              />\n            </li>\n            <li>\n              <span>\n                a map editor where changes alter the game's behavior, in\n                real-time.\n              </span>\n              <img className=\"gif wide single\" src={mapdemo} alt=\"map demo\" />\n            </li>\n            <li>\n              <span>\n                a music editor where you create phrases, group them into chains,\n                and turn those into songs.\n              </span>\n              <img\n                className=\"gif wide single\"\n                src={musicdemo}\n                alt=\"music demo\"\n              />\n            </li>\n          </ul>\n\n          <p>Each cassette is recorded to a URL you can share with anyone.</p>\n          <p>Play cassettes with a keyboard or gamepad.</p>\n          <p>\n            You can inspect any cassette's contents (even if it's not yours),\n            change the code, art, or music, and record it to a different\n            cassette  a new version.\n          </p>\n          <p>\n            SCRIPT-8 is heavily influenced by Bret Victor's ideas (specifically{' '}\n            <a className=\"text\" href=\"http://vimeo.com/36579366\">\n              Inventing on principle\n            </a>{' '}\n            and{' '}\n            <a\n              className=\"text\"\n              href=\"http://worrydream.com/LearnableProgramming/\"\n            >\n              Learnable programming\n            </a>\n            ) and Joseph White's{' '}\n            <a className=\"text\" href=\"https://www.lexaloffle.com/pico-8.php\">\n              PICO-8\n            </a>\n            , the best of all fantasy consoles.\n          </p>\n          <p>\n            SCRIPT-8 is written by Gabriel Florit (that's me!) and{' '}\n            <a\n              className=\"text\"\n              href=\"https://github.com/script-8/script-8.github.io/graphs/contributors\"\n            >\n              dedicated contributors\n            </a>\n            . Click{' '}\n            <a className=\"text\" href=\"https://twitter.com/gabrielflorit\">\n              here\n            </a>{' '}\n            to follow me on twitter. And visit the Github repository{' '}\n            <a\n              className=\"text\"\n              href=\"https://github.com/script-8/script-8.github.io\"\n            >\n              here\n            </a>\n            , where you can keep up with new features and the occasional bug\n            fix.\n          </p>\n          <p>\n            If you have any questions, come join us on the{' '}\n            <a className=\"text\" href=\"https://discord.gg/HA68FNX\">\n              Fantasy Consoles Discord server\n            </a>\n            , a friendly place to chat about these sophisticated, cutting-edge\n            computers. The server has a dedicated SCRIPT-8 room.\n          </p>\n          <p>\n            SCRIPT-8 nyx8 palette by{' '}\n            <a className=\"text\" href=\"https://twitter.com/Xavier_Gd\">\n              Javier Guerrero\n            </a>\n            . Sprites in{' '}\n            <a\n              className=\"text\"\n              href=\"https://script-8.github.io/?id=cd8d6811adb3afb472aaf7505729cf01\"\n            >\n              Los Hermanos Bros.\n            </a>{' '}\n            by{' '}\n            <a className=\"text\" href=\"https://twitter.com/johanvinet\">\n              Johan Vinet\n            </a>\n            .\n          </p>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Home)\n","import { version } from '../../package.json'\nimport skeleton from '../skeleton.js'\nconst boot = `\n\nconst modes = ['glitch', 'numbers', 'pre-ram', 'ram', 'run', 'end']\n\nconst size = range(128)\nconst d = 1\n\nconst rects = flatten(size.map(x => size.map(y => [x, y, d, 128])))\n\nconst biosLines = range(18).map(() => {\n  return (\n    '  ' +\n    range(4)\n      .map(() => random(1000, 9999))\n      .join('      ')\n  )\n})\n\ninit = state => {\n  state.counter = 0\n  state.totalElapsed = 0\n  state.modeIndex = 0\n  state.hasStarted = false\n}\n\nupdate = (state, input, elapsed) => {\n  if (!state.hasStarted) {\n    state.hasStarted = true\n  }\n\n  const mode = modes[state.modeIndex]\n\n  state.counter++\n  state.totalElapsed += elapsed\n\n  if (mode === 'glitch' && state.totalElapsed > 500) {\n    state.modeIndex++\n    state.totalElapsed = 0\n  } else if (mode === 'numbers' && state.totalElapsed > 100) {\n    state.modeIndex++\n    state.totalElapsed = 0\n  } else if (mode === 'pre-ram' && state.totalElapsed > 100) {\n    state.modeIndex++\n    state.totalElapsed = 0\n    state.counter = 0\n  } else if (mode === 'ram' && state.counter > 64 && _script8.end) {\n    // The _script8.end function is not defined until we're done fetching the gist.\n    state.modeIndex++\n    state.totalElapsed = 0\n    state.counter++\n  } else if (mode === 'run') {\n    if (input.__mousedown) {\n      ${skeleton}\n      _script8.end()\n    }\n  }\n}\n\ndraw = state => {\n  const { modeIndex, counter } = state\n  const mode = modes[modeIndex]\n\n  if (mode === 'glitch') {\n    rects.forEach(rect => {\n      rectFill(...rect, rect[0] + (rect[1] * counter) / 100)\n    })\n  }\n\n  if (mode === 'numbers') {\n    const factor = 4\n    if (counter % factor === 0) {\n      rectFill(0, 0, 128, 128, 7)\n      biosLines.forEach((line, j) => {\n        print(0, 128 + 7 * j - (7 * counter) / factor, line, 5)\n      })\n    }\n  }\n\n  if (mode === 'pre-ram') {\n    rectFill(0, 0, 128, 128, 7)\n  }\n\n  if (mode === 'ram') {\n    rectFill(0, 0, 128, 128, 6)\n    print(7, 7 * 1, 'script-8', 0)\n    print(7, 7 * 3, 'bios (c) 1980 pantron inc.', 3)\n    print(7, 7 * 4, 'version ${version}', 3)\n    print(7, 7 * 6, 'RAM: ' + Math.min(state.counter, 32) + ' kb', 3)\n\n    print(\n      7,\n      7 * 9,\n      'booting cassette ' +\n        (Math.floor(state.counter / 20) % 2 === 0 ? '' : '+'),\n      3\n    )\n\n    rectFill(48 + 3 * 0, 7, 3, 5, 0)\n    rectFill(48 + 3 * 1, 7, 3, 5, 1)\n    rectFill(48 + 3 * 2, 7, 3, 5, 2)\n    rectFill(48 + 3 * 3, 7, 3, 5, 3)\n    rectFill(48 + 3 * 4, 7, 3, 5, 4)\n    rectFill(48 + 3 * 5, 7, 3, 5, 5)\n    rectFill(48 + 3 * 6, 7, 3, 5, 4)\n    rectFill(48 + 3 * 7, 7, 3, 5, 3)\n    rectFill(48 + 3 * 8, 7, 3, 5, 2)\n    rectFill(48 + 3 * 9, 7, 3, 5, 1)\n    rectFill(48 + 3 * 10, 7, 3, 5, 0)\n  }\n\n  if (mode === 'run') {\n    rectFill(0, 0, 128, 128, 6)\n    print(7, 7 * 1, 'script-8', 0)\n    print(7, 7 * 3, 'bios (c) 1980 pantron inc.', 3)\n    print(7, 7 * 4, 'version ${version}', 3)\n    print(7, 7 * 6, 'RAM: ' + Math.min(state.counter, 32) + ' kb', 3)\n\n    print(7, 7 * 9, 'booting cassette done. ', 3)\n\n    rectFill(48 + 3 * 0, 7, 3, 5, 0)\n    rectFill(48 + 3 * 1, 7, 3, 5, 1)\n    rectFill(48 + 3 * 2, 7, 3, 5, 2)\n    rectFill(48 + 3 * 3, 7, 3, 5, 3)\n    rectFill(48 + 3 * 4, 7, 3, 5, 4)\n    rectFill(48 + 3 * 5, 7, 3, 5, 5)\n    rectFill(48 + 3 * 6, 7, 3, 5, 4)\n    rectFill(48 + 3 * 7, 7, 3, 5, 3)\n    rectFill(48 + 3 * 8, 7, 3, 5, 2)\n    rectFill(48 + 3 * 9, 7, 3, 5, 1)\n    rectFill(48 + 3 * 10, 7, 3, 5, 0)\n    print(7, 7 * 11, '> click to run', 3)\n    rectFill(7, 7 * 12, 4, 5, Math.floor(state.counter / 25) % 2 ? 0 : 6)\n  }\n}\n\n`\n\nexport default boot\n","export default `init = state => {\n}\n\nupdate = (state, input, elapsed) => {\n}\n\ndrawActors = (state, fade) =>\n  state.actors && state.actors.forEach(actor =>\n    sprite(\n      actor.x,\n      actor.y,\n      actor.sprite,\n      fade ? actor.trailBrighten || -3 : actor.brighten,\n      actor.flipH,\n      actor.flipV\n    )\n  )\n\ndraw = state => {\n  camera()\n  clear()\n}`\n","import _ from 'lodash'\nimport initialState from '../store/initialState.js'\n\nconst extractGistMap = data =>\n  JSON.parse(\n    _.get(\n      data,\n      'files[\"map.json\"].content',\n      JSON.stringify(initialState.map, null, 2)\n    )\n  )\n\nexport { extractGistMap }\n","import _ from 'lodash'\nimport initialState from '../store/initialState.js'\n\nconst extractGistSprites = data =>\n  JSON.parse(\n    _.get(\n      data,\n      'files[\"sprites.json\"].content',\n      JSON.stringify(initialState.sprites, null, 2)\n    )\n  )\nexport { extractGistSprites }\n","import _ from 'lodash'\nimport initialState from '../store/initialState.js'\n\nconst extractGistChains = data =>\n  JSON.parse(\n    _.get(\n      data,\n      'files[\"chains.json\"].content',\n      JSON.stringify(initialState.chains, null, 2)\n    )\n  )\n\nexport { extractGistChains }\n","import _ from 'lodash'\nimport initialState from '../store/initialState.js'\n\nconst extractGistSongs = data =>\n  JSON.parse(\n    _.get(\n      data,\n      'files[\"songs.json\"].content',\n      JSON.stringify(initialState.songs, null, 2)\n    )\n  )\n\nexport { extractGistSongs }\n","import _ from 'lodash'\nimport initialState from '../store/initialState.js'\n\n// If `data` exists,\n//   if `misc.json` has iframeVersion, return it,\n//   if it doesn't have it, return 0.1.247\n// If `data` doesn't exist,\n//   return initialState.iframeVersion.\nconst parseGistIframeVersion = data => {\n  const iframeVersion = data\n    ? _.get(\n        JSON.parse(_.get(data, 'files[\"misc.json\"].content', '{}')),\n        'iframeVersion',\n        '0.1.247'\n      )\n    : initialState.iframeVersion\n  return iframeVersion\n}\n\nexport { parseGistIframeVersion }\n","import equal from 'deep-equal'\nimport { extractGistMap } from '../iframe/src/gistParsers/map.js'\nimport { extractGistSprites } from '../iframe/src/gistParsers/sprites.js'\nimport { extractGistPhrases } from '../iframe/src/gistParsers/phrases.js'\nimport { extractGistChains } from '../iframe/src/gistParsers/chains.js'\nimport { extractGistSongs } from '../iframe/src/gistParsers/songs.js'\nimport { parseGistIframeVersion } from '../iframe/src/gistParsers/iframeVersion.js'\nimport {\n  parseGistGame,\n  assembleOrderedGame\n} from '../iframe/src/gistParsers/game.js'\nimport blankTemplate from '../iframe/src/blankTemplate.js'\n\nconst isDirty = ({\n  gist,\n  game,\n  sprites,\n  map,\n  phrases,\n  chains,\n  songs,\n  iframeVersion\n}) => {\n  const gistGame = assembleOrderedGame(parseGistGame(gist.data))\n  const thisGame = assembleOrderedGame(game)\n\n  let gameIsDirty = false\n\n  // If there is no game in the gist,\n  if (gistGame === '') {\n    // decide the game is dirty if it's not the blank template.\n    gameIsDirty = !equal(blankTemplate, thisGame)\n  } else {\n    // If there is game in the gist,\n    // then decide if it's dirty as per usual.\n    gameIsDirty = !equal(gistGame, thisGame)\n  }\n\n  const mapIsDirty = !equal(extractGistMap(gist.data), map)\n  const spritesIsDirty = !equal(extractGistSprites(gist.data), sprites)\n  const phrasesIsDirty = !equal(extractGistPhrases(gist.data), phrases)\n  const chainsIsDirty = !equal(extractGistChains(gist.data), chains)\n  const songsIsDirty = !equal(extractGistSongs(gist.data), songs)\n  const iframeVersionIsDirty = !equal(\n    parseGistIframeVersion(gist.data),\n    iframeVersion\n  )\n\n  // console.log({\n  //   old: assembleOrderedGame(parseGistGame(gist.data)),\n  //   newer: assembleOrderedGame(game)\n  // })\n  // console.log({ old: parseGistGame(gist.data), newer: game })\n\n  // console.log({\n  //   gameIsDirty,\n  //   mapIsDirty,\n  //   spritesIsDirty,\n  //   phrasesIsDirty,\n  //   chainsIsDirty,\n  //   songsIsDirty\n  // })\n\n  return (\n    gameIsDirty ||\n    mapIsDirty ||\n    spritesIsDirty ||\n    phrasesIsDirty ||\n    chainsIsDirty ||\n    songsIsDirty ||\n    iframeVersionIsDirty\n  )\n}\n\nexport default isDirty\n","import _ from 'lodash'\nimport isDirty from './isDirty.js'\n\nconst canRecord = ({\n  gist,\n  token,\n  game,\n  sprites,\n  map,\n  phrases,\n  chains,\n  songs,\n  iframeVersion\n}) => {\n  const dirty = isDirty({\n    gist,\n    game,\n    sprites,\n    map,\n    phrases,\n    chains,\n    songs,\n    iframeVersion\n  })\n\n  // If gistLogin is null, gist was created anonymously.\n  const gistLogin = _.get(gist, 'data.owner.login', null)\n\n  // If gistLogin does not match currentLogin, gist wasn't created by us.\n  const currentLogin = _.get(token, 'user.login', null)\n\n  // RECORD can only be enabled when:\n  // - the gist is ours AND content is dirty\n  // - OR the gist is empty (new game)\n  const enableRecord =\n    (currentLogin && currentLogin === gistLogin && dirty) || _.isEmpty(gist)\n\n  return enableRecord\n}\n\nexport default canRecord\n","import * as acorn from 'acorn'\nimport * as walk from 'acorn-walk'\n\nconst parseOptions = {\n  ecmaVersion: 9,\n  sourceType: 'script',\n  locations: true\n}\n\nclass InvalidTokenError extends Error {\n  constructor({ loc, raisedAt, message }) {\n    super(message)\n    this.name = 'InvalidTokenError'\n    this.loc = loc\n    this.raisedAt = raisedAt\n  }\n}\n\nconst findInvalidNode = nodes => {\n  return new Promise(resolve => {\n    const channel = new window.MessageChannel()\n    const payload = {\n      type: 'findInvalidToken',\n      tokens: nodes.map(d => d.name)\n    }\n    const iframe = document.querySelector('iframe')\n    iframe.contentWindow.postMessage(payload, '*', [channel.port2])\n    channel.port1.onmessage = message => {\n      resolve(nodes[message.data])\n    }\n  })\n}\n\nconst getLintErrors = async ({ text }) => {\n  const errors = []\n  try {\n    const parsed = acorn.parse(text, parseOptions)\n    let nodes = []\n    walk.simple(parsed, {\n      Identifier(node) {\n        nodes.push(node)\n      }\n    })\n    const node = await findInvalidNode(nodes)\n    if (node) {\n      const error = {\n        loc: node.loc.start,\n        raisedAt: node.end,\n        message: `${node.name} is not allowed in SCRIPT-8.`\n      }\n      throw new InvalidTokenError(error)\n    }\n  } catch (error) {\n    errors.push({\n      from: {\n        line: error.loc.line - 1,\n        ch: error.loc.column\n      },\n      to: {\n        line: error.loc.line - 1,\n        ch: error.raisedAt\n      },\n      message: error.message.replace(/ \\(\\d+:\\d+\\)$/, ''),\n      severity: 'error'\n    })\n  }\n\n  return errors\n}\n\nconst setupLinter = () => {\n  window.CodeMirror.registerHelper('lint', 'javascript', text =>\n    getLintErrors({ text })\n  )\n}\n\nexport { parseOptions, getLintErrors }\nexport default setupLinter\n","const getGameTitle = game => {\n  const match = game[0].text.split('\\n')[0].match(/\\/\\/\\s*title:\\s*(\\S.*)/)\n  const title = match ? match[1].trim().toUpperCase() : null\n  return title\n}\n\nexport default getGameTitle\n","import { assembleMiscLines } from '../../../reducers/game'\nimport runningSum from './runningSum'\n\nconst gameLineToTabLine = ({ game, gameLine }) => {\n  // First convert the game to misc lines.\n  const miscLines = assembleMiscLines(game)\n\n  // Next, calculate the runningSum.\n  const sum = runningSum(miscLines)\n\n  // Then find our tab.\n  const tab = sum.findIndex(pair => pair[1] > gameLine)\n\n  // If no tab found, return null.\n  return tab > -1\n    ? {\n        tab,\n        tabLine: gameLine - sum[tab][0]\n        // sum\n      }\n    : null\n}\n\nexport default gameLineToTabLine\n","import _ from 'lodash'\nimport classNames from 'classnames'\nimport React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { tokenizer } from 'acorn'\nimport actions, { saveGist } from '../actions/actions.js'\nimport bios from '../iframe/src/utils/bios.js'\nimport screenTypes, {\n  getPreviousScreen,\n  getNextScreen\n} from '../iframe/src/utils/screenTypes.js'\nimport canRecord from '../utils/canRecord.js'\nimport { getLintErrors } from '../utils/setupLinter.js'\nimport { numberWithCommas } from '../utils/string.js'\nimport { assembleOrderedGame } from '../iframe/src/gistParsers/game.js'\nimport getGameTitle from '../utils/getGameTitle'\nimport gameLineToTabLine from '../iframe/src/utils/gameLineToTabLine.js'\n\nconst mapStateToProps = ({\n  hideMenu,\n  iframeVersion,\n  screen,\n  game,\n  songs,\n  chains,\n  phrases,\n  sprites,\n  map,\n  sound,\n  gist,\n  token,\n  tutorial\n}) => ({\n  hideMenu,\n  iframeVersion,\n  songs,\n  chains,\n  phrases,\n  sprites,\n  map,\n  game: screen === screenTypes.BOOT ? { 0: { text: bios } } : game,\n  run: [screenTypes.BOOT, screenTypes.RUN].includes(screen),\n  screen,\n  sound,\n  gist,\n  token,\n  tutorial\n})\n\nconst mapDispatchToProps = dispatch => ({\n  toggleMenu: () => dispatch(actions.toggleMenu()),\n  setErrorLine: line => dispatch(actions.setErrorLine(line)),\n  setCodeTab: tab => dispatch(actions.setCodeTab(tab)),\n  setScreen: screen => dispatch(actions.setScreen(screen)),\n  finishBoot: () => dispatch(actions.finishBoot()),\n  saveGist: ({\n    iframeVersion,\n    game,\n    token,\n    gist,\n    sprites,\n    map,\n    phrases,\n    chains,\n    songs\n  }) =>\n    dispatch(\n      saveGist({\n        iframeVersion,\n        game,\n        token,\n        gist,\n        sprites,\n        map,\n        phrases,\n        chains,\n        songs,\n        toFork: false\n      })\n    )\n})\n\nconst getTokenCount = game => {\n  const src = assembleOrderedGame(game)\n  try {\n    return numberWithCommas([...tokenizer(src)].length)\n  } catch (error) {\n    return 'ERROR'\n  }\n}\nconst throttledTokenCount = _.throttle(getTokenCount, 1000)\n\nclass Output extends Component {\n  constructor(props) {\n    super(props)\n\n    this.handleToggleMenuClick = this.handleToggleMenuClick.bind(this)\n    this.evaluate = this.evaluate.bind(this)\n    this.handleClickSize = this.handleClickSize.bind(this)\n    this.handleClickError = this.handleClickError.bind(this)\n    this.resize = _.debounce(this.resize.bind(this), 100)\n    this.handleBlur = this.handleBlur.bind(this)\n\n    window.addEventListener('resize', this.resize)\n\n    this.state = {\n      showSize: false,\n      errors: [],\n      logs: []\n    }\n  }\n\n  noop() {}\n\n  resize() {\n    if (this.isLoaded) {\n      this.evaluate()\n    }\n  }\n\n  handleToggleMenuClick() {\n    this.props.toggleMenu()\n  }\n\n  handleClickSize() {\n    this.setState({\n      showSize: !this.state.showSize\n    })\n  }\n\n  handleBlur(e) {\n    if (this.props.run) {\n      e.currentTarget.focus()\n    }\n  }\n\n  handleClickError({ line, column }) {\n    const { game, setCodeTab, setErrorLine } = this.props\n    const tabAndTabLine = gameLineToTabLine({\n      game,\n      gameLine: line\n    })\n    if (tabAndTabLine) {\n      const { tab, tabLine } = tabAndTabLine\n      setCodeTab(tab)\n      setErrorLine({ line: tabLine - 1, timestamp: Date.now() })\n    }\n  }\n\n  componentDidMount() {\n    this._iframe.focus()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.run) {\n      this._iframe.focus()\n    }\n    if (this.isLoaded) {\n      if (\n        JSON.stringify([\n          prevProps.iframeVersion,\n          prevProps.game,\n          prevProps.finishBoot,\n          prevProps.run,\n          prevProps.songs,\n          prevProps.chains,\n          prevProps.phrases,\n          prevProps.sprites,\n          prevProps.map,\n          prevProps.screen,\n          prevProps.sound,\n          prevProps.gist,\n          prevProps.setScreen,\n          prevProps.saveGist,\n          prevProps.token\n        ]) !==\n        JSON.stringify([\n          this.props.iframeVersion,\n          this.props.game,\n          this.props.finishBoot,\n          this.props.run,\n          this.props.songs,\n          this.props.chains,\n          this.props.phrases,\n          this.props.sprites,\n          this.props.map,\n          this.props.screen,\n          this.props.sound,\n          this.props.gist,\n          this.props.setScreen,\n          this.props.saveGist,\n          this.props.token\n        ])\n      ) {\n        this.evaluate()\n      }\n    }\n    if (\n      assembleOrderedGame(this.props.game) !==\n      assembleOrderedGame(prevProps.game)\n    ) {\n      this.setState({\n        logs: []\n      })\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.resize)\n  }\n\n  evaluate() {\n    const {\n      game,\n      finishBoot,\n      run,\n      songs,\n      chains,\n      phrases,\n      sprites,\n      map,\n      screen,\n      sound,\n      gist,\n      setScreen,\n      saveGist,\n      token\n    } = this.props\n\n    // Create a closured function for eval'ing the game.\n    const sendPayload = (callbacks = {}) => {\n      const channel = new window.MessageChannel()\n      if (this._iframe) {\n        this._iframe.contentWindow.postMessage(\n          {\n            type: 'callCode',\n            game: assembleOrderedGame(game),\n            isDoneFetching:\n              screen === screenTypes.BOOT && !gist.isFetching && gist.data,\n            songs,\n            chains,\n            phrases,\n            sprites,\n            map,\n            run,\n            callbacks,\n            sound\n          },\n          '*',\n          [channel.port2]\n        )\n        channel.port1.onmessage = e => {\n          if (e.data.callback === 'finishBoot') {\n            finishBoot()\n          }\n          const { height, errors, logs, shortcut } = e.data\n          if (height && this._iframe) {\n            this._iframe.height = height\n          }\n          if (errors) {\n            this.setState({ errors })\n          }\n          if (!_.isNil(logs)) {\n            this.setState({ logs })\n          }\n          if (shortcut) {\n            if (shortcut === 'save') {\n              // If we're logged in,\n              // and we can save,\n              if (token.value && canRecord(this.props)) {\n                // save.\n                saveGist(this.props)\n              }\n            }\n            if (shortcut === 'previous') {\n              setScreen(getPreviousScreen(screen))\n            }\n            if (shortcut === 'next') {\n              setScreen(getNextScreen(screen))\n            }\n          }\n        }\n      }\n    }\n\n    // If we're on the boot screen,\n    // ignore validation.\n    if (screen === screenTypes.BOOT) {\n      sendPayload({\n        endCallback: 'finishBoot'\n      })\n    } else {\n      // Validate code before drawing.\n      getLintErrors({\n        text: assembleOrderedGame(game)\n      }).then(errors => {\n        if (!errors.length) {\n          sendPayload()\n        } else {\n          // If we had errors, print them to console.\n          console.warn(errors[0].message)\n        }\n      })\n    }\n  }\n\n  render() {\n    const { errors, logs } = this.state\n    const { run, tutorial, game, iframeVersion, hideMenu, screen } = this.props\n    const gameTitle = getGameTitle(game)\n    document.title = [gameTitle, 'SCRIPT-8'].filter(d => d).join(' - ')\n\n    const tokenCount = throttledTokenCount(game)\n\n    const iframeUrl =\n      process.env.NODE_ENV !== 'production'\n        ? process.env.REACT_APP_IFRAME_URL\n        : `${process.env.REACT_APP_IFRAME_URL}/iframe-v${iframeVersion}.html`\n\n    return (\n      <div\n        className={classNames('Output', {\n          'in-tutorial': tutorial && run\n        })}\n      >\n        <iframe\n          src={iframeUrl}\n          title=\"SCRIPT-8\"\n          sandbox=\"allow-scripts allow-same-origin\"\n          onBlur={this.handleBlur}\n          ref={_iframe => {\n            this._iframe = _iframe\n          }}\n          onLoad={() => {\n            this.isLoaded = true\n            this.evaluate()\n          }}\n        />\n        {!run ? (\n          <div className=\"errors-and-stats\">\n            {logs.map(log => (\n              <div className=\"log\">log: {JSON.stringify(log)}</div>\n            ))}\n            <ul className=\"errors\">\n              {errors.map(({ type, data: { message, position } }) =>\n                position ? (\n                  <li\n                    className=\"clickable\"\n                    key={type}\n                    onClick={() => this.handleClickError(position)}\n                  >\n                    > error: {message}\n                  </li>\n                ) : (\n                  <li key={type}>error: {message}</li>\n                )\n              )}\n            </ul>\n            <div className=\"stats\">TOKENS: {tokenCount}</div>\n          </div>\n        ) : screen === screenTypes.BOOT ? null : (\n          <button\n            className=\"button togglemenu\"\n            onClick={this.handleToggleMenuClick}\n          >\n            {hideMenu ? 'show' : 'hide'} menu\n          </button>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Output)\n","const replaceAt = (str, index, replacement) =>\n  str.substr(0, index) +\n  replacement +\n  str.substr(index + replacement.toString().length)\n\nconst numberWithCommas = x => {\n  var parts = x.toString().split('.')\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\n  return parts.join('.')\n}\n\nexport { replaceAt, numberWithCommas }\n","const circle = ({ cx, cy, radius, ctx, color, onlyStroke }) => {\n  let x = radius - 1\n  let y = 0\n  let dx = 1\n  let dy = 1\n  let err = dx - (radius << 1)\n\n  ctx.fillStyle = color\n  ctx.strokeStyle = color\n\n  const drawPixel = (x, y) => {\n    ctx.fillRect(x, y, 1, 1)\n  }\n\n  const drawLine = ({ x0, x1, y }) => {\n    ctx.beginPath()\n    ctx.moveTo(x0 + 1, y + 0.5)\n    ctx.lineTo(x1, y + 0.5)\n    ctx.stroke()\n  }\n\n  if (radius === 2) {\n    drawPixel(cx + 1, cy)\n    drawPixel(cx - 1, cy)\n    drawPixel(cx, cy + 1)\n    drawPixel(cx, cy - 1)\n    if (!onlyStroke) {\n      drawPixel(cx, cy)\n    }\n  } else if (radius === 3) {\n    drawLine({ x0: cx - 2, x1: cx + 2, y: cy - 2 })\n    drawLine({ x0: cx - 2, x1: cx + 2, y: cy + 2 })\n    if (onlyStroke) {\n      drawPixel(cx + 2, cy - 1)\n      drawPixel(cx + 2, cy)\n      drawPixel(cx + 2, cy + 1)\n      drawPixel(cx - 2, cy - 1)\n      drawPixel(cx - 2, cy)\n      drawPixel(cx - 2, cy + 1)\n    } else {\n      drawLine({ x0: cx - 3, x1: cx + 3, y: cy - 1 })\n      drawLine({ x0: cx - 3, x1: cx + 3, y: cy })\n      drawLine({ x0: cx - 3, x1: cx + 3, y: cy + 1 })\n    }\n  } else {\n    while (x >= y) {\n      if (onlyStroke) {\n        drawPixel(cx + x, cy + y)\n        drawPixel(cx - x, cy + y)\n        drawPixel(cx + y, cy + x)\n        drawPixel(cx - y, cy + x)\n        drawPixel(cx + x, cy - y)\n        drawPixel(cx - x, cy - y)\n        drawPixel(cx + y, cy - x)\n        drawPixel(cx - y, cy - x)\n      } else {\n        drawLine({ x0: cx + y, x1: cx - y, y: cy - x })\n        drawLine({ x0: cx + x, x1: cx - x, y: cy - y })\n        drawLine({ x0: cx + x, x1: cx - x, y: cy + y })\n        drawLine({ x0: cx + y, x1: cx - y, y: cy + x })\n      }\n      if (err <= 0) {\n        y++\n        err += dy\n        dy += 2\n      }\n      if (err > 0) {\n        x--\n        dx += 2\n        err += dx - (radius << 1)\n      }\n    }\n  }\n}\n\nexport default circle\n","const line = ({ x1, y1, x2, y2, ctx, color }) => {\n  ctx.fillStyle = color\n  let steep = false\n\n  if (Math.abs(x1 - x2) < Math.abs(y1 - y2)) {\n    ;[x1, y1] = [y1, x1]\n    ;[x2, y2] = [y2, x2]\n    steep = true\n  }\n  if (x1 > x2) {\n    ;[x1, x2] = [x2, x1]\n    ;[y1, y2] = [y2, y1]\n  }\n\n  const dx = x2 - x1\n  const dy = y2 - y1\n  const derror = Math.abs(dy) * 2\n  let error = 0\n  let y = y1\n\n  for (let x = x1; x <= x2; x++) {\n    if (steep) {\n      ctx.fillRect(y, x, 1, 1)\n    } else {\n      ctx.fillRect(x, y, 1, 1)\n    }\n    error += derror\n    if (error > dx) {\n      if (y2 > y1) {\n        y++\n      } else {\n        y--\n      }\n      error -= dx * 2\n    }\n  }\n}\n\nexport default line\n","import colors from '../colors.js'\nimport line from './line.js'\n\nconst polyStroke = ({ points, args, ctx }) => {\n  if (!points.length) {\n    return\n  }\n  let c, newPoints, xRot, yRot, midX, midY\n  switch (args.length) {\n    case 1:\n      // polyStroke(points, color)\n      newPoints = points.map(p => [...p])\n      c = args[0]\n      break\n    case 2:\n      // polyStroke(points, rotate, color)\n      xRot = Math.cos((args[0] / 180) * Math.PI)\n      yRot = Math.sin((args[0] / 180) * Math.PI)\n      const xs = points.map(p => p[0])\n      const ys = points.map(p => p[1])\n      midX = (Math.min.apply(Math, xs) + Math.max.apply(Math, xs)) / 2\n      midY = (Math.min.apply(Math, ys) + Math.max.apply(Math, ys)) / 2\n      newPoints = points.map(p => [\n        (p[0] - midX) * xRot - (p[1] - midY) * yRot + midX,\n        (p[0] - midX) * yRot + (p[1] - midY) * xRot + midY\n      ])\n      c = args[1]\n      break\n    case 3:\n      throw Error('`polyStroke` found 3 arguments instead of 2, 3, or 5.')\n    default:\n      // polyStroke(points, rotate, x, y, color)\n      xRot = Math.cos((args[0] / 180) * Math.PI)\n      yRot = Math.sin((args[0] / 180) * Math.PI)\n      midX = args[1]\n      midY = args[2]\n      c = args[3]\n      newPoints = points.map(p => [\n        (p[0] - midX) * xRot - (p[1] - midY) * yRot + midX,\n        (p[0] - midX) * yRot + (p[1] - midY) * xRot + midY\n      ])\n      break\n  }\n  for (let i = 1; i < points.length; i++) {\n    line({\n      x1: Math.round(newPoints[i - 1][0]),\n      y1: Math.round(newPoints[i - 1][1]),\n      x2: Math.round(newPoints[i][0]),\n      y2: Math.round(newPoints[i][1]),\n      ctx,\n      color: colors.rgb(c)\n    })\n  }\n  line({\n    x1: Math.round(newPoints[newPoints.length - 1][0]),\n    y1: Math.round(newPoints[newPoints.length - 1][1]),\n    x2: Math.round(newPoints[0][0]),\n    y2: Math.round(newPoints[0][1]),\n    ctx,\n    color: colors.rgb(c)\n  })\n}\n\nexport default polyStroke\n","const alphabet = {\n  '<': [\n    0, 0, 1,\n    0, 1, 0,\n    1, 0, 0,\n    0, 1, 0,\n    0, 0, 1,\n    0, 0, 0,\n  ],\n  '>': [\n    1, 0, 0,\n    0, 1, 0,\n    0, 0, 1,\n    0, 1, 0,\n    1, 0, 0,\n    0, 0, 0,\n  ],\n  '/': [\n    0, 0, 0,\n    0, 0, 1,\n    0, 1, 0,\n    0, 1, 0,\n    1, 0, 0,\n    0, 0, 0,\n  ],\n  ':': [\n    0, 0, 0,\n    0, 0, 0,\n    0, 1, 0,\n    0, 0, 0,\n    0, 1, 0,\n    0, 0, 0,\n  ],\n  '|': [\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 0, 0,\n  ],\n  '(': [\n    0, 1,\n    1, 0,\n    1, 0,\n    1, 0,\n    0, 1,\n    0, 0,\n  ],\n  ')': [\n    1, 0,\n    0, 1,\n    0, 1,\n    0, 1,\n    1, 0,\n    0, 0,\n  ],\n  0: [\n    0, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  1: [\n    1, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  2: [\n    1, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  3: [\n    1, 1, 1,\n    0, 0, 1,\n    0, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  4: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 0,\n  ],\n  5: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  6: [\n    1, 0, 0,\n    1, 0, 0,\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  7: [\n    1, 1, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 0,\n  ],\n  8: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  9: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 0,\n  ],\n\n  ' ': [\n    0, 0,\n    0, 0,\n    0, 0,\n    0, 0,\n    0, 0,\n    0, 0\n  ],\n  '.': [\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n  ],\n  ',': [\n    0,\n    0,\n    0,\n    0,\n    1,\n    1,\n  ],\n  '+': [\n    0, 0, 0,\n    0, 1, 0,\n    1, 1, 1,\n    0, 1, 0,\n    0, 0, 0,\n    0, 0, 0\n  ],\n  '-': [\n    0, 0, 0,\n    0, 0, 0,\n    1, 1, 1,\n    0, 0, 0,\n    0, 0, 0,\n    0, 0, 0\n  ],\n  '!': [\n    1,\n    1,\n    1,\n    0,\n    1,\n    0,\n  ],\n  '?': [\n    1, 1,\n    0, 1,\n    1, 1,\n    0, 0,\n    1, 0,\n    0, 0,\n  ],\n  a: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  b: [\n    1, 1, 0,\n    1, 0, 1,\n    1, 1, 0,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  c: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 0, 0,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  d: [\n    1, 1, 0,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  e: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  f: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    1, 0, 0,\n    1, 0, 0,\n    0, 0, 0\n  ],\n  g: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  h: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  i: [\n    1, 1, 1,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  j: [\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  k: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 0,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  l: [\n    1, 0, 0,\n    1, 0, 0,\n    1, 0, 0,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  m: [\n    1, 0, 1,\n    1, 1, 1,\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  n: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  o: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  p: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 0, 0,\n    1, 0, 0,\n    0, 0, 0\n  ],\n  q: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 1, 1,\n    0, 0, 0\n  ],\n  r: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 0,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  s: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  t: [\n    1, 1, 1,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 0, 0\n  ],\n  u: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  v: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 0,\n    0, 0, 0\n  ],\n  w: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 1, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  x: [\n    1, 0, 1,\n    1, 0, 1,\n    0, 1, 0,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  y: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  z: [\n    1, 1, 1,\n    0, 0, 1,\n    0, 1, 0,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n}\n\nexport default alphabet\n","import colors from '../colors.js'\nimport alphabet from './alphabet.js'\n\nconst print = ({ x, y, letters, c, ctx }) => {\n  const color = colors.triplet(c)\n\n  const grids = letters\n    .toString()\n    // Split into individual letters.\n    .split('')\n    // Get the pixels and the letter's width.\n    .map(letter => {\n      const pixels = alphabet[letter.toLowerCase()]\n      return {\n        // If we found a matching letter in the alphabet,\n        // return its width.\n        // Otherwise if the user tries to print a character\n        // we haven't defined, just return 3.\n        width: pixels ? pixels.length / 6 : 3,\n        letter,\n        pixels\n      }\n    })\n    // Calculate running offsets.\n    .reduce((acc, current, index) => {\n      const previous = acc[index - 1]\n      const xOffset = previous ? previous.width + 1 + previous.xOffset : 0\n      const yOffset = previous ? previous.yOffset : 0\n\n      return [\n        ...acc,\n        {\n          ...current,\n          xOffset,\n          yOffset\n        }\n      ]\n    }, [])\n    // Ignore letters with no matches.\n    .filter(d => d.pixels)\n\n  // For each grid of pixels,\n  grids.forEach(grid => {\n    // get some properties,\n    const { pixels, xOffset, yOffset, width } = grid\n\n    // get the image data this letter will occupy,\n    const imageData = ctx.getImageData(x + xOffset, y + yOffset, width, 6)\n    const { data } = imageData\n\n    // and for each pixel,\n    pixels\n      .map((pixel, pixelIndex) => ({ pixel, pixelIndex }))\n      // ignore pixels set to 0,\n      .filter(d => d.pixel)\n      // and update the underlying canvas data.\n      .forEach(d => {\n        const offset = d.pixelIndex * 4\n        data[offset + 0] = color[0]\n        data[offset + 1] = color[1]\n        data[offset + 2] = color[2]\n        data[offset + 3] = 255\n      })\n\n    // And draw!\n    ctx.putImageData(imageData, x + xOffset, y + yOffset)\n  })\n}\n\nexport default print\n","import clamp from 'lodash/clamp'\nimport colors from '../colors.js'\n\nconst sprite = ({\n  x,\n  y,\n  spriteIndex,\n  darken = 0,\n  flipH = false,\n  flipV = false,\n  sprites,\n  ctx\n}) => {\n  if (sprites[spriteIndex]) {\n    sprites[spriteIndex].slice(0, 8).forEach((cells, rowIndex) => {\n      cells.split('').forEach((color, colIndex) => {\n        if (color !== ' ') {\n          const clamped = clamp(+color - darken, 0, 7)\n          ctx.fillStyle = colors.rgb(clamped)\n          ctx.fillRect(\n            Math.floor(x) + (flipH ? 7 - colIndex : colIndex),\n            Math.floor(y) + (flipV ? 7 - rowIndex : rowIndex),\n            1,\n            1\n          )\n        }\n      })\n    })\n  }\n}\n\nconst pixelSprite = ({ x, y, grid, ctx }) => {\n  grid.slice(0, 8).forEach((cells, rowIndex) => {\n    cells.split('').forEach((color, colIndex) => {\n      if (color !== ' ') {\n        ctx.fillStyle = colors.rgb(+color)\n        ctx.fillRect(Math.floor(x) + colIndex, Math.floor(y) + rowIndex, 1, 1)\n      }\n    })\n  })\n}\n\nexport { pixelSprite }\n\nexport default sprite\n","import { get, isNil } from 'lodash'\nimport colors from '../colors.js'\nimport circle from './circle.js'\nimport line from './line.js'\nimport polyStroke from './polyStroke.js'\nimport print from './print.js'\nimport sprite, { pixelSprite } from './sprite.js'\nimport { getPixel, setPixel } from './pixel.js'\n\n// let mapDraws = []\n// let avgDraws = []\n// let draws = 0\n// let skips = 0\n\nconst canvasAPI = ({\n  ctx,\n  width: canvasWidth,\n  height: canvasHeight,\n  sprites,\n  map = []\n}) => {\n  let _runningMap = JSON.parse(JSON.stringify(map))\n  ctx.setTransform(1, 0, 0, 1, 0, 0)\n\n  let _cameraX = 0\n\n  let _cameraY = 0\n\n  const _memoryCanvas = document.createElement('canvas')\n  _memoryCanvas.width = canvasWidth\n  _memoryCanvas.height = canvasHeight\n  const _mCtx = _memoryCanvas.getContext('2d')\n\n  Object.entries(sprites).forEach(([skey, value]) => {\n    const key = +skey\n    const row = Math.floor(key / 16)\n    const col = key % 16\n    pixelSprite({ x: col * 8, y: row * 8, grid: value, ctx: _mCtx })\n  })\n\n  return {\n    polyStroke(points, ...args) {\n      polyStroke({ points, args, ctx })\n    },\n\n    getTile(mx, my) {\n      const tile = get(_runningMap, [my, mx], null)\n      let result = tile !== null ? sprites[tile] : null\n      if (result) {\n        result.type = result[8] || 0\n        result.number = tile\n      }\n      return result\n    },\n\n    setTile(mx, my, spriteNumber) {\n      _runningMap[my][mx] = spriteNumber\n    },\n\n    line(x1, y1, x2, y2, c = 0) {\n      line({\n        x1: Math.floor(x1),\n        y1: Math.floor(y1),\n        x2: Math.floor(x2),\n        y2: Math.floor(y2),\n        ctx,\n        color: colors.rgb(c)\n      })\n    },\n\n    print(x, y, letters, c = 0) {\n      print({\n        x: x - _cameraX,\n        y: y - _cameraY,\n        letters,\n        c,\n        ctx\n      })\n    },\n\n    rectStroke(x, y, w, h, c = 0) {\n      ctx.strokeStyle = colors.rgb(c)\n      ctx.strokeRect(\n        Math.floor(x) + 0.5,\n        Math.floor(y) + 0.5,\n        Math.floor(w) - 1,\n        Math.floor(h) - 1\n      )\n    },\n\n    camera(x = 0, y = 0) {\n      _cameraX = Math.floor(x)\n      _cameraY = Math.floor(y)\n      ctx.setTransform(1, 0, 0, 1, 0, 0)\n      ctx.translate(-_cameraX, -_cameraY)\n    },\n\n    rectFill(x, y, w, h, c = 0) {\n      ctx.fillStyle = colors.rgb(c)\n      ctx.fillRect(Math.floor(x), Math.floor(y), Math.floor(w), Math.floor(h))\n    },\n\n    resetMap() {\n      _runningMap = JSON.parse(JSON.stringify(map))\n    },\n\n    map(x = 0, y = 0) {\n      // const before = Date.now()\n      _runningMap.forEach((row, rowNumber) => {\n        row.forEach((spriteIndex, colNumber) => {\n          if (spriteIndex !== null) {\n            const sx = (spriteIndex % 16) * 8\n            const sy = Math.floor(spriteIndex / 16) * 8\n            const sWidth = 8\n            const sHeight = 8\n            const dx = (colNumber + x) * 8\n            const dy = (rowNumber + y) * 8\n            const dWidth = 8\n            const dHeight = 8\n\n            if (\n              dx + 7 >= _cameraX &&\n              dx < _cameraX + 128 &&\n              dy + 7 >= _cameraY &&\n              dy < _cameraY + 128\n            ) {\n              // ++draws\n              ctx.drawImage(\n                _memoryCanvas,\n                sx,\n                sy,\n                sWidth,\n                sHeight,\n                dx,\n                dy,\n                dWidth,\n                dHeight\n              )\n            } else {\n              // ++skips\n            }\n          }\n        })\n      })\n\n      // const after = Date.now()\n      // mapDraws.push(after - before)\n      // if (mapDraws.length > 60) {\n      //   const avg = sum(mapDraws) / mapDraws.length\n      //   // console.log(`map() avg: ${sum(mapDraws) / mapDraws.length}ms`)\n      //   // console.log({ _cameraX, _cameraY })\n      //   mapDraws = []\n      //   avgDraws.push(avg)\n      //   if (avgDraws.length % 10 === 0) {\n      //     console.log(`AVG AVG: ${sum(avgDraws) / avgDraws.length}ms`)\n      //     console.log(`DRAWS/SKIPS: ${draws / skips} (${draws}/${skips})`)\n      //   }\n      // }\n    },\n\n    sprite(x, y, spriteIndex, darken = 0, flipH = false, flipV = false) {\n      sprite({\n        x,\n        y,\n        spriteIndex,\n        darken,\n        flipH,\n        flipV,\n        sprites,\n        ctx\n      })\n    },\n\n    circStroke(x, y, r, c = 0) {\n      circle({\n        cx: Math.floor(x),\n        cy: Math.floor(y),\n        radius: Math.floor(r),\n        ctx,\n        color: colors.rgb(c),\n        onlyStroke: true\n      })\n    },\n\n    circFill(x, y, r, c = 0) {\n      circle({\n        cx: Math.floor(x),\n        cy: Math.floor(y),\n        radius: Math.floor(r),\n        ctx,\n        color: colors.rgb(c)\n      })\n    },\n\n    clear(c) {\n      ctx.save()\n      ctx.setTransform(1, 0, 0, 1, 0, 0)\n      if (!isNil(c)) {\n        ctx.fillStyle = colors.rgb(c)\n        ctx.fillRect(0, 0, 128, 128)\n      } else {\n        ctx.clearRect(0, 0, canvasWidth, canvasHeight)\n      }\n      ctx.restore()\n    },\n\n    getPixel(x, y) {\n      return getPixel({\n        x: Math.floor(x - _cameraX),\n        y: Math.floor(y - _cameraY),\n        ctx\n      })\n    },\n\n    setPixel(x, y, c = 0) {\n      setPixel({\n        x: Math.floor(x),\n        y: Math.floor(y),\n        ctx,\n        color: colors.rgb(c)\n      })\n    }\n  }\n}\n\nexport default canvasAPI\n","import colors from '../colors.js'\n\nconst backgroundColor = 7\n\nconst getPixel = ({ x, y, ctx }) => {\n  // pixel: [r, g, b, a]\n  const [r, g, b, alpha] = ctx.getImageData(x, y, 1, 1).data\n\n  // If pixel isn't opaque, return default.\n  if (alpha !== 255) {\n    return backgroundColor\n  }\n\n  // If color wasn't recognized, return default.\n  const color = colors.lookup([r, g, b, alpha])\n  if (color === null) {\n    return backgroundColor\n  }\n\n  return color\n}\n\nconst setPixel = ({ x, y, ctx, color }) => {\n  ctx.fillStyle = color\n  ctx.fillRect(x, y, 1, 1)\n}\n\nexport { getPixel, setPixel }\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport _ from 'lodash'\nimport classNames from 'classnames'\nimport actions from '../actions/actions.js'\nimport canvasAPI from '../iframe/src/contextCanvasAPI/index.js'\nimport { replaceAt } from '../utils/string.js'\n\nconst mapStateToProps = ({ sprites }) => ({ sprites })\n\nconst mapDispatchToProps = dispatch => ({\n  updateSprite: ({ sprite, index }) =>\n    dispatch(\n      actions.updateSprite({\n        sprite,\n        index\n      })\n    )\n})\n\nclass Sprite extends Component {\n  constructor(props) {\n    super(props)\n\n    this.draw = this.draw.bind(this)\n    this.handleTypeClick = this.handleTypeClick.bind(this)\n    this.handleColorClick = this.handleColorClick.bind(this)\n    this.handleCanvasClick = this.handleCanvasClick.bind(this)\n    this.handleOnMouseDown = this.handleOnMouseDown.bind(this)\n    this.handleOnMouseEnter = this.handleOnMouseEnter.bind(this)\n    this.handleOnMouseUp = this.handleOnMouseUp.bind(this)\n    this.handleOnTouchMove = this.handleOnTouchMove.bind(this)\n    this.getCurrentSprite = this.getCurrentSprite.bind(this)\n    this.drawPixel = this.drawPixel.bind(this)\n    this.setMode = this.setMode.bind(this)\n\n    this.state = {\n      spriteIndex: 0,\n      colorIndex: 0,\n      mouseDown: false,\n      mode: '+'\n    }\n  }\n\n  draw() {\n    // Assign various properties to global scope, for the user.\n    const { sprites } = this.props\n    this.canvasAPI = canvasAPI({\n      ctx: this._canvas.getContext('2d'),\n      width: 128,\n      height: 64,\n      sprites\n    })\n\n    this.canvasAPI.clear()\n    Object.keys(sprites).forEach(skey => {\n      const key = +skey\n      const row = Math.floor(key / 16)\n      const col = key % 16\n      this.canvasAPI.sprite(col * 8, row * 8, key)\n    })\n  }\n\n  componentDidMount() {\n    this.draw()\n  }\n\n  getCurrentSprite() {\n    const { sprites } = this.props\n    const { spriteIndex } = this.state\n    return _.get(sprites, spriteIndex, _.range(8).map(d => '        '))\n  }\n\n  handleCanvasClick(spriteIndex) {\n    this.setState({ spriteIndex })\n  }\n\n  handleColorClick(colorIndex) {\n    this.setState({ colorIndex, mode: '+' })\n  }\n\n  handleTypeClick(typeIndex) {\n    const { spriteIndex } = this.state\n    const { updateSprite } = this.props\n    const sprite = this.getCurrentSprite()\n\n    const newSprite = [...sprite.slice(0, 8), typeIndex]\n\n    updateSprite({ sprite: newSprite, index: spriteIndex })\n  }\n\n  handleOnMouseDown(e) {\n    this.setState({\n      mouseDown: true\n    })\n    const { row, col } = e.target.dataset\n    this.drawPixel({ row: +row, col: +col })\n  }\n\n  handleOnMouseEnter(e) {\n    if (this.state.mouseDown) {\n      const { row, col } = e.target.dataset\n      this.drawPixel({ row: +row, col: +col })\n    }\n  }\n\n  handleOnMouseUp() {\n    this.setState({\n      mouseDown: false\n    })\n  }\n\n  handleOnTouchMove(e) {\n    if (this.state.mouseDown) {\n      const touchLocation = e.changedTouches[0]\n      const dataset = document.elementFromPoint(\n        touchLocation.clientX,\n        touchLocation.clientY\n      ).dataset\n      const { row, col } = dataset\n      if (row && col) {\n        this.drawPixel({ row: +row, col: +col })\n      }\n    }\n  }\n\n  setMode(mode) {\n    this.setState({\n      mode\n    })\n  }\n\n  drawPixel({ row, col }) {\n    const { spriteIndex, colorIndex, mode } = this.state\n    const { updateSprite } = this.props\n\n    const sprite = this.getCurrentSprite()\n\n    const newSprite = JSON.parse(JSON.stringify(sprite))\n\n    // Set it to the selected color.\n    newSprite[row] = replaceAt(\n      newSprite[row],\n      col,\n      mode === '+' ? colorIndex : ' '\n    )\n\n    updateSprite({ sprite: newSprite, index: spriteIndex })\n  }\n\n  componentDidUpdate() {\n    this.draw()\n  }\n\n  render() {\n    const { spriteIndex, colorIndex, mode } = this.state\n    const sprite = this.getCurrentSprite()\n    const isEmpty = !sprite.slice(0, 8).filter(d => d !== '        ').length\n    const typeIndex = sprite.length === 8 ? 0 : +sprite[8]\n    return (\n      <div\n        onMouseUp={this.handleOnMouseUp}\n        onTouchEnd={this.handleOnMouseUp}\n        className=\"Sprite two-rows-and-grid\"\n      >\n        <div className=\"main\">\n          <div className=\"SpriteEditor\">\n            <div className=\"sprite-and-colors\">\n              <table className=\"sprite\">\n                <tbody>\n                  {_.range(8).map(row => (\n                    <tr key={row}>\n                      {_.range(8).map(col => {\n                        const value = _.get(sprite, [row, col], ' ')\n                        return (\n                          <td key={col}>\n                            <button\n                              data-row={row}\n                              data-col={col}\n                              onMouseDown={this.handleOnMouseDown}\n                              onMouseEnter={this.handleOnMouseEnter}\n                              onTouchStart={this.handleOnMouseDown}\n                              onTouchMove={this.handleOnTouchMove}\n                              className={`background-${value}`}\n                            >\n                              {value === ' ' ? 'x' : ''}\n                            </button>\n                          </td>\n                        )\n                      })}\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n              <div className=\"colors-and-tools\">\n                <table className=\"colors\">\n                  <tbody>\n                    {_.range(2).map(row => (\n                      <tr key={row}>\n                        {_.range(0 + 4 * row, 4 + 4 * row).map(col => {\n                          return (\n                            <td\n                              key={col}\n                              className={classNames({\n                                active: col === colorIndex && mode === '+'\n                              })}\n                            >\n                              <button\n                                onClick={() => this.handleColorClick(col)}\n                                className={classNames(\n                                  `background-${col}`,\n                                  `border-${col}`,\n                                  {\n                                    active: col === colorIndex && mode === '+'\n                                  }\n                                )}\n                              />\n                            </td>\n                          )\n                        })}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n                <div className=\"tools\">\n                  <div className=\"add-delete\">\n                    <button\n                      className={classNames('button', {\n                        active: mode === '+'\n                      })}\n                      onClick={() => {\n                        this.setMode('+')\n                      }}\n                    >\n                      +\n                    </button>\n\n                    <button\n                      className={classNames('button', {\n                        active: mode === '-'\n                      })}\n                      onClick={() => {\n                        this.setMode('-')\n                      }}\n                    >\n                      -\n                    </button>\n                  </div>\n                  <table className={classNames('types', { hide: isEmpty })}>\n                    <tbody>\n                      <tr>\n                        {_.range(4).map(i => {\n                          return (\n                            <td\n                              key={i}\n                              className={classNames({\n                                active: i === typeIndex\n                              })}\n                            >\n                              <button\n                                onClick={() => this.handleTypeClick(i)}\n                                className={classNames({\n                                  active: i === typeIndex\n                                })}\n                              >\n                                {i}\n                              </button>\n                            </td>\n                          )\n                        })}\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n            <div className=\"sprites\">\n              <table>\n                <tbody>\n                  {_.range(8).map(row => (\n                    <tr key={row}>\n                      {_.range(16).map(col => {\n                        const thisSpriteIndex = row * 16 + col\n                        return (\n                          <td\n                            className={classNames({\n                              active: spriteIndex === thisSpriteIndex\n                            })}\n                            key={col}\n                          >\n                            <button\n                              onClick={() =>\n                                this.handleCanvasClick(thisSpriteIndex)\n                              }\n                            />\n                          </td>\n                        )\n                      })}\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n              <canvas\n                width={128}\n                height={64}\n                ref={_canvas => {\n                  this._canvas = _canvas\n                }}\n              />\n            </div>\n            <div className=\"sprite-number\">{spriteIndex}</div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Sprite)\n","const drawLine = ({ x1, y1, x2, y2, setPixel, color }) => {\n  let steep = false\n\n  if (Math.abs(x1 - x2) < Math.abs(y1 - y2)) {\n    ;[x1, y1] = [y1, x1]\n    ;[x2, y2] = [y2, x2]\n    steep = true\n  }\n  if (x1 > x2) {\n    ;[x1, x2] = [x2, x1]\n    ;[y1, y2] = [y2, y1]\n  }\n\n  const dx = x2 - x1\n  const dy = y2 - y1\n  const derror = Math.abs(dy) * 2\n  let error = 0\n  let y = y1\n\n  for (let x = x1; x <= x2; x++) {\n    if (steep) {\n      setPixel(y, x, color)\n    } else {\n      setPixel(x, y, color)\n    }\n    error += derror\n    if (error > dx) {\n      if (y2 > y1) {\n        y++\n      } else {\n        y--\n      }\n      error -= dx * 2\n    }\n  }\n}\n\nexport default drawLine\n","const drawPolyStroke = ({ points, args, line }) => {\n  if (!points.length) {\n    return\n  }\n  let c, newPoints, xRot, yRot, midX, midY\n  switch (args.length) {\n    case 1:\n      // polyStroke(points, color)\n      newPoints = points.map(p => [...p])\n      c = args[0]\n      break\n    case 2:\n      // polyStroke(points, rotate, color)\n      xRot = Math.cos((args[0] / 180) * Math.PI)\n      yRot = Math.sin((args[0] / 180) * Math.PI)\n      const xs = points.map(p => p[0])\n      const ys = points.map(p => p[1])\n      midX = (Math.min.apply(Math, xs) + Math.max.apply(Math, xs)) / 2\n      midY = (Math.min.apply(Math, ys) + Math.max.apply(Math, ys)) / 2\n      newPoints = points.map(p => [\n        (p[0] - midX) * xRot - (p[1] - midY) * yRot + midX,\n        (p[0] - midX) * yRot + (p[1] - midY) * xRot + midY\n      ])\n      c = args[1]\n      break\n    case 3:\n      throw Error('`polyStroke` found 3 arguments instead of 2, 3, or 5.')\n    default:\n      // polyStroke(points, rotate, x, y, color)\n      xRot = Math.cos((args[0] / 180) * Math.PI)\n      yRot = Math.sin((args[0] / 180) * Math.PI)\n      midX = args[1]\n      midY = args[2]\n      c = args[3]\n      newPoints = points.map(p => [\n        (p[0] - midX) * xRot - (p[1] - midY) * yRot + midX,\n        (p[0] - midX) * yRot + (p[1] - midY) * xRot + midY\n      ])\n      break\n  }\n  for (let i = 1; i < points.length; i++) {\n    line(\n      Math.round(newPoints[i - 1][0]), // x1\n      Math.round(newPoints[i - 1][1]), // y1\n      Math.round(newPoints[i][0]), // x2\n      Math.round(newPoints[i][1]), // y2\n      c\n    )\n  }\n  line(\n    Math.round(newPoints[newPoints.length - 1][0]), // x1\n    Math.round(newPoints[newPoints.length - 1][1]), // y1\n    Math.round(newPoints[0][0]), // x2\n    Math.round(newPoints[0][1]), // y2\n    c\n  )\n}\n\nexport default drawPolyStroke\n","const drawCircle = ({ cx, cy, radius, color, onlyStroke, setPixel, line }) => {\n  let x = radius - 1\n  let y = 0\n  let dx = 1\n  let dy = 1\n  let err = dx - (radius << 1)\n\n  // Draw the correct primitive at x offset from the center, and y above and below the center\n  // If onlyStroke, then draw two points\n  // otherwise, draw a line connecting the two points\n  const drawReflectedPair = (x, y) => {\n    if (onlyStroke) {\n      setPixel(cx + x, cy + y, color)\n      setPixel(cx + x, cy - y, color)\n    } else {\n      line(cx + x, cy + y, cx + x, cy - y, color)\n    }\n  }\n\n  if (radius === 2) {\n    // Draw Left Pixel\n    drawReflectedPair(-1, 0)\n    // Draw Top and Bottom Pixels\n    drawReflectedPair(0, 1)\n    // Draw Right Pixel\n    drawReflectedPair(1, 0)\n  } else if (radius === 3) {\n    // Draw Left Edge\n    drawReflectedPair(-2, 0)\n    drawReflectedPair(-2, 1)\n    // Draw Top and Bottom Edge\n    drawReflectedPair(-1, 2)\n    drawReflectedPair(-0, 2)\n    drawReflectedPair(1, 2)\n    // Draw Right Edge\n    drawReflectedPair(2, 1)\n    drawReflectedPair(2, 0)\n  } else {\n    while (x >= y) {\n      // Draw every octant\n      drawReflectedPair(x, y)\n      drawReflectedPair(-x, y)\n      drawReflectedPair(y, x)\n      drawReflectedPair(-y, x)\n\n      if (err <= 0) {\n        y++\n        err += dy\n        dy += 2\n      }\n\n      if (err > 0) {\n        x--\n        dx += 2\n        err += dx - (radius << 1)\n      }\n    }\n  }\n\n}\n\nexport default drawCircle\n","import clamp from 'lodash/clamp'\n\nconst drawSprite = ({ x, y, spriteIndex, darken, flipH, flipV, setPixel, sprites }) => {\n  if (sprites[spriteIndex]) {\n    sprites[spriteIndex].slice(0, 8).forEach((cells, rowIndex) => {\n      cells.split('').forEach((color, colIndex) => {\n        if (color !== ' ') {\n          const clamped = clamp(+color - darken, 0, 7)\n          setPixel(\n            Math.floor(x) + (flipH ? 7 - colIndex : colIndex),\n            Math.floor(y) + (flipV ? 7 - rowIndex : rowIndex),\n            clamped)\n        }\n      })\n    })\n  }\n}\n\nexport default drawSprite\n","const alphabet = {\n  '<': [\n    0, 0, 1,\n    0, 1, 0,\n    1, 0, 0,\n    0, 1, 0,\n    0, 0, 1,\n    0, 0, 0,\n  ],\n  '>': [\n    1, 0, 0,\n    0, 1, 0,\n    0, 0, 1,\n    0, 1, 0,\n    1, 0, 0,\n    0, 0, 0,\n  ],\n  '/': [\n    0, 0, 0,\n    0, 0, 1,\n    0, 1, 0,\n    0, 1, 0,\n    1, 0, 0,\n    0, 0, 0,\n  ],\n  ':': [\n    0, 0, 0,\n    0, 0, 0,\n    0, 1, 0,\n    0, 0, 0,\n    0, 1, 0,\n    0, 0, 0,\n  ],\n  '|': [\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 0, 0,\n  ],\n  '(': [\n    0, 1,\n    1, 0,\n    1, 0,\n    1, 0,\n    0, 1,\n    0, 0,\n  ],\n  ')': [\n    1, 0,\n    0, 1,\n    0, 1,\n    0, 1,\n    1, 0,\n    0, 0,\n  ],\n  0: [\n    0, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  1: [\n    1, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  2: [\n    1, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  3: [\n    1, 1, 1,\n    0, 0, 1,\n    0, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  4: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 0,\n  ],\n  5: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  6: [\n    1, 0, 0,\n    1, 0, 0,\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  7: [\n    1, 1, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 0,\n  ],\n  8: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0,\n  ],\n  9: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 0,\n  ],\n\n  ' ': [\n    0, 0,\n    0, 0,\n    0, 0,\n    0, 0,\n    0, 0,\n    0, 0\n  ],\n  '.': [\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n  ],\n  ',': [\n    0,\n    0,\n    0,\n    0,\n    1,\n    1,\n  ],\n  '+': [\n    0, 0, 0,\n    0, 1, 0,\n    1, 1, 1,\n    0, 1, 0,\n    0, 0, 0,\n    0, 0, 0\n  ],\n  '-': [\n    0, 0, 0,\n    0, 0, 0,\n    1, 1, 1,\n    0, 0, 0,\n    0, 0, 0,\n    0, 0, 0\n  ],\n  '!': [\n    1,\n    1,\n    1,\n    0,\n    1,\n    0,\n  ],\n  '?': [\n    1, 1,\n    0, 1,\n    1, 1,\n    0, 0,\n    1, 0,\n    0, 0,\n  ],\n  a: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  b: [\n    1, 1, 0,\n    1, 0, 1,\n    1, 1, 0,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  c: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 0, 0,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  d: [\n    1, 1, 0,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  e: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  f: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    1, 0, 0,\n    1, 0, 0,\n    0, 0, 0\n  ],\n  g: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  h: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  i: [\n    1, 1, 1,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  j: [\n    0, 0, 1,\n    0, 0, 1,\n    0, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  k: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 0,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  l: [\n    1, 0, 0,\n    1, 0, 0,\n    1, 0, 0,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  m: [\n    1, 0, 1,\n    1, 1, 1,\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  n: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  o: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  p: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 0, 0,\n    1, 0, 0,\n    0, 0, 0\n  ],\n  q: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    0, 1, 1,\n    0, 0, 0\n  ],\n  r: [\n    1, 1, 1,\n    1, 0, 1,\n    1, 1, 0,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  s: [\n    1, 1, 1,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  t: [\n    1, 1, 1,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 1, 0,\n    0, 0, 0\n  ],\n  u: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  v: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 0,\n    0, 0, 0\n  ],\n  w: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    1, 1, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  x: [\n    1, 0, 1,\n    1, 0, 1,\n    0, 1, 0,\n    1, 0, 1,\n    1, 0, 1,\n    0, 0, 0\n  ],\n  y: [\n    1, 0, 1,\n    1, 0, 1,\n    1, 1, 1,\n    0, 0, 1,\n    1, 1, 1,\n    0, 0, 0\n  ],\n  z: [\n    1, 1, 1,\n    0, 0, 1,\n    0, 1, 0,\n    1, 0, 0,\n    1, 1, 1,\n    0, 0, 0\n  ],\n}\n\nexport default alphabet\n","import alphabet from './alphabet.js'\n\nconst drawText = ({ x, y, letters, c, setPixel }) => {\n  let currentX = Math.floor(x)\n  let currentY = Math.floor(y)\n\n  // Loop over every letter in the string to print.\n  for (let letter of letters.toString().split('')) {\n    // Lookup the pixels for the given letter.\n    const pixels = alphabet[letter.toLowerCase()]\n    // If we don't have any pixels, then treat this character as a space which\n    // is 3 pixels wide and continue to the next character.\n    if (!pixels) {\n      currentX += 3 // Couldn't find a character\n      continue\n    }\n\n    // Calculate the letter width by dividing the pixel count\n    // by the standard letter height of 6.\n    let letterWidth = pixels.length / 6\n\n    // Loop over every pixel and draw it to the screen.\n    for (let x = 0; x < letterWidth; x++) {\n      for (let y = 0; y < 6; y++) {\n        if (pixels[y * letterWidth + x]) {\n          setPixel(currentX + x, currentY + y, c)\n        }\n      }\n    }\n\n    // Move on to the next character position by moving the previous character\n    // width plus 1 for a slight space between characters.\n    currentX += letterWidth + 1\n  }\n}\n\nexport default drawText\n","import { get } from 'lodash'\nimport colors from '../colors.js'\nimport drawLine from './line.js'\nimport drawPolyStroke from './polyStroke.js'\nimport { drawRectStroke, drawRectFill } from './rect.js'\nimport drawCircle from './circle.js'\nimport drawSprite from './sprite.js'\nimport drawText from './print.js'\n\nconst backgroundColor = 7\n\nconst canvasAPI = ({\n  pixels,\n  width: canvasWidth,\n  height: canvasHeight,\n  sprites,\n  // Rename to initialMap, since we have a function named map.\n  map: initialMap = []\n}) => {\n  let _runningMap = JSON.parse(JSON.stringify(initialMap))\n  let _cameraX = 0\n  let _cameraY = 0\n  let _colorSwaps = {}\n\n  const camera = (x = 0, y = 0) => {\n    _cameraX = Math.floor(x)\n    _cameraY = Math.floor(y)\n  }\n\n  const clear = (c = 7) => {\n    pixels.fill(colors.int(c))\n  }\n\n  const colorSwap = (from, to) => {\n    if (from === undefined && to === undefined) {\n      _colorSwaps = {}\n    } else {\n      _colorSwaps[colors.int(from)] = colors.int(to)\n    }\n  }\n\n  const setPixel = (x, y, c = 0) => {\n    x = Math.floor(x - _cameraX)\n    y = Math.floor(y - _cameraY)\n    if (x < 0 || x >= canvasWidth || y < 0 || y >= canvasHeight) return\n    const int = colors.int(c)\n    if (int) {\n      const newColor = _colorSwaps[int] || int\n      pixels[y * canvasWidth + x] = newColor\n    }\n  }\n\n  const getPixel = (x, y) => {\n    x = Math.floor(x - _cameraX)\n    y = Math.floor(y - _cameraY)\n    if (x < 0 || x >= canvasWidth || y < 0 || y >= canvasHeight)\n      return backgroundColor\n    return colors.lookupInt(pixels[y * canvasHeight + x])\n  }\n\n  const line = (x1, y1, x2, y2, c = 0) => {\n    drawLine({ x1, y1, x2, y2, setPixel, color: c })\n  }\n\n  const polyStroke = (points, ...args) => {\n    drawPolyStroke({ points, args, line })\n  }\n\n  const rectStroke = (x, y, w, h, c = 0) => {\n    drawRectStroke({\n      x,\n      y,\n      w,\n      h,\n      c,\n      line\n    })\n  }\n\n  const rectFill = (x, y, w, h, c = 0) => {\n    drawRectFill({\n      x,\n      y,\n      w,\n      h,\n      c,\n      line\n    })\n  }\n\n  const circStroke = (x, y, r, c = 0) => {\n    drawCircle({\n      cx: Math.floor(x),\n      cy: Math.floor(y),\n      radius: Math.floor(r),\n      color: c,\n      onlyStroke: true,\n      setPixel,\n      line\n    })\n  }\n\n  const circFill = (x, y, r, c = 0) => {\n    drawCircle({\n      cx: Math.floor(x),\n      cy: Math.floor(y),\n      radius: Math.floor(r),\n      color: c,\n      setPixel,\n      line\n    })\n  }\n\n  const print = (x, y, letters, c = 0) => {\n    drawText({\n      x,\n      y,\n      letters,\n      c,\n      setPixel\n    })\n  }\n\n  const sprite = (\n    x,\n    y,\n    spriteIndex,\n    darken = 0,\n    flipH = false,\n    flipV = false\n  ) => {\n    if (x - _cameraX < -8 || x - _cameraX > canvasWidth) return\n    if (y - _cameraY < -8 || y - _cameraY > canvasHeight) return\n\n    drawSprite({\n      x,\n      y,\n      spriteIndex,\n      darken,\n      flipH,\n      flipV,\n      setPixel,\n      sprites\n    })\n  }\n\n  const getTile = (mx, my) => {\n    const tile = get(_runningMap, [my, mx], null)\n    const result = tile !== null ? sprites[tile] : null\n    if (result) {\n      result.type = result[8] || 0\n      result.number = tile\n    }\n    return result\n  }\n\n  const setTile = (mx, my, spriteNumber) => {\n    _runningMap[my][mx] = spriteNumber\n  }\n\n  const map = (x = 0, y = 0) => {\n    // Loop over every element in the map\n    _runningMap.forEach((row, rowNumber) => {\n      row.forEach((spriteIndex, colNumber) => {\n        // If the element has a sprite index,\n        if (spriteIndex !== null) {\n          // Render at the correct offset position\n          const dx = (colNumber + x) * 8\n          const dy = (rowNumber + y) * 8\n          sprite(dx, dy, spriteIndex)\n        }\n      })\n    })\n  }\n\n  const resetMap = () => {\n    _runningMap = JSON.parse(JSON.stringify(initialMap))\n  }\n\n  return {\n    camera,\n    clear,\n    colorSwap,\n    setPixel,\n    getPixel,\n    line,\n    polyStroke,\n    rectStroke,\n    rectFill,\n    circStroke,\n    circFill,\n    print,\n    sprite,\n    getTile,\n    setTile,\n    map,\n    resetMap\n  }\n}\n\nexport default canvasAPI\n","export const drawRectStroke = ({ x, y, w, h, c, line }) => {\n  let left = Math.floor(x)\n  let right = Math.floor(x + w - 1)\n  let top = Math.floor(y)\n  let bottom = Math.floor(y + h - 1)\n  line(left, top, right, top, c)\n  line(left, bottom, right, bottom, c)\n  line(left, top, left, bottom, c)\n  line(right, top, right, bottom, c)\n}\n\nexport const drawRectFill = ({ x, y, w, h, c, line }) => {\n  let left = Math.floor(x)\n  let right = Math.floor(x + w - 1)\n  let top = Math.floor(y)\n  let bottom = Math.floor(y + h - 1)\n\n  for (let rectX = left; rectX <= right; rectX++) {\n    line(rectX, top, rectX, bottom, c)\n  }\n}\n","const pixelData = ({ width, height }) => {\n  // Pixel data has the actual image data object which can be passed to putImageData.\n  const _pixelData = new ImageData(width, height)\n\n  // This contains the actual binary data for setting on _pixelData. It cannot\n  // be accessed directly, but is instead modified through TypedArrays such as\n  // Uint8ClampedArray and Uint32Array. Both the TypedArrays below refer to\n  // the same backing buffer, so modifying values via one will be reflected in\n  // the other.\n  const _pixelBuffer = new ArrayBuffer(4 * width * height)\n\n  // The pixelBytes array is only used to set the data in the _pixelData\n  // object. ImageData only has an Uint8ClampedArray to access the underlying\n  // bytes, so a Uint8ClampedArray must be kept around to copy the data.\n  const _pixelBytes = new Uint8ClampedArray(_pixelBuffer)\n\n  // It turns out that setting pixels all at once via a single integer is much\n  // faster than setting each byte individually. So the pixel data is only\n  // ever modified via the Uint32Array for performance reasons.\n  const _pixelIntegers = new Uint32Array(_pixelBuffer)\n\n  const writePixelDataToCanvas = ctx => {\n    _pixelData.data.set(_pixelBytes)\n    ctx.putImageData(_pixelData, 0, 0)\n  }\n\n  return {\n    pixels: _pixelIntegers,\n    writePixelDataToCanvas\n  }\n}\n\nexport default pixelData\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport _ from 'lodash'\nimport classNames from 'classnames'\nimport canvasAPI from '../iframe/src/frameBufferCanvasAPI/index.js'\nimport pixelData from '../iframe/src/frameBufferCanvasAPI/pixelData.js'\nimport actions from '../actions/actions.js'\n\nconst mapStateToProps = ({ sprites, map }) => ({ sprites, map })\n\nconst mapDispatchToProps = dispatch => ({\n  updateMap: newMap => dispatch(actions.updateMap(newMap))\n})\n\nclass Map extends Component {\n  constructor(props) {\n    super(props)\n    this.handleOnMouseDown = this.handleOnMouseDown.bind(this)\n    this.handleOnMouseEnter = this.handleOnMouseEnter.bind(this)\n    this.handleOnMouseUp = this.handleOnMouseUp.bind(this)\n    this.handleOnTouchMove = this.handleOnTouchMove.bind(this)\n    this.handleSpriteClick = this.handleSpriteClick.bind(this)\n    this.handleRoomClick = this.handleRoomClick.bind(this)\n\n    this.spritePixelData = pixelData({ width: 128, height: 64 })\n    this.drawSprite = this.drawSprite.bind(this)\n    this.roomPixelData = pixelData({ width: 128, height: 128 })\n    this.drawRoom = this.drawRoom.bind(this)\n    this.mapPixelData = pixelData({ width: 128 * 8, height: 128 * 4 })\n    this.drawMap = this.drawMap.bind(this)\n    this.getCurrentRoom = this.getCurrentRoom.bind(this)\n    this.setMode = this.setMode.bind(this)\n\n    this.state = {\n      spriteIndex: 0,\n      roomIndex: 0,\n      mouseDown: false,\n      mode: '+'\n    }\n  }\n\n  componentDidMount() {\n    this.drawSprites()\n    this.drawRoom()\n    this.drawMap()\n  }\n\n  drawSprites() {\n    const { sprites } = this.props\n\n    this.spriteCanvasAPI = canvasAPI({\n      pixels: this.spritePixelData.pixels,\n      width: 128,\n      height: 64,\n      sprites\n    })\n    this.spriteCanvasAPI.clear()\n    Object.keys(sprites).forEach(skey => {\n      const key = +skey\n      const row = Math.floor(key / 16)\n      const col = key % 16\n      this.spriteCanvasAPI.sprite(col * 8, row * 8, key)\n    })\n    this.spritePixelData.writePixelDataToCanvas(\n      this._spriteCanvas.getContext('2d')\n    )\n  }\n\n  drawRoom() {\n    const before = Date.now()\n\n    const { sprites, map } = this.props\n    const { roomIndex } = this.state\n\n    this.roomCanvasAPI = canvasAPI({\n      pixels: this.roomPixelData.pixels,\n      width: 128,\n      height: 128,\n      sprites\n    })\n\n    this.roomCanvasAPI.clear()\n    _.range(16).forEach(rowN => {\n      _.range(16).forEach(colN => {\n        const sprite = _.get(map, [\n          Math.floor(roomIndex / 8) * 16 + rowN,\n          (roomIndex % 8) * 16 + colN\n        ])\n        this.roomCanvasAPI.sprite(colN * 8, rowN * 8, sprite)\n      })\n    })\n    this.roomPixelData.writePixelDataToCanvas(this._roomCanvas.getContext('2d'))\n\n    const after = Date.now()\n    console.log(`this.drawRoom() took: ${after - before}ms`)\n  }\n\n  drawMap() {\n    const before = Date.now()\n\n    const { map, sprites } = this.props\n    this.mapCanvasAPI = canvasAPI({\n      pixels: this.mapPixelData.pixels,\n      width: 128 * 8,\n      height: 128 * 4,\n      sprites,\n      map\n    })\n\n    this.mapCanvasAPI.clear()\n    map.forEach((row, rowNumber) => {\n      row.forEach((col, colNumber) => {\n        this.mapCanvasAPI.sprite(colNumber * 8, rowNumber * 8, col)\n      })\n    })\n    this.mapPixelData.writePixelDataToCanvas(this._mapCanvas.getContext('2d'))\n\n    const after = Date.now()\n    console.log(`this.drawMap() took: ${after - before}ms`)\n  }\n\n  componentDidUpdate() {\n    this.drawRoom()\n    this.drawMap()\n  }\n\n  handleOnMouseDown(e) {\n    this.setState({\n      mouseDown: true\n    })\n    const { row, col } = e.target.dataset\n    this.drawSprite({ row: +row, col: +col })\n  }\n\n  handleOnMouseEnter(e) {\n    if (this.state.mouseDown) {\n      const { row, col } = e.target.dataset\n      this.drawSprite({ row: +row, col: +col })\n    }\n  }\n\n  handleOnMouseUp() {\n    this.setState({\n      mouseDown: false\n    })\n  }\n\n  handleOnTouchMove(e) {\n    if (this.state.mouseDown) {\n      const touchLocation = e.changedTouches[0]\n      const dataset = document.elementFromPoint(\n        touchLocation.clientX,\n        touchLocation.clientY\n      ).dataset\n      const { row, col } = dataset\n      if (row && col) {\n        this.drawSprite({ row: +row, col: +col })\n      }\n    }\n  }\n\n  handleSpriteClick(spriteIndex) {\n    this.setState({ spriteIndex, mode: '+' })\n  }\n\n  handleRoomClick(roomIndex) {\n    this.setState({ roomIndex })\n  }\n\n  drawSprite({ row, col }) {\n    const { roomIndex, spriteIndex, mode } = this.state\n    const { updateMap } = this.props\n    const map = this.getCurrentRoom()\n    const newMap = JSON.parse(JSON.stringify(map))\n    newMap[Math.floor(roomIndex / 8) * 16 + row][(roomIndex % 8) * 16 + col] =\n      mode === '+' ? spriteIndex : null\n    updateMap(newMap)\n  }\n\n  getCurrentRoom() {\n    const { map } = this.props\n    return map.length ? map : Map.createBlankMap()\n  }\n\n  setMode(mode) {\n    this.setState({\n      mode\n    })\n  }\n\n  render() {\n    const { roomIndex, spriteIndex, mode } = this.state\n    const { map } = this.props\n    return (\n      <div\n        onMouseUp={this.handleOnMouseUp}\n        onTouchEnd={this.handleOnMouseUp}\n        className=\"Map two-rows-and-grid\"\n      >\n        <div className=\"main\">\n          <div className=\"MapEditor\">\n            <div className=\"room-and-tools\">\n              <div className=\"room\">\n                <table>\n                  <tbody>\n                    {_.range(16).map(row => (\n                      <tr key={row}>\n                        {_.range(16).map(col => {\n                          const sprite = _.get(map, [\n                            Math.floor(roomIndex / 8) * 16 + row,\n                            (roomIndex % 8) * 16 + col\n                          ])\n                          return (\n                            <td key={col}>\n                              <button\n                                data-row={row}\n                                data-col={col}\n                                onMouseDown={this.handleOnMouseDown}\n                                onMouseEnter={this.handleOnMouseEnter}\n                                onTouchStart={this.handleOnMouseDown}\n                                onTouchMove={this.handleOnTouchMove}\n                                className=\"background-\"\n                              >\n                                {_.isNil(sprite) ? 'x' : ''}\n                              </button>\n                            </td>\n                          )\n                        })}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n                <canvas\n                  width={128}\n                  height={128}\n                  ref={_roomCanvas => {\n                    this._roomCanvas = _roomCanvas\n                  }}\n                />\n              </div>\n              <div className=\"tools\">\n                <button\n                  className={classNames('button', {\n                    active: mode === '+'\n                  })}\n                  onClick={() => {\n                    this.setMode('+')\n                  }}\n                >\n                  +\n                </button>\n\n                <button\n                  className={classNames('button', {\n                    active: mode === '-'\n                  })}\n                  onClick={() => {\n                    this.setMode('-')\n                  }}\n                >\n                  -\n                </button>\n              </div>\n            </div>\n            <div className=\"sprites-and-map\">\n              <div className=\"sprites\">\n                <table>\n                  <tbody>\n                    {_.range(8).map(row => (\n                      <tr key={row}>\n                        {_.range(16).map(col => {\n                          const thisSpriteIndex = row * 16 + col\n                          return (\n                            <td\n                              className={classNames({\n                                active:\n                                  spriteIndex === thisSpriteIndex &&\n                                  mode === '+'\n                              })}\n                              key={col}\n                            >\n                              <button\n                                onClick={() =>\n                                  this.handleSpriteClick(thisSpriteIndex)\n                                }\n                              />\n                            </td>\n                          )\n                        })}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n                <canvas\n                  width={128}\n                  height={64}\n                  ref={_spriteCanvas => {\n                    this._spriteCanvas = _spriteCanvas\n                  }}\n                />\n              </div>\n              <div className=\"map\">\n                <table>\n                  <tbody>\n                    {_.range(4).map(row => (\n                      <tr key={row}>\n                        {_.range(8).map(col => {\n                          const thisRoomIndex = row * 8 + col\n                          return (\n                            <td\n                              className={classNames({\n                                active: roomIndex === thisRoomIndex\n                              })}\n                              key={col}\n                            >\n                              <button\n                                onClick={() =>\n                                  this.handleRoomClick(thisRoomIndex)\n                                }\n                              />\n                            </td>\n                          )\n                        })}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n                <canvas\n                  width={128 * 8}\n                  height={128 * 4}\n                  ref={_mapCanvas => {\n                    this._mapCanvas = _mapCanvas\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nMap.createBlankMap = () => _.range(64).map(() => _.range(128).map(() => null))\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Map)\n","const settings = {\n  octaves: 4,\n  volumes: 8,\n  phrases: 8 * 8,\n  chains: 8 * 8,\n  songs: 8,\n  matrixLength: 16,\n  chainChannels: 4,\n  startOffset: '+0.1',\n  startOffsetDouble: '+0.5',\n  bpm: 144,\n  subdivision: '4n'\n}\n\nexport default settings\n","import settings from './settings.js'\nconst normalize = {\n  volume: vol => (vol + 1) / settings.volumes,\n  note: note => note\n}\n\nexport default normalize\n","import * as Tone from 'tone'\nimport _ from 'lodash'\nimport toLetter from '../toLetter.js'\nimport normalize from '../normalize.js'\nimport settings from '../settings.js'\n\nconst pulseOptions = {\n  oscillator: {\n    type: 'triangle'\n  },\n  envelope: {\n    release: 0.07\n  }\n}\n\nconst tempoToPlaybackRate = tempo => [1, 2, 3, 5, 8, 13, 21, 34][tempo]\nconst tempoToSubdivision = tempo => tempoToPlaybackRate(tempo) * 4 + 'n'\n\nconst createSynth = volumeNode => {\n  const pulseSynth = new Tone.Synth(pulseOptions)\n  if (volumeNode) {\n    pulseSynth.chain(volumeNode, Tone.Master)\n  } else {\n    pulseSynth.chain(Tone.Master)\n  }\n  return pulseSynth\n}\n\nconst playNote = ({\n  note,\n  octave,\n  volume,\n  time = Tone.context.currentTime,\n  synth,\n  tempo\n}) => {\n  // If time is not provided, we want to play the note right now - use currentTime.\n  // If time is provided,\n  // if it is in the past (smaller than currentTime),\n  // don't play the note.\n  // Otherwise play the note.\n  if (time >= Tone.context.currentTime) {\n    const normalizedVolume = normalize.volume(volume)\n    const letter = toLetter(note + octave * 12, true, true)\n    const subdivision = tempoToSubdivision(tempo)\n    synth.triggerAttackRelease(letter, subdivision, time, normalizedVolume)\n  }\n}\n\nconst soundAPI = volumeNode => {\n  const chainSynths = _.range(settings.chainChannels).map(() =>\n    createSynth(volumeNode)\n  )\n  const phraseSynth = createSynth(volumeNode)\n\n  Tone.Transport.bpm.value = settings.bpm\n  Tone.Transport.start(settings.startOffset)\n\n  let songContainers = {}\n  let localPhrases = {}\n  let phrasePool = []\n\n  const stopSong = () => {\n    // Stop all sequences.\n    // console.log('soundAPI.stopSong() BEGIN----------')\n    // const before = Date.now()\n    _.forEach(songContainers, ({ sequence }, key) => {\n      if (sequence) {\n        sequence.stop()\n        // console.log(`stopping song with key: ${key}`)\n      }\n    })\n    // const after = Date.now()\n    // console.log(`soundAPI.stopSong() END ${after - before}ms`)\n  }\n\n  const makeSongs = ({ songs, chains, phrases }) => {\n    // console.log(`soundAPI.makeSongs() BEGIN----------`)\n    // const before = Date.now()\n    stopSong()\n    localPhrases = phrases\n    songContainers = _.mapValues(songs, song =>\n      makeSongContainer({ song, chains, phrases })\n    )\n    // const after = Date.now()\n    // console.log(`soundAPI.makeSongs() END ${after - before}ms`)\n  }\n\n  const makeSongContainer = ({ song, chains, phrases }) => {\n    // const before = Date.now()\n    // Create an array of note positions.\n    // There's a lot going on here, but the gist:\n    // create an array of all the notes, but remove nulls from the end,\n    // so that we can make a Tone Sequence that is the right length and no more.\n    // This is good for performance.\n\n    // For matrixLength cubed (chains * phrases * notes),\n    const notePositions = _(_.range(Math.pow(settings.matrixLength, 3)))\n      .map(index => {\n        // Get the chain, phrase and note positions by using base math.\n        const [chainPosition, phrasePosition, notePosition] = _.padStart(\n          index.toString(settings.matrixLength),\n          3,\n          0\n        )\n          .split('')\n          .map(d => parseInt(d, settings.matrixLength))\n\n        // Get the chain index for this position.\n        const chainIndex = _.get(song, chainPosition)\n\n        // Get the chain.\n        const chain = _.get(chains, chainIndex)\n\n        // Get the phrase indices for this position, e.g. { 0: 0, 1: 11, 2: 2 }\n        const phrasesIndices = _.get(chain, phrasePosition)\n\n        // For each channel,\n        return (\n          _.range(settings.chainChannels)\n            .map(channel => {\n              // Get the phrase index for this channel.\n              const phraseIndex = _.get(phrasesIndices, channel)\n              let result\n\n              // If the phrase index exists,\n              if (!_.isNil(phraseIndex)) {\n                // get the phrase assigned to this channel.\n                const phrase = _.get(phrases, phraseIndex, {})\n\n                // Get the note element for this position.\n                const noteElement = _.get(phrase.notes, notePosition)\n\n                // If we have a note,\n                if (!_.isNil(noteElement)) {\n                  // add it to the result.\n                  result = {\n                    channel,\n                    noteElement\n                  }\n                }\n              }\n              return result\n            })\n            // Only keep non-null elements.\n            .filter(d => d)\n        )\n      })\n      // NOW we can drop from right.\n      .dropRightWhile(_.isEmpty)\n      .value()\n\n    const callback = (time, position) => {\n      notePositions[position].forEach(d => {\n        const { channel, noteElement } = d\n        playNote({\n          ...noteElement,\n          time: time,\n          synth: chainSynths[channel],\n          tempo: 0\n        })\n      })\n    }\n\n    const events = _.range(notePositions.length)\n\n    // const after = Date.now()\n    // console.log(`soundAPI.makeSongContainer() took ${after - before}ms`)\n\n    return {\n      callback,\n      events,\n      sequence: null\n    }\n  }\n\n  const playSong = (number, loop = false) => {\n    // console.log(`soundAPI.playSong() BEGIN----------`)\n    // const before = Date.now()\n    stopSong()\n\n    // console.log(`going to play song with key ${number}`)\n    _.forEach(songContainers, (value, key) => {\n      if (+key === number) {\n        // console.log(`found one: key ${key}`)\n        value.sequence = new Tone.Sequence(\n          value.callback,\n          value.events,\n          settings.subdivision\n        )\n        value.sequence.loop = loop\n        value.sequence.playbackRate = tempoToPlaybackRate(0)\n        value.sequence.start(settings.startOffset)\n      }\n    })\n    // const after = Date.now()\n    // console.log(`soundAPI.playSong() END took ${after - before}ms`)\n  }\n\n  const playPhrase = number => {\n    // const before = Date.now()\n    const phrase = _.get(localPhrases, number)\n    if (phrase) {\n      while (phrasePool.length) {\n        const popped = phrasePool.pop()\n        popped.dispose()\n      }\n\n      const { tempo } = phrase\n\n      const sequence = new Tone.Sequence(\n        (time, index) => {\n          const value = phrase.notes[index]\n          if (value) {\n            // console.log(`phraseSynth volume`)\n            // console.log({ volume: phraseSynth.volume.value })\n            playNote({ ...value, time, synth: phraseSynth, tempo })\n          }\n        },\n        _.range(settings.matrixLength),\n        settings.subdivision\n      )\n      sequence.loop = false\n      sequence.playbackRate = tempoToPlaybackRate(tempo)\n      sequence.start()\n      phrasePool.push(sequence)\n      // const after = Date.now()\n      // console.log(`soundAPI.playPhrase() took ${after - before}ms`)\n    }\n  }\n  return {\n    playSong,\n    makeSongs,\n    stopSong,\n    playPhrase\n  }\n}\n\nexport { createSynth, playNote, tempoToPlaybackRate }\n\nexport default soundAPI\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst TextInput = ({ label, value, type, handleChange, options }) => (\n  <div className='TextInput'>\n    <label>\n      {label}\n      <input type={type} value={value} {...options} onChange={handleChange} />\n    </label>\n  </div>\n)\n\nTextInput.propTypes = {\n  label: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  value: PropTypes.string.isRequired,\n  handleChange: PropTypes.func.isRequired,\n  options: PropTypes.object\n}\n\nexport default TextInput\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport _ from 'lodash'\nimport * as Tone from 'tone'\nimport classNames from 'classnames'\nimport {\n  createSynth,\n  playNote,\n  tempoToPlaybackRate\n} from '../iframe/src/soundAPI/index.js'\nimport actions from '../actions/actions.js'\nimport TextInput from '../components/TextInput.js'\nimport toLetter from '../iframe/src/toLetter.js'\nimport settings from '../iframe/src/settings.js'\n\nconst synth = createSynth()\nTone.Transport.bpm.value = settings.bpm\nTone.Transport.start(settings.startOffset)\n\nconst getCurrentPhrase = ({ phrases, selectedUi }) => ({\n  tempo: 0,\n  notes: [],\n  ..._.get(phrases, [selectedUi.phrase], {})\n})\n\nconst mapStateToProps = ({ phrases, selectedUi }) => ({ phrases, selectedUi })\n\nconst mapDispatchToProps = dispatch => ({\n  selectUi: payload => dispatch(actions.selectUi(payload)),\n  updatePhrase: ({ phrase, index }) =>\n    dispatch(\n      actions.updatePhrase({\n        phrase,\n        index\n      })\n    )\n})\n\nclass Phrase extends Component {\n  constructor(props) {\n    super(props)\n\n    this.createSequence = this.createSequence.bind(this)\n    this.handleTempoChange = this.handleTempoChange.bind(this)\n    this.handlePhraseIndexChange = this.handlePhraseIndexChange.bind(this)\n    this.handleNoteClick = this.handleNoteClick.bind(this)\n    this.handleVolumeClick = this.handleVolumeClick.bind(this)\n    this.handlePlay = this.handlePlay.bind(this)\n    this.drawCallback = this.drawCallback.bind(this)\n\n    this.state = {\n      isPlaying: false,\n      playingIndex: 0\n    }\n  }\n\n  drawCallback(playingIndex) {\n    this.setState({\n      playingIndex\n    })\n  }\n\n  componentDidMount() {\n    Tone.context.resume()\n\n    const phrase = getCurrentPhrase(this.props)\n    this.sequence = this.createSequence()\n    this.sequence.playbackRate = tempoToPlaybackRate(phrase.tempo)\n  }\n\n  createSequence() {\n    return new Tone.Sequence(\n      (time, index) => {\n        const phrase = getCurrentPhrase(this.props)\n        const value = phrase.notes[index]\n        if (value) {\n          playNote({ ...value, time, synth, tempo: phrase.tempo })\n        }\n        Tone.Draw.schedule(() => {\n          this.drawCallback(index)\n        }, time)\n      },\n      _.range(settings.matrixLength),\n      settings.subdivision\n    )\n  }\n\n  handleTempoChange(e) {\n    const { validity, value } = e.target\n    if (validity.valid) {\n      // Update the sequence.\n      this.sequence.playbackRate = tempoToPlaybackRate(value)\n\n      // Update the store.\n      const { updatePhrase, selectedUi } = this.props\n      const phraseIndex = selectedUi.phrase\n      const phrase = getCurrentPhrase(this.props)\n      const newPhrase = {\n        ...phrase,\n        tempo: value\n      }\n      updatePhrase({ phrase: newPhrase, index: phraseIndex })\n    }\n  }\n\n  handlePlay() {\n    const { isPlaying } = this.state\n    if (isPlaying) {\n      this.sequence.stop()\n    } else {\n      this.sequence.start(settings.startOffset)\n    }\n    this.setState({\n      isPlaying: !isPlaying,\n      playingIndex: 0\n    })\n  }\n\n  handlePhraseIndexChange(e) {\n    const { validity, value } = e.target\n    if (validity.valid) {\n      const { selectUi, selectedUi } = this.props\n      selectUi({\n        ...selectedUi,\n        phrase: value\n      })\n    }\n  }\n\n  handleVolumeClick(col) {\n    const { updatePhrase, selectedUi } = this.props\n    const phraseIndex = selectedUi.phrase\n    const { isPlaying } = this.state\n    const phrase = getCurrentPhrase(this.props)\n    const { tempo } = phrase\n    const position = phrase.notes[col]\n    let newPosition\n\n    // If we do not have a note on this column,\n    if (!position) {\n      // add one at note 0.\n      newPosition = {\n        note: 11,\n        octave: settings.octaves - 1,\n        volume: settings.volumes - 1\n      }\n    } else {\n      const { volume } = position\n\n      // If we do have a note on this column, and we're not at 0,\n      if (volume > 0) {\n        // decrease it.\n        newPosition = {\n          ...position,\n          volume: volume - 1\n        }\n      } else {\n        // If we are at the max volume,\n        // remove the note.\n        newPosition = null\n      }\n    }\n\n    if (newPosition && !isPlaying) {\n      playNote({ ...newPosition, synth, tempo })\n    }\n\n    const newPhrase = {\n      ...phrase,\n      notes: {\n        ...phrase.notes,\n        [col]: newPosition\n      }\n    }\n\n    updatePhrase({ phrase: newPhrase, index: phraseIndex })\n  }\n\n  handleNoteClick({ row, col }) {\n    const { updatePhrase, selectedUi } = this.props\n    const phraseIndex = selectedUi.phrase\n    const { isPlaying } = this.state\n    const phrase = getCurrentPhrase(this.props)\n    const { tempo } = phrase\n    const position = phrase.notes[col]\n    let newNote\n\n    // If we do not have a note on this column,\n    if (!position) {\n      // add one at the highest octave.\n      newNote = {\n        note: row,\n        octave: settings.octaves - 1,\n        volume: settings.volumes - 1\n      }\n    } else {\n      const { note, octave } = position\n\n      // If we do have a note on this column, but not on this row,\n      if (note !== row) {\n        // update the note to this row, and use the same octave.\n        newNote = {\n          ...position,\n          note: row\n        }\n      } else {\n        // If we have a note on this very column and row,\n        // and we're not at 0,\n        if (octave > 0) {\n          // decrease it.\n          newNote = {\n            ...position,\n            octave: octave - 1\n          }\n        } else {\n          newNote = null\n        }\n      }\n    }\n\n    if (newNote && !isPlaying) {\n      playNote({ ...newNote, synth, tempo })\n    }\n\n    const newPhrase = {\n      ...phrase,\n      notes: {\n        ...phrase.notes,\n        [col]: newNote\n      }\n    }\n\n    updatePhrase({ phrase: newPhrase, index: phraseIndex })\n  }\n\n  componentWillUnmount() {\n    this.drawCallback = () => {}\n    this.sequence.stop()\n  }\n\n  componentDidUpdate(prevProps) {\n    const oldPhrase = getCurrentPhrase(prevProps)\n    const newPhrase = getCurrentPhrase(this.props)\n    if (\n      prevProps.selectedUi.phrase !== this.props.selectedUi.phrase ||\n      oldPhrase.tempo !== newPhrase.tempo\n    ) {\n      this.sequence.playbackRate = tempoToPlaybackRate(newPhrase.tempo)\n    }\n  }\n\n  render() {\n    const { selectedUi } = this.props\n    const phraseIndex = selectedUi.phrase\n\n    const { isPlaying, playingIndex } = this.state\n    const phrase = getCurrentPhrase(this.props)\n\n    return (\n      <div className=\"Phrase two-rows-and-grid\">\n        <div className=\"main\">\n          <div className=\"settings\">\n            <div className=\"title\">Phrase</div>\n            <TextInput\n              label=\"#\"\n              value={phraseIndex.toString()}\n              handleChange={this.handlePhraseIndexChange}\n              type=\"number\"\n              options={{ min: 0, max: settings.phrases - 1 }}\n            />\n            <div className=\"title\">Tempo</div>\n            <TextInput\n              label=\"#\"\n              value={phrase.tempo.toString()}\n              handleChange={this.handleTempoChange}\n              type=\"number\"\n              options={{ min: 0, max: 7 }}\n            />\n          </div>\n          <div className=\"matrix\">\n            <button\n              className={classNames('play button', { active: isPlaying })}\n              onClick={this.handlePlay}\n            >\n              {isPlaying ? 'stop' : 'play'}\n            </button>\n            <table className=\"notes\">\n              <tbody>\n                {_.range(11, -1).map(row => (\n                  <tr key={row}>\n                    <td>{toLetter(row)}</td>\n                    {_.range(settings.matrixLength).map(col => {\n                      const value = phrase.notes[col]\n                      const match = value && value.note === row\n                      const highlighter =\n                        row === 11 && col === playingIndex && isPlaying ? (\n                          <span className=\"highlight\" />\n                        ) : null\n                      return (\n                        <td\n                          key={col}\n                          onClick={() => this.handleNoteClick({ row, col })}\n                          className={classNames({\n                            match,\n                            highlight: col === playingIndex && isPlaying,\n                            [`octave-${value && value.octave}`]: match\n                          })}\n                        >\n                          {highlighter}\n                          <button>{match ? value.octave : ' '}</button>\n                        </td>\n                      )\n                    })}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n            <table className=\"volumes\">\n              <tbody>\n                <tr>\n                  <td>v</td>\n                  {_.range(settings.matrixLength).map(col => {\n                    const value = phrase.notes[col]\n                    const highlighter =\n                      col === playingIndex && isPlaying ? (\n                        <span className=\"highlight\" />\n                      ) : null\n                    return (\n                      <td\n                        key={col}\n                        className={classNames({\n                          highlight: col === playingIndex && isPlaying,\n                          [`volume-${value && value.volume}`]: value\n                        })}\n                        onClick={e => this.handleVolumeClick(col)}\n                      >\n                        {highlighter}\n                        <button>{value && value.volume}</button>\n                      </td>\n                    )\n                  })}\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Phrase)\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport _ from 'lodash'\nimport * as Tone from 'tone'\nimport classNames from 'classnames'\nimport { createSynth, playNote } from '../iframe/src/soundAPI/index.js'\nimport actions from '../actions/actions.js'\nimport TextInput from '../components/TextInput.js'\nimport settings from '../iframe/src/settings.js'\n\nconst synths = _.range(settings.chainChannels).map(() => createSynth())\nTone.Transport.bpm.value = settings.bpm\nTone.Transport.start(settings.startOffset)\n\nconst mapStateToProps = ({ chains, phrases, selectedUi }) => ({\n  chains,\n  phrases,\n  selectedUi\n})\n\nconst mapDispatchToProps = dispatch => ({\n  selectUi: payload => dispatch(actions.selectUi(payload)),\n  updateChain: ({ chain, index }) =>\n    dispatch(\n      actions.updateChain({\n        chain,\n        index\n      })\n    )\n})\n\nclass Chain extends Component {\n  constructor(props) {\n    super(props)\n\n    this.handleChainIndexChange = this.handleChainIndexChange.bind(this)\n    this.handlePhraseClick = this.handlePhraseClick.bind(this)\n    this.getCurrentChain = this.getCurrentChain.bind(this)\n    this.handlePlay = this.handlePlay.bind(this)\n    this.drawCallback = this.drawCallback.bind(this)\n\n    this.state = {\n      isPlaying: false,\n      playingIndex: 0\n    }\n  }\n\n  drawCallback(playingIndex) {\n    this.setState({\n      playingIndex\n    })\n  }\n\n  componentDidMount() {\n    Tone.context.resume()\n\n    const { phrases } = this.props\n\n    this.sequence = new Tone.Sequence(\n      (time, index) => {\n        const chain = this.getCurrentChain()\n\n        // Get the phrase and note positions by using base math.\n        const [phrasePosition, notePosition] = _.padStart(\n          index.toString(settings.matrixLength),\n          2,\n          0\n        )\n          .split('')\n          .map(d => parseInt(d, settings.matrixLength))\n\n        // Get the phrase indices for this position, e.g. { 0: 0, 1: 11, 2: 2 }\n        const phrasesIndices = _.get(chain, phrasePosition)\n\n        // For each channel,\n        _.range(settings.chainChannels).forEach(channel => {\n          // get the phrase index.\n          const phraseIndex = _.get(phrasesIndices, channel)\n\n          // If the phrase index exists,\n          if (!_.isNil(phraseIndex)) {\n            // get the phrase assigned to this channel.\n            const phrase = _.get(phrases, phraseIndex, {})\n\n            // Get the note element for this position.\n            const noteElement = _.get(phrase.notes, notePosition)\n\n            // If we have a note,\n            if (!_.isNil(noteElement)) {\n              // play it!\n              playNote({\n                ...noteElement,\n                time,\n                synth: synths[channel],\n                tempo: 0\n              })\n            }\n          }\n        })\n        Tone.Draw.schedule(() => {\n          this.drawCallback(phrasePosition)\n        }, time)\n      },\n      _.range(Math.pow(settings.matrixLength, 2)),\n      settings.subdivision\n    )\n  }\n\n  getCurrentChain() {\n    const { chains, selectedUi } = this.props\n    return _.get(chains, [selectedUi.chain], {})\n  }\n\n  handlePlay() {\n    const { isPlaying } = this.state\n    if (isPlaying) {\n      this.sequence.stop()\n    } else {\n      this.sequence.start(settings.startOffset)\n    }\n    this.setState({\n      isPlaying: !isPlaying,\n      playingIndex: 0\n    })\n  }\n\n  handleChainIndexChange(e) {\n    const { validity, value } = e.target\n    if (validity.valid) {\n      const { selectUi, selectedUi } = this.props\n      selectUi({\n        ...selectedUi,\n        chain: value\n      })\n    }\n  }\n\n  handlePhraseClick({ channel, col }) {\n    const { phrases, updateChain, selectedUi } = this.props\n    const chainIndex = selectedUi.chain\n    const chain = this.getCurrentChain()\n    const newChain = _.cloneDeep(chain)\n    let newPhrase = _.get(newChain, [col, channel])\n\n    // Get all phrases, in order.\n    const allPhrases = _(Object.keys(phrases))\n      .sortBy(d => +d)\n      .uniq()\n      .map(d => +d)\n      .value()\n\n    // If the cell is empty,\n    if (_.isNil(newPhrase)) {\n      // add the last overall phrase.\n      newPhrase = _.last(allPhrases)\n    } else {\n      // If the cell is not empty,\n      // get the phrase index.\n      const newPhraseIndex = _.indexOf(allPhrases, newPhrase)\n\n      // If it shows the first overall phrase,\n      if (newPhraseIndex === 0) {\n        // clear the cell.\n        newPhrase = null\n      } else {\n        // Else decrease phrase.\n        newPhrase = allPhrases[newPhraseIndex - 1]\n      }\n    }\n\n    _.setWith(newChain, [col, channel], newPhrase, Object)\n\n    updateChain({ chain: newChain, index: chainIndex })\n  }\n\n  componentWillUnmount() {\n    this.drawCallback = () => {}\n    this.sequence.stop()\n  }\n\n  render() {\n    const { selectedUi } = this.props\n    const chainIndex = selectedUi.chain\n    const { isPlaying, playingIndex } = this.state\n    const chain = this.getCurrentChain()\n    const { phrases } = this.props\n\n    return (\n      <div className=\"Chain two-rows-and-grid\">\n        <div className=\"main\">\n          <div className={classNames('warning', { hide: !_.isEmpty(phrases) })}>\n            error: no phrases found\n          </div>\n          <div className={classNames('settings', { hide: _.isEmpty(phrases) })}>\n            <div className=\"title\">Chain</div>\n            <TextInput\n              label=\"#\"\n              value={chainIndex.toString()}\n              handleChange={this.handleChainIndexChange}\n              type=\"number\"\n              options={{ min: 0, max: settings.chains - 1 }}\n            />\n          </div>\n          <div className={classNames('matrix', { hide: _.isEmpty(phrases) })}>\n            <button\n              className={classNames('play button', { active: isPlaying })}\n              onClick={this.handlePlay}\n            >\n              {isPlaying ? 'stop' : 'play'}\n            </button>\n            <table className=\"phrases\">\n              <tbody>\n                {_.range(settings.chainChannels).map(channel => (\n                  <tr key={channel}>\n                    <td>{channel}</td>\n                    {_.range(settings.matrixLength).map(col => {\n                      const phrase = _.get(chain, [col, channel])\n                      const highlighter =\n                        channel === 0 && col === playingIndex && isPlaying ? (\n                          <span className=\"highlight\" />\n                        ) : null\n                      return (\n                        <td\n                          key={col}\n                          className={classNames({\n                            highlight:\n                              col === playingIndex &&\n                              isPlaying &&\n                              !_.isNil(phrase)\n                          })}\n                          onClick={() =>\n                            this.handlePhraseClick({ channel, col })\n                          }\n                        >\n                          {highlighter}\n                          <button>\n                            <span>\n                              {_.isNil(phrase) ? '' : _.padStart(phrase, 2, 0)}\n                            </span>\n                          </button>\n                        </td>\n                      )\n                    })}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Chain)\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport _ from 'lodash'\nimport * as Tone from 'tone'\nimport classNames from 'classnames'\nimport { createSynth, playNote } from '../iframe/src/soundAPI/index.js'\nimport actions from '../actions/actions.js'\nimport TextInput from '../components/TextInput.js'\nimport settings from '../iframe/src/settings.js'\n\nconst synths = _.range(settings.chainChannels).map(() => createSynth())\nTone.Transport.bpm.value = settings.bpm\nTone.Transport.start(settings.startOffset)\n\nconst mapStateToProps = ({ songs, chains, phrases, selectedUi }) => ({\n  songs,\n  chains,\n  phrases,\n  selectedUi\n})\n\nconst mapDispatchToProps = dispatch => ({\n  selectUi: payload => dispatch(actions.selectUi(payload)),\n  updateSong: ({ song, index }) =>\n    dispatch(\n      actions.updateSong({\n        song,\n        index\n      })\n    )\n})\n\nclass Song extends Component {\n  constructor(props) {\n    super(props)\n\n    this.handleSongIndexChange = this.handleSongIndexChange.bind(this)\n    this.handleChainClick = this.handleChainClick.bind(this)\n    this.getCurrentSong = this.getCurrentSong.bind(this)\n    this.handlePlay = this.handlePlay.bind(this)\n    this.drawCallback = this.drawCallback.bind(this)\n\n    this.state = {\n      isPlaying: false,\n      playingIndex: 0\n    }\n  }\n\n  drawCallback(playingIndex) {\n    this.setState({\n      playingIndex\n    })\n  }\n\n  componentDidMount() {\n    Tone.context.resume()\n\n    const { chains, phrases } = this.props\n\n    this.sequence = new Tone.Sequence(\n      (time, index) => {\n        const song = this.getCurrentSong()\n\n        // Get the chain, phrase and note positions by using base math.\n        const [chainPosition, phrasePosition, notePosition] = _.padStart(\n          index.toString(settings.matrixLength),\n          3,\n          0\n        )\n          .split('')\n          .map(d => parseInt(d, settings.matrixLength))\n\n        // Get the chain index for this position.\n        const chainIndex = _.get(song, chainPosition)\n\n        // Get the chain.\n        const chain = _.get(chains, chainIndex)\n\n        // Get the phrase indices for this position, e.g. { 0: 0, 1: 11, 2: 2 }\n        const phrasesIndices = _.get(chain, phrasePosition)\n\n        // For each channel,\n        _.range(settings.chainChannels).forEach(channel => {\n          // get the phrase index.\n          const phraseIndex = _.get(phrasesIndices, channel)\n\n          // If the phrase index exists,\n          if (!_.isNil(phraseIndex)) {\n            // get the phrase assigned to this channel.\n            const phrase = _.get(phrases, phraseIndex, {})\n\n            // Get the note element for this position.\n            const noteElement = _.get(phrase.notes, notePosition)\n\n            // If we have a note,\n            if (!_.isNil(noteElement)) {\n              // play it!\n              playNote({\n                ...noteElement,\n                time,\n                synth: synths[channel],\n                tempo: 0\n              })\n            }\n          }\n        })\n\n        Tone.Draw.schedule(() => {\n          this.drawCallback(chainPosition)\n        }, time)\n      },\n      _.range(Math.pow(settings.matrixLength, 3)),\n      settings.subdivision\n    )\n  }\n\n  getCurrentSong() {\n    const { songs, selectedUi } = this.props\n    return _.get(songs, [selectedUi.song], {})\n  }\n\n  handlePlay() {\n    const { isPlaying } = this.state\n    if (isPlaying) {\n      this.sequence.stop()\n    } else {\n      this.sequence.start(settings.startOffset)\n    }\n    this.setState({\n      isPlaying: !isPlaying,\n      playingIndex: 0\n    })\n  }\n\n  handleSongIndexChange(e) {\n    const { validity, value } = e.target\n    if (validity.valid) {\n      const { selectUi, selectedUi } = this.props\n      selectUi({\n        ...selectedUi,\n        song: value\n      })\n    }\n  }\n\n  handleChainClick({ col }) {\n    const { chains, updateSong, selectedUi } = this.props\n    const songIndex = selectedUi.song\n    const song = this.getCurrentSong()\n    let newChain = _.get(song, col)\n\n    // Get chains, in order.\n    const sortedChains = _(Object.keys(chains))\n      .sortBy(d => +d)\n      .uniq()\n      .map(d => +d)\n      .value()\n\n    // If the cell is empty,\n    if (_.isNil(newChain)) {\n      // set the last chain.\n      newChain = _.last(sortedChains)\n    } else {\n      // If the cell is not empty,\n      // and if it shows the first chain,\n      const newChainIndex = _.indexOf(sortedChains, newChain)\n\n      if (newChainIndex === 0) {\n        // clear.\n        newChain = null\n      } else {\n        // Otherwise decrease chain.\n        newChain = sortedChains[newChainIndex - 1]\n      }\n    }\n\n    const newSong = {\n      ...song,\n      [col]: newChain\n    }\n\n    updateSong({ song: newSong, index: songIndex })\n  }\n\n  componentWillUnmount() {\n    this.drawCallback = () => {}\n    this.sequence.stop()\n  }\n\n  render() {\n    const { selectedUi } = this.props\n    const songIndex = selectedUi.song\n    const { isPlaying, playingIndex } = this.state\n    const song = this.getCurrentSong()\n    const { chains } = this.props\n\n    return (\n      <div className=\"Song two-rows-and-grid\">\n        <div className=\"main\">\n          <div className={classNames('warning', { hide: !_.isEmpty(chains) })}>\n            error: no chains found\n          </div>\n          <div className={classNames('settings', { hide: _.isEmpty(chains) })}>\n            <div className=\"title\">Song</div>\n            <TextInput\n              label=\"#\"\n              value={songIndex.toString()}\n              handleChange={this.handleSongIndexChange}\n              type=\"number\"\n              options={{ min: 0, max: settings.songs - 1 }}\n            />\n          </div>\n          <div className={classNames('matrix', { hide: _.isEmpty(chains) })}>\n            <button\n              className={classNames('play button', { active: isPlaying })}\n              onClick={this.handlePlay}\n            >\n              {isPlaying ? 'stop' : 'play'}\n            </button>\n            <table className=\"songs\">\n              <tbody>\n                <tr>\n                  <td>c</td>\n                  {_.range(settings.matrixLength).map(col => {\n                    const chain = _.get(song, col)\n                    const highlighter =\n                      col === playingIndex && isPlaying ? (\n                        <span className=\"highlight\" />\n                      ) : null\n                    return (\n                      <td\n                        key={col}\n                        className={classNames({\n                          highlight:\n                            col === playingIndex && isPlaying && !_.isNil(chain)\n                        })}\n                        onClick={() => this.handleChainClick({ col })}\n                      >\n                        {highlighter}\n                        <button>\n                          <span>\n                            {_.isNil(chain) ? '' : _.padStart(chain, 2, 0)}\n                          </span>\n                        </button>\n                      </td>\n                    )\n                  })}\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Song)\n","const patcher = ({ slides, index }) => {\n  return slides\n    .slice(0, index + 1)\n    .map(d => d.game)\n    .reduce((accumulator, current) => {\n      if (current && current.length) {\n        const lines = accumulator.split('\\n')\n\n        // If it starts with one of the patching keywords,\n        // run the patch.\n        // Otherwise return text.\n\n        const deleteOne = current.match(/^DEL(\\d+)$/)\n        const deleteRange = current.match(/^DEL(\\d+)-(\\d+)$/)\n        const replaceOne = current.match(/^REP(\\d+)/)\n        const replaceRange = current.match(/^REP(\\d+)-(\\d+)/)\n        const add = current.match(/^ADD(\\d+)/)\n        const same = current.match(/^SAME$/)\n        if (deleteOne) {\n          // Get line number to delete.\n          const lineNumberToDelete = +deleteOne[1]\n          // Delete the line.\n          const newLines = [\n            ...lines.slice(0, lineNumberToDelete),\n            ...lines.slice(lineNumberToDelete + 1)\n          ]\n\n          return newLines.join('\\n')\n        } else if (deleteRange) {\n          // Get line numbers to delete.\n          const lineNumberToDeleteStart = +deleteRange[1]\n          const lineNumberToDeleteEnd = +deleteRange[2]\n          const newLines = [\n            ...lines.slice(0, lineNumberToDeleteStart),\n            ...lines.slice(lineNumberToDeleteEnd + 1)\n          ]\n\n          return newLines.join('\\n')\n        } else if (replaceRange) {\n          // Get line numbers to delete.\n          const lineNumberToReplaceStart = +replaceRange[1]\n          const lineNumberToReplaceEnd = +replaceRange[2]\n          const newLines = [\n            ...lines.slice(0, lineNumberToReplaceStart),\n            ...current.substring(replaceRange[0].length + 1).split('\\n'),\n            ...lines.slice(lineNumberToReplaceEnd + 1)\n          ]\n\n          return newLines.join('\\n')\n        } else if (replaceOne) {\n          const lineNumberToReplace = +replaceOne[1]\n          const newLines = [\n            ...lines.slice(0, lineNumberToReplace),\n            ...current.substring(replaceOne[0].length + 1).split('\\n'),\n            ...lines.slice(lineNumberToReplace + 1)\n          ]\n\n          return newLines.join('\\n')\n        } else if (add) {\n          // Get line numbers to add.\n          const lineNumberToAdd = +add[1]\n          const newLines = [\n            ...lines.slice(0, lineNumberToAdd),\n            ...current.substring(add[0].length + 1).split('\\n'),\n            ...lines.slice(lineNumberToAdd)\n          ]\n\n          return newLines.join('\\n')\n        } else if (same) {\n          return accumulator\n        } else {\n          return current\n        }\n      } else {\n        return accumulator\n      }\n    }, '')\n}\n\nexport default patcher\n","import React, { Component } from 'react'\nimport classNames from 'classnames'\nimport { isNil } from 'lodash'\nimport range from 'lodash/range'\nimport every from 'lodash/every'\nimport { connect } from 'react-redux'\nimport patcher from '../utils/patcher.js'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\nimport actions from '../actions/actions.js'\nimport lessons from '../utils/lessons.json'\nimport Map from './Map.js'\n\nconst areRequirementsMet = ({ requirements, props }) =>\n  every(requirements, (value, key) => props[key] === value)\n\nconst mapStateToProps = ({ screen, tutorial, game }) => ({\n  screen,\n  tutorial,\n  game\n})\n\nconst mapDispatchToProps = dispatch => ({\n  setCodeTab: tab => dispatch(actions.setCodeTab(tab)),\n  newGame: () => dispatch(actions.newGame()),\n  updateMap: newMap => dispatch(actions.updateMap(newMap)),\n  setScreen: screen => dispatch(actions.setScreen(screen)),\n  closeTutorial: () => dispatch(actions.closeTutorial()),\n  updateGame: ({ tab, content }) =>\n    dispatch(actions.updateGame({ tab, content })),\n  updateSprite: ({ sprite, index }) =>\n    dispatch(\n      actions.updateSprite({\n        sprite,\n        index\n      })\n    ),\n  setTutorialSlide: ({ lessonIndex, slideIndex }) =>\n    dispatch(\n      actions.setTutorialSlide({\n        lessonIndex,\n        slideIndex\n      })\n    )\n})\n\nclass Tutorial extends Component {\n  constructor(props) {\n    super(props)\n    this.handleClose = this.handleClose.bind(this)\n    this.handlePrevious = this.handlePrevious.bind(this)\n    this.handleNextSlide = this.handleNextSlide.bind(this)\n    this.handleNextLesson = this.handleNextLesson.bind(this)\n    this.handleSlide = this.handleSlide.bind(this)\n    this.fireActions = this.fireActions.bind(this)\n    this.buttonsElement = null\n    this.setButtonsRef = e => {\n      this.buttonsElement = e\n    }\n  }\n\n  fireActions({ lessonIndex, slideIndex }) {\n    const {\n      setScreen,\n      updateGame,\n      updateSprite,\n      updateMap,\n      screen,\n      setCodeTab\n    } = this.props\n\n    const lesson = lessons[lessonIndex]\n    const { slides } = lesson\n    const slide = slides[slideIndex]\n    const { screen: slideScreen, game, sprites, map: slideMap } = slide\n\n    if (!isNil(game)) {\n      const patchedGame = patcher({ slides, index: slideIndex })\n      // If we're not on CODE, set the game with no prefix.\n      if (screen !== screenTypes.CODE) {\n        updateGame({ tab: 0, content: patchedGame })\n      } else {\n        // If we are on CODE, use prefix.\n        updateGame({ tab: 0, content: `SCRIPT-8 LESSON${patchedGame}` })\n      }\n    }\n\n    // If there are sprites, set them.\n    if (sprites) {\n      // console.log(sprites)\n      sprites.forEach(({ array, index }) =>\n        updateSprite({ sprite: array, index })\n      )\n    }\n\n    if (slideMap) {\n      let newMap = Map.createBlankMap()\n      slideMap.forEach(d => {\n        const [row, col, value] = d.split('-')\n        newMap[+row][+col] = value ? +value : null\n      })\n      updateMap(newMap)\n    }\n\n    // Set the screen, if we have one.\n    if (slideScreen) {\n      setScreen(slideScreen)\n      // If the slide screen is CODE, go to the first tab.\n      if (slideScreen === screenTypes.CODE) {\n        setCodeTab(0)\n      }\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { tutorial, screen } = this.props\n    const { lessonIndex, slideIndex } = tutorial\n    const { slides } = lessons[lessonIndex]\n    const slide = slides[slideIndex]\n    const { requirements } = slide\n\n    // Check if we're on a slide with requirements,\n    // and if those requirements were not previously met,\n    // but they are now. And if so, advance.\n    if (requirements) {\n      if (!areRequirementsMet({ requirements, props: prevProps })) {\n        if (areRequirementsMet({ requirements, props: this.props })) {\n          this.handleNextSlide()\n        }\n      }\n    }\n\n    if (screen === screenTypes.RUN) {\n      this.buttonsElement.scrollIntoView()\n    }\n  }\n\n  handleClose() {\n    this.props.closeTutorial()\n  }\n\n  handleSlide({ lessonIndex, slideIndex }) {\n    this.props.setTutorialSlide({ lessonIndex, slideIndex })\n    this.fireActions({ lessonIndex, slideIndex })\n  }\n\n  handleNextLesson() {\n    const { lessonIndex } = this.props.tutorial\n    this.handleSlide({ lessonIndex: lessonIndex + 1, slideIndex: 0 })\n  }\n\n  handleNextSlide() {\n    const { lessonIndex, slideIndex } = this.props.tutorial\n    const { newGameOnNext } = lessons[lessonIndex].slides[slideIndex]\n    if (newGameOnNext) {\n      this.props.newGame(this.props.screen)\n    }\n    this.handleSlide({ lessonIndex, slideIndex: slideIndex + 1 })\n  }\n\n  handlePrevious() {\n    const { lessonIndex, slideIndex } = this.props.tutorial\n    this.handleSlide({ lessonIndex, slideIndex: slideIndex - 1 })\n  }\n\n  render() {\n    const { tutorial, screen, tutorialRef } = this.props\n    const { lessonIndex, slideIndex } = tutorial\n    const { title, slides } = lessons[lessonIndex]\n    const slide = slides[slideIndex]\n    const { requirements } = slide\n    const close = (\n      <button className=\"button\" onClick={this.handleClose}>\n        close\n      </button>\n    )\n\n    const enableNextSlide = requirements\n      ? areRequirementsMet({ requirements, props: this.props })\n      : true\n\n    const nextSlide =\n      slideIndex < slides.length - 1 ? (\n        <button\n          className=\"button\"\n          disabled={!enableNextSlide}\n          onClick={this.handleNextSlide}\n        >\n          next\n        </button>\n      ) : null\n\n    const nextLesson =\n      slideIndex === slides.length - 1 && lessonIndex < lessons.length - 1 ? (\n        <button className=\"button\" onClick={this.handleNextLesson}>\n          next lesson\n        </button>\n      ) : null\n\n    const previous =\n      slideIndex > 0 ? (\n        <button className=\"button\" onClick={this.handlePrevious}>\n          previous\n        </button>\n      ) : null\n\n    const buttons = (\n      <div className=\"buttons\" ref={this.setButtonsRef}>\n        {previous}\n        {nextLesson}\n        {nextSlide}\n        {close}\n      </div>\n    )\n\n    const description =\n      slideIndex === 0 ? (\n        lessonIndex === 0 ? (\n          <p>{title}</p>\n        ) : (\n          <p>\n            Lesson {lessonIndex}: {title}\n          </p>\n        )\n      ) : null\n\n    const progress = range(slides.length)\n      .map(i => (i === slideIndex ? '|' : '.'))\n      .join('')\n\n    return (\n      <div\n        className={classNames('Tutorial', {\n          'in-run': screen === screenTypes.RUN\n        })}\n        ref={tutorialRef}\n      >\n        {description}\n        {slide.text.map((p, i) => (\n          <p\n            key={i}\n            className={classNames({\n              code: p.startsWith('XX')\n            })}\n            dangerouslySetInnerHTML={{ __html: p.replace(/^XX/, '') }}\n          />\n        ))}\n        <div className=\"bottom-bar\">\n          {buttons}\n          <p>{progress}</p>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Tutorial)\n","import React from 'react'\n\nconst Run = () => <div className='Run' />\n\nexport default Run\n","import prettier from 'prettier/standalone'\nimport prettierParser from 'prettier/parser-babylon'\n\nconst commands = {\n  tab: cm => {\n    const spaces = Array(cm.getOption('indentUnit') + 1).join(' ')\n    cm.replaceSelection(spaces)\n  },\n  comment: cm => {\n    cm.toggleComment()\n  },\n  format: (cm, setContents) => {\n    const oldCode = cm.getValue()\n    const index = cm.indexFromPos(cm.getCursor())\n\n    const prettierOpts = cursorOffset => ({\n      parser: 'babel',\n      plugins: {\n        babel: prettierParser\n      },\n      cursorOffset,\n      semi: false,\n      singleQuote: true\n    })\n\n    const { formatted, cursorOffset } = prettier.formatWithCursor(\n      oldCode,\n      prettierOpts(index)\n    )\n\n    setContents(formatted)\n\n    const newCursor = cm.posFromIndex(cursorOffset)\n    cm.setCursor(newCursor)\n  }\n}\n\nexport default commands\n","// actions.updateContent is used in three places:\n// - in CodeEditor, on code mirror change\n// - in Tutorial, if slide has game,\n//    if we're not on code, updateContent is called as is\n//    if we are on code, updateContent is called with the prefix\n\nimport React, { Component } from 'react'\nimport { isNil } from 'lodash'\nimport get from 'lodash/get'\nimport includes from 'lodash/includes'\nimport setupLinter from '../utils/setupLinter.js'\nimport commands from '../utils/commands.js'\nimport blankTemplate from '../iframe/src/blankTemplate.js'\nimport { getActive } from '../reducers/game.js'\nimport lessons from '../utils/lessons.json'\n\nconst { platform } = window.navigator\n\nclass CodeEditor extends Component {\n  constructor(props) {\n    super(props)\n\n    this.mark = null\n    this.setContents = this.setContents.bind(this)\n    this.handleSlider = this.handleSlider.bind(this)\n    this.activateSlider = this.activateSlider.bind(this)\n    this.hideSlider = this.hideSlider.bind(this)\n    this.highlightText = this.highlightText.bind(this)\n  }\n\n  componentDidMount() {\n    setupLinter()\n    const activeGame = getActive(this.props.game)\n    this.codeMirror = window.CodeMirror(this._editor, {\n      value: activeGame.text || '',\n      mode: 'javascript',\n      theme: 'nyx8',\n      lint: true,\n      lineNumbers: true,\n      tabSize: 2,\n      cursorBlinkRate: 0,\n      scrollbarStyle: null,\n      extraKeys: {\n        Tab: commands.tab,\n        'Cmd-/': commands.comment,\n        'Ctrl-/': commands.comment,\n        'Alt-F': cm => commands.format(cm, this.setContents),\n        Esc: 'clearSearch'\n      }\n    })\n\n    const docHistory = get(this.props.docHistories, `[${activeGame.key}]`, null)\n\n    if (docHistory) {\n      this.codeMirror.getDoc().setHistory(docHistory)\n    } else {\n      this.codeMirror.getDoc().clearHistory()\n    }\n\n    this.codeMirror.on('change', cm => {\n      const content = cm.getValue()\n      document.querySelector('#highlighter-box').classList.add('hide')\n      this.props.updateContent(content)\n    })\n\n    this.codeMirror.on('keydown', (cm, e) => {\n      if (includes(platform, 'Mac')) {\n        if (e.key === 'Meta') {\n          this.activateSlider()\n        }\n      } else {\n        if (e.key === 'Shift') {\n          this.activateSlider()\n        }\n      }\n    })\n\n    // Add this eventlistener to window.\n    window.addEventListener('keyup', this.hideSlider)\n\n    // If found, restore scroll data.\n    const { scrollData } = activeGame\n    if (scrollData) {\n      this.codeMirror.scrollTo(scrollData.left || 0, scrollData.top || 0)\n      this.codeMirror.setCursor(scrollData.cursorPosition)\n    }\n\n    // Give editor focus.\n    this.codeMirror.focus()\n  }\n\n  hideSlider() {\n    this.mark && this.mark.clear()\n    this._slider.classList.add('hide')\n  }\n\n  highlightText(range) {\n    const lines = range.split('-').map(d => +d)\n    const firstLine = lines[0]\n    const lastLine = lines[lines.length - 1]\n    const cmLines = lines.map(d => this.codeMirror.getLine(d))\n\n    const whiteSpaces = cmLines[0].search(/\\S/)\n\n    // Calculate the width.\n    const width =\n      (Math.max(...cmLines.map(d => d.length)) - whiteSpaces + 1) *\n      this.codeMirror.defaultCharWidth()\n\n    // Calculate the height.\n    const height =\n      this.codeMirror.defaultTextHeight() * (1 + lastLine - firstLine)\n\n    document.querySelector('#highlighter-box').classList.remove('hide')\n    this.codeMirror.addWidget(\n      { line: firstLine, ch: whiteSpaces },\n      document.querySelector('#highlighter-box'),\n      false\n    )\n\n    this._highlighterBox.style.width = `${width + 8}px`\n    this._highlighterBox.style.height = `${height + 6}px`\n\n    this.codeMirror.scrollIntoView({ line: lastLine, ch: 0 }, 40)\n  }\n\n  activateSlider() {\n    // If the cursor is on a number,\n    // reset and show the slider.\n\n    // Get cursor.\n    const cursor = this.codeMirror.getCursor()\n\n    // Get token for this position.\n    const token = this.codeMirror.getTokenAt({\n      ...cursor,\n      ch: cursor.ch + 1\n    })\n\n    // If it's a number,\n    if (token && token.type === 'number') {\n      // clear out the previous mark,\n      this.mark && this.mark.clear()\n\n      // and mark this token.\n      this.mark = this.codeMirror.markText(\n        {\n          line: cursor.line,\n          ch: token.start\n        },\n        {\n          line: cursor.line,\n          ch: token.end\n        },\n        {\n          className: 'slider-token'\n        }\n      )\n\n      // get the token's middle point coords.\n      const middleCoords = this.codeMirror.charCoords({\n        line: cursor.line,\n        ch: token.start\n      })\n\n      // Get the wrapper rect.\n      const wrapperRect = this._wrapper.getBoundingClientRect()\n\n      // Save token.\n      const value = token.string\n\n      const valueNumber = +value\n\n      if (valueNumber >= -127 && valueNumber <= 127) {\n        this._slider.min = -127\n        this._slider.max = 127\n        this._slider.value = valueNumber\n      } else {\n        this._slider.min = -valueNumber * 2\n        this._slider.max = valueNumber * 2\n        this._slider.value = valueNumber\n      }\n\n      // Position slider centered above token.\n      this._slider.style.left = `${middleCoords.left -\n        wrapperRect.left +\n        (value.length * this.codeMirror.defaultCharWidth()) / 2}px`\n      this._slider.style.top = `${middleCoords.top -\n        wrapperRect.top -\n        this.codeMirror.defaultTextHeight()}px`\n\n      // Show slider.\n      this._slider.classList.remove('hide')\n    }\n  }\n\n  handleSlider(e) {\n    // Get mark positions.\n    const { from, to } = this.mark.find()\n\n    // Calculate new token.\n    const newToken = e.target.value.toString()\n\n    // Change token content.\n    this.codeMirror.replaceRange(newToken, from, to)\n\n    // Re-select token.\n    this.mark = this.codeMirror.markText(\n      from,\n      {\n        ...from,\n        ch: from.ch + newToken.length\n      },\n      {\n        className: 'slider-token'\n      }\n    )\n  }\n\n  setContents(value) {\n    this.codeMirror.setValue(value)\n    this.codeMirror.refresh()\n  }\n\n  componentWillReceiveProps(nextProps) {\n    // If the incoming game is the empty game code,\n    if (nextProps.game[0].text === 'SCRIPT-8 NEW') {\n      // set CodeMirror's value to the blank template,\n      this.setContents(blankTemplate)\n      // and clear the doc history.\n      this.codeMirror.getDoc().clearHistory()\n    } else if (\n      // If the incoming game is a lesson,\n      nextProps.game[0].text.startsWith('SCRIPT-8 LESSON')\n    ) {\n      // set the lesson,\n      this.setContents(nextProps.game[0].text.replace('SCRIPT-8 LESSON', ''))\n\n      // and highlight lines if required.\n      const { tutorial } = nextProps\n      if (tutorial) {\n        const lesson = lessons[tutorial.lessonIndex]\n        const { slides } = lesson\n        const slide = slides[tutorial.slideIndex]\n        if (slide && slide.linesToHighlight) {\n          this._highlighterBox.classList.remove('hide')\n          this.highlightText(slide.linesToHighlight)\n        }\n      }\n    } else if (\n      // If the incoming tab is different than this one,\n      // we are about to switch tabs.\n      getActive(this.props.game).key !== getActive(nextProps.game).key\n    ) {\n      // Save current doc's history.\n      this.props.updateHistory({\n        index: getActive(this.props.game).key,\n        history: this.codeMirror.getDoc().getHistory()\n      })\n\n      // Save current scrollData.\n      const oldScrollInfo = this.codeMirror.getScrollInfo()\n      const oldCursorPosition = this.codeMirror.getCursor()\n      this.props.setScrollData({\n        scrollData: {\n          top: oldScrollInfo.top,\n          left: oldScrollInfo.left,\n          cursorPosition: oldCursorPosition\n        },\n        tab: getActive(this.props.game).key\n      })\n\n      // Set codemirror contents to new tab.\n      this.setContents(getActive(nextProps.game).text || '')\n\n      // Try getting new tab's history.\n      const docHistory = get(\n        this.props.docHistories,\n        `[${getActive(nextProps.game).key}]`,\n        null\n      )\n\n      // Try setting new tab's history.\n      if (docHistory) {\n        this.codeMirror.getDoc().setHistory(docHistory)\n      } else {\n        this.codeMirror.getDoc().clearHistory()\n      }\n\n      // Try setting new tab's scrollData.\n      const { scrollData } = getActive(nextProps.game)\n      if (scrollData) {\n        this.codeMirror.scrollTo(scrollData.left || 0, scrollData.top || 0)\n        this.codeMirror.setCursor(scrollData.cursorPosition)\n      }\n\n      // Give editor focus.\n      this.codeMirror.focus()\n    }\n\n    if (\n      JSON.stringify(nextProps.errorLine) !==\n      JSON.stringify(this.props.errorLine)\n    ) {\n      if (!isNil(nextProps.errorLine)) {\n        // We'll use this to store the setTimeout id.\n        let id\n\n        // This counter will prevent the setTimeout running indefinitely.\n        let counter\n\n        // Function to check if codemirror has active game loaded.\n        const isReady = () =>\n          this.codeMirror.getValue() === getActive(this.props.game).text\n\n        // Function to highlight the line.\n        const highlight = () => {\n          this.highlightText(nextProps.errorLine.line.toString())\n        }\n\n        // Function that checks if we're ready, and if so, stops the interval,\n        // and highlights the text.\n        const checkFunction = () => {\n          if (isReady()) {\n            clearInterval(id)\n            highlight()\n          } else if (counter >= 7) {\n            clearInterval(id)\n          }\n          counter++\n        }\n\n        // Now we can begin.\n        // If we're already ready,\n        if (isReady()) {\n          // just highlight.\n          highlight()\n        } else {\n          // Otherwise,\n          // reset the counter variable,\n          counter = 0\n          // and start checking.\n          id = setInterval(checkFunction, 250)\n        }\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keyup', this.hideSlider)\n    const activeGame = getActive(this.props.game)\n    const scrollInfo = this.codeMirror.getScrollInfo()\n    const cursorPosition = this.codeMirror.getCursor()\n    const scrollData = {\n      top: scrollInfo.top,\n      left: scrollInfo.left,\n      cursorPosition\n    }\n    this.props.setScrollData({ scrollData, tab: activeGame.key })\n    this.props.updateHistory({\n      index: activeGame.key,\n      history: this.codeMirror.getDoc().getHistory()\n    })\n  }\n\n  shouldComponentUpdate() {\n    return false\n  }\n\n  render() {\n    return (\n      <div className=\"CodeEditor\">\n        <div\n          className=\"wrapper\"\n          ref={_wrapper => {\n            this._wrapper = _wrapper\n          }}\n        >\n          <div\n            className=\"_editor\"\n            ref={_editor => {\n              this._editor = _editor\n            }}\n          />\n          <input\n            type=\"range\"\n            className=\"slider hide\"\n            step={1}\n            ref={_slider => {\n              this._slider = _slider\n            }}\n            onInput={this.handleSlider}\n          />\n          <div\n            id=\"highlighter-box\"\n            ref={_highlighterBox => {\n              this._highlighterBox = _highlighterBox\n            }}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default CodeEditor\n","import React, { Component } from 'react'\nimport classNames from 'classnames'\nimport { connect } from 'react-redux'\nimport CodeEditor from '../components/CodeEditor.js'\nimport actions from '../actions/actions.js'\nimport { getActive } from '../reducers/game.js'\n\nconst mapStateToProps = ({ game, tutorial, docHistories, errorLine }) => ({\n  game,\n  tutorial,\n  docHistories,\n  errorLine\n})\n\nconst mapDispatchToProps = dispatch => ({\n  updateGame: ({ tab, content }) =>\n    dispatch(actions.updateGame({ tab, content })),\n  setScrollData: ({ tab, scrollData }) =>\n    dispatch(actions.setScrollData({ tab, scrollData })),\n  updateHistory: ({ index, history }) =>\n    dispatch(actions.updateHistory({ index, history }))\n})\n\nclass Code extends Component {\n  constructor(props) {\n    super(props)\n    this.handleTabUpdates = this.handleTabUpdates.bind(this)\n  }\n\n  handleTabUpdates(content) {\n    const tab = getActive(this.props.game).key\n    this.props.updateGame({ tab, content })\n  }\n\n  render() {\n    const {\n      game,\n      tutorial,\n      setScrollData,\n      docHistories,\n      updateHistory,\n      errorLine\n    } = this.props\n\n    return (\n      <div\n        className={classNames('Code two-rows-and-grid', {\n          tutorial: tutorial !== false\n        })}\n      >\n        <div className=\"main\">\n          <CodeEditor\n            errorLine={errorLine}\n            game={game}\n            updateContent={this.handleTabUpdates}\n            setScrollData={setScrollData}\n            docHistories={docHistories}\n            updateHistory={updateHistory}\n            tutorial={tutorial}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Code)\n","import React, { Component, Fragment } from 'react'\nimport { connect } from 'react-redux'\nimport actions from '../actions/actions.js'\nimport lessons from '../utils/lessons.json'\nimport apiDocs from '../utils/apiDocs.json'\nimport howTo from '../utils/howTo.json'\nimport shortcuts from '../utils/shortcuts.json'\n\nconst mapStateToProps = () => ({})\n\nconst mapDispatchToProps = dispatch => ({\n  setLessonIndex: lessonIndex =>\n    dispatch(\n      actions.setTutorialSlide({\n        lessonIndex,\n        slideIndex: 0\n      })\n    )\n})\n\nclass Help extends Component {\n  constructor(props) {\n    super(props)\n    this.handleLesson = this.handleLesson.bind(this)\n  }\n\n  handleLesson(lessonIndex) {\n    this.props.setLessonIndex(lessonIndex)\n  }\n\n  render() {\n    return (\n      <div className=\"Help\">\n        <div className=\"main\">\n          <ul className=\"top-list\">\n            <li>\n              SCRIPT-8 is written by Gabriel Florit (that's me!) and{' '}\n              <a\n                className=\"text\"\n                href=\"https://github.com/script-8/script-8.github.io/graphs/contributors\"\n              >\n                dedicated contributors\n              </a>\n              . Do you have a question? Or perhaps you found a bug? Tweet me at{' '}\n              <a className=\"text\" href=\"https://twitter.com/gabrielflorit\">\n                @gabrielflorit\n              </a>{' '}\n              and I'll be glad to help out. And visit the Github repository{' '}\n              <a\n                className=\"text\"\n                href=\"https://github.com/script-8/script-8.github.io\"\n              >\n                here\n              </a>\n              , where you can keep up with new features and the occasional bug\n              fix.\n            </li>\n\n            <li>\n              If you have any further questions, come join us on the{' '}\n              <a className=\"text\" href=\"https://discord.gg/HA68FNX\">\n                Fantasy Consoles Discord server\n              </a>\n              , a friendly place to chat about these sophisticated, cutting-edge\n              computers. The server has a dedicated SCRIPT-8 room.\n            </li>\n\n            <li>\n              Lessons\n              <ul className=\"lessons\">\n                {lessons.map((lesson, i) => (\n                  <li key={i}>\n                    <button\n                      className=\"button\"\n                      onClick={() => {\n                        this.handleLesson(i)\n                      }}\n                    >\n                      {i} - {lesson.shortTitle || lesson.title}\n                    </button>\n                  </li>\n                ))}\n              </ul>\n            </li>\n          </ul>\n\n          <ul className=\"top-list how\">\n            <li>\n              FAQ\n              <dl>\n                {howTo.map(([dt, dd], i) => (\n                  <Fragment key={i}>\n                    <dt>{dt}</dt>\n                    <dd dangerouslySetInnerHTML={{ __html: dd }} />\n                  </Fragment>\n                ))}\n              </dl>\n            </li>\n          </ul>\n\n          <ul className=\"top-list\">\n            <li>\n              Keyboard shortcuts\n              <dl>\n                {shortcuts.map(([dt, dd], i) => (\n                  <Fragment key={i}>\n                    <dt>{dt}</dt>\n                    <dd dangerouslySetInnerHTML={{ __html: dd }} />\n                  </Fragment>\n                ))}\n              </dl>\n            </li>\n          </ul>\n\n          <ul className=\"top-list\">\n            <li>\n              API documentation\n              <ul className=\"second-list\">\n                {apiDocs.map((section, i) => (\n                  <li key={i}>\n                    {section.title}\n                    {section.note ? <span> ({section.note})</span> : null}\n                    <dl>\n                      {section.dl.map(([dt, dd], j) => (\n                        <Fragment key={j}>\n                          <dt>{dt}</dt>\n                          <dd dangerouslySetInnerHTML={{ __html: dd }} />\n                        </Fragment>\n                      ))}\n                    </dl>\n                  </li>\n                ))}\n              </ul>\n            </li>\n          </ul>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Help)\n","import _ from 'lodash'\n\nconst getScore = daysAgo => {\n  if (daysAgo <= 4) {\n    return 100\n  } else if (daysAgo <= 14) {\n    return 70\n  } else if (daysAgo <= 31) {\n    return 50\n  } else if (daysAgo <= 90) {\n    return 30\n  } else {\n    return 10\n  }\n}\n\nconst parseDate = str => {\n  const mdy = str.split('-')\n  return new Date(mdy[0], mdy[1] - 1, mdy[2])\n}\n\nconst datediff = (first, second) =>\n  Math.round((second - first) / (1000 * 60 * 60 * 24))\n\nconst frecency = (visits, date) => {\n  const now = new Date()\n\n  return _(visits)\n    .map((value, key) => {\n      const daysAgo = datediff(parseDate(key), date ? parseDate(date) : now)\n      const score = getScore(daysAgo)\n      return value * score\n    })\n    .sum()\n}\n\nexport default frecency\n","const times = [\n  ['second', 1],\n  ['minute', 60],\n  ['hour', 3600],\n  ['day', 86400],\n  ['week', 604800],\n  ['month', 2592000],\n  ['year', 31536000]\n]\n\nconst timeAgo = ({ now, before }) => {\n  let diff = Math.round((now - before) / 1000)\n  for (let t = 0; t < times.length; t++) {\n    if (diff < times[t][1]) {\n      if (t === 0) {\n        return 'Just now'\n      } else {\n        diff = Math.round(diff / times[t - 1][1])\n        return diff + ' ' + times[t - 1][0] + (diff === 1 ? ' ago' : 's ago')\n      }\n    }\n  }\n}\n\nexport default timeAgo\n","import React, { Component } from 'react'\nimport _ from 'lodash'\nimport timeAgo from '../utils/timeAgo.js'\n\nclass ShelfCassettes extends Component {\n  constructor(props) {\n    super(props)\n    this.renderCassette = this.renderCassette.bind(this)\n    this.handleNext = this.handleNext.bind(this)\n    this.handlePrevious = this.handlePrevious.bind(this)\n    this.state = {\n      index: 0\n    }\n  }\n\n  handleNext() {\n    this.setState({\n      index: this.state.index + this.props.step\n    })\n  }\n\n  handlePrevious() {\n    this.setState({\n      index: Math.max(this.state.index - this.props.step, 0)\n    })\n  }\n\n  renderCassette({ cassette, i, now }) {\n    const {\n      handleOnClick,\n      tokenLogin,\n      handleSetVisibility,\n      handleRemove\n    } = this.props\n    const { isPrivate, gist, visits } = cassette\n    const visitsCount = visits ? _.sum(Object.values(visits)) : 0\n    const counter = visitsCount + cassette.counter\n    const title = cassette.title || ''\n    const maxLength = 16\n    const tooLong = title.length > maxLength\n    const finalTitle = [\n      title.substring(0, maxLength).trim(),\n      tooLong ? '' : ''\n    ].join('')\n\n    const date = new Date(cassette.updated)\n\n    return (\n      <li key={i} className=\"cassette\">\n        <div className=\"img\">\n          <span className=\"title\">{finalTitle || ''}</span>\n          <a\n            href={`/?id=${gist}`}\n            onClick={e => {\n              handleOnClick({ e, id: gist })\n            }}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            <img className=\"background\" alt=\"\" src=\"./cassette-bg.png\" />\n            <span className=\"load\">load cassette</span>\n            {cassette.cover ? (\n              <img className=\"cover\" src={cassette.cover} alt=\"\" />\n            ) : null}\n          </a>\n          <span className=\"author\">\n            by <a href={`/?shelf=${cassette.user}`}>{cassette.user}</a>\n          </span>\n          <div className=\"date-info\">\n            <span className=\"date\">{timeAgo({ now, before: date })}</span>\n            <span className=\"booted\">\n              {counter || 0} play{counter === 1 ? '' : 's'}\n            </span>\n          </div>{' '}\n        </div>\n        {tokenLogin === cassette.user ? (\n          <div className=\"buttons\">\n            <button\n              className=\"button\"\n              onClick={() => {\n                handleSetVisibility({ gistId: gist, isPrivate: !isPrivate })\n              }}\n            >\n              make {isPrivate ? 'public' : 'private'}\n            </button>\n            <button\n              className=\"button\"\n              onClick={() => {\n                handleRemove({ gistId: gist })\n              }}\n            >\n              remove\n            </button>\n          </div>\n        ) : null}\n      </li>\n    )\n  }\n\n  render() {\n    const {\n      cassettes,\n      title,\n      step,\n      showAllButton,\n      handleOnShowAllClick\n    } = this.props\n    const { index } = this.state\n    const now = new Date()\n\n    return (\n      <div className=\"ShelfCassettes\">\n        <div className=\"title-nav-and-show-all\">\n          <div className=\"title-nav\">\n            <span className=\"title\">{title}</span>\n            <button\n              disabled={index <= 0}\n              className=\"button\"\n              onClick={this.handlePrevious}\n            >\n              &lt;\n            </button>\n            <button\n              disabled={index >= cassettes.length - step}\n              className=\"button\"\n              onClick={this.handleNext}\n            >\n              &gt;\n            </button>\n            <span className=\"count\">\n              {index + 1} - {Math.min(index + step, cassettes.length)} (\n              {cassettes.length} total)\n            </span>\n          </div>\n          {showAllButton ? (\n            <div className=\"show-all\">\n              <button className=\"button\" onClick={handleOnShowAllClick}>\n                show all cassettes\n              </button>\n            </div>\n          ) : null}\n        </div>\n        <ul className=\"cassettes\">\n          {_(cassettes)\n            .slice(index, index + step)\n            .map((d, i) => this.renderCassette({ cassette: d, i, now }))\n            .value()}\n        </ul>\n      </div>\n    )\n  }\n}\n\nShelfCassettes.defaultProps = {\n  step: 5,\n  showAllButton: false\n}\n\nexport default ShelfCassettes\n","import React, { Component, Fragment } from 'react'\nimport { connect } from 'react-redux'\nimport _ from 'lodash'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\nimport throwError from '../utils/throwError.js'\nimport frecency from '../utils/frecency.js'\nimport actions, { setVisibility, unshelveCassette } from '../actions/actions.js'\nimport ShelfCassettes from '../components/ShelfCassettes.js'\n\nconst mapStateToProps = ({ gist, token, shelving }) => ({\n  gist,\n  token,\n  shelving\n})\n\nconst mapDispatchToProps = dispatch => ({\n  unshelveCassette: ({ token, gistId }) =>\n    dispatch(unshelveCassette({ token, gistId })),\n  setScreen: screen => dispatch(actions.setScreen(screen)),\n  setVisibility: ({ token, gistId, isPrivate }) =>\n    dispatch(setVisibility({ token, gistId, isPrivate }))\n})\n\nclass Shelf extends Component {\n  constructor(props) {\n    super(props)\n    this.fetchCassettes = this.fetchCassettes.bind(this)\n    this.makeShelfCassettes = this.makeShelfCassettes.bind(this)\n    this.handleOnClick = this.handleOnClick.bind(this)\n    this.handleOnShowAllClick = this.handleOnShowAllClick.bind(this)\n    this.handleSetVisibility = this.handleSetVisibility.bind(this)\n    this.handleRemove = this.handleRemove.bind(this)\n    this.state = {\n      fetching: true,\n      popularCassettes: [],\n      recentCassettes: []\n    }\n  }\n\n  componentDidMount() {\n    this._isMounted = true\n    this.fetchCassettes()\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false\n  }\n\n  fetchCassettes() {\n    const { token } = this.props\n    const currentLogin = _.get(token, 'user.login', null)\n\n    const { search } = window.location\n    const params = new window.URLSearchParams(search)\n    const shelfUser = params.get('shelf')\n\n    // If querystring doesn't have `shelf` and we are logged in,\n    // load our cassettes.\n\n    if (token.value && !shelfUser) {\n      window\n        .fetch(`${process.env.REACT_APP_NOW}/private-cassettes`, {\n          method: 'POST',\n          body: JSON.stringify({\n            token: token.value\n          })\n        })\n        .then(\n          response => response.json(),\n          error =>\n            throwError({\n              error,\n              message: `Could not request cassettes.`\n            })\n        )\n        .then(value => {\n          const yourPrivateCassettes = _(value)\n            .sortBy(cassette => +cassette.updated)\n            .reverse()\n            .value()\n\n          if (this._isMounted) {\n            this.setState({\n              yourPrivateCassettes,\n              fetching: false\n            })\n          }\n        })\n    } else {\n      if (this._isMounted) {\n        this.setState({\n          yourPrivateCassettes: []\n        })\n      }\n    }\n\n    window\n      .fetch(`${process.env.REACT_APP_NOW}/cassettes`)\n      .then(\n        response => response.json(),\n        error =>\n          throwError({\n            error,\n            message: `Could not request cassettes.`\n          })\n      )\n      .then(value => {\n        const cassettes = value.map(cassette => ({\n          ...cassette,\n          counter: +cassette.counter || 0\n        }))\n\n        const popularCassettes = _(cassettes)\n          .map(cassette => ({\n            ...cassette,\n            score: frecency(cassette.visits)\n          }))\n          .sortBy(cassette => cassette.score)\n          .reverse()\n          .value()\n\n        const recentCassettes = _(cassettes)\n          .sortBy(cassette => +cassette.updated)\n          .reverse()\n          .value()\n\n        const yourPublicCassettes = currentLogin\n          ? recentCassettes.filter(cassette => cassette.user === currentLogin)\n          : []\n\n        if (this._isMounted) {\n          this.setState({\n            popularCassettes: popularCassettes.filter(d => !d.isFork),\n            recentCassettes: recentCassettes.filter(d => !d.isFork),\n            yourPublicCassettes,\n            fetching: false\n          })\n        }\n      })\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      (prevProps.shelving && !this.props.shelving) ||\n      prevProps.token !== this.props.token\n    ) {\n      this.setState({\n        fetching: true\n      })\n      this.fetchCassettes()\n    }\n  }\n\n  handleOnShowAllClick() {\n    window.history.pushState(null, null, '/')\n    this.setState({\n      fetching: true\n    })\n    this.fetchCassettes()\n  }\n\n  handleOnClick({ e, id }) {\n    const { gist, setScreen } = this.props\n    if (id === _.get(gist, 'data.id')) {\n      e.preventDefault()\n      setScreen(screenTypes.RUN)\n    }\n  }\n\n  handleSetVisibility({ gistId, isPrivate }) {\n    const { token, setVisibility } = this.props\n    setVisibility({ token, gistId, isPrivate })\n  }\n\n  handleRemove({ gistId }) {\n    const { token, unshelveCassette } = this.props\n    if (\n      window.confirm(\n        'Do you really want to remove this cassette from the shelf?'\n      )\n    ) {\n      unshelveCassette({ gistId, token })\n    }\n  }\n\n  // NOTE: this is currently not in use\n  makeShelfCassettes({ cassettes, title, tokenLogin }) {\n    return (\n      <ShelfCassettes\n        handleSetVisibility={this.handleSetVisibility}\n        handleRemove={this.handleRemove}\n        tokenLogin={tokenLogin}\n        handleOnClick={this.handleOnClick}\n        cassettes={cassettes}\n        title={title}\n      />\n    )\n  }\n\n  render() {\n    const {\n      popularCassettes,\n      recentCassettes,\n      yourPublicCassettes,\n      yourPrivateCassettes,\n      fetching\n    } = this.state\n\n    const tokenLogin = _.get(this.props, 'token.user.login', null)\n\n    const { search } = window.location\n    const params = new window.URLSearchParams(search)\n    const shelfUser = params.get('shelf')\n\n    const userPublicCassettes = recentCassettes.filter(\n      d => d.user === shelfUser\n    )\n\n    // TODO: consolidate duplication below.\n\n    return (\n      <div className=\"Shelf\">\n        <div className=\"main\">\n          {fetching ? (\n            <p className=\"loading\">loading cassettes...</p>\n          ) : shelfUser ? (\n            userPublicCassettes.length ? (\n              <ShelfCassettes\n                handleSetVisibility={this.handleSetVisibility}\n                handleRemove={this.handleRemove}\n                tokenLogin={tokenLogin}\n                handleOnClick={this.handleOnClick}\n                cassettes={userPublicCassettes}\n                title={`${shelfUser}'s ${\n                  shelfUser === tokenLogin ? 'public' : ''\n                } cassettes`}\n                step={20}\n                showAllButton={true}\n                handleOnShowAllClick={this.handleOnShowAllClick}\n              />\n            ) : null\n          ) : (\n            <Fragment>\n              {yourPrivateCassettes && yourPrivateCassettes.length ? (\n                <ShelfCassettes\n                  handleSetVisibility={this.handleSetVisibility}\n                  handleRemove={this.handleRemove}\n                  tokenLogin={tokenLogin}\n                  handleOnClick={this.handleOnClick}\n                  cassettes={yourPrivateCassettes}\n                  title=\"Your private cassettes\"\n                />\n              ) : null}\n              {yourPublicCassettes && yourPublicCassettes.length ? (\n                <ShelfCassettes\n                  handleSetVisibility={this.handleSetVisibility}\n                  handleRemove={this.handleRemove}\n                  tokenLogin={tokenLogin}\n                  handleOnClick={this.handleOnClick}\n                  cassettes={yourPublicCassettes}\n                  title=\"Your public cassettes\"\n                />\n              ) : null}\n              <ShelfCassettes\n                handleSetVisibility={this.handleSetVisibility}\n                handleRemove={this.handleRemove}\n                tokenLogin={tokenLogin}\n                handleOnClick={this.handleOnClick}\n                cassettes={popularCassettes}\n                title=\"Popular cassettes\"\n              />\n              <ShelfCassettes\n                handleSetVisibility={this.handleSetVisibility}\n                handleRemove={this.handleRemove}\n                tokenLogin={tokenLogin}\n                handleOnClick={this.handleOnClick}\n                cassettes={recentCassettes}\n                title=\"Recent cassettes\"\n              />\n            </Fragment>\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Shelf)\n","import React, { Component } from 'react'\nimport _ from 'lodash'\nimport { connect } from 'react-redux'\nimport actions from '../actions/actions.js'\nimport notices from '../utils/notices.json'\n\nconst mapStateToProps = ({ dismissedNotices }) => ({ dismissedNotices })\n\nconst mapDispatchToProps = dispatch => ({\n  dismissNotices: id => dispatch(actions.dismissNotices(id))\n})\n\nclass Notice extends Component {\n  constructor(props) {\n    super(props)\n\n    this.handleDismissNotices = this.handleDismissNotices.bind(this)\n  }\n\n  handleDismissNotices() {\n    this.props.dismissNotices(notices.map(d => d.id))\n  }\n\n  render() {\n    const newNoticeIds = _.difference(\n      notices.map(d => d.id),\n      this.props.dismissedNotices\n    )\n\n    return (\n      <div className=\"Notice\">\n        <div className=\"box\">\n          <div className=\"text\">\n            <p className=\"title\">SCRIPT-8 updates</p>\n            {_(newNoticeIds)\n              .map(id => notices.find(d => d.id === id))\n              .sortBy('id')\n              .reverse()\n              .map((notice, i) => (\n                <p key={i}>\n                  <span>{notice.date} - </span>\n                  {notice.text}\n                </p>\n              ))\n              .value()}\n          </div>\n          <button className=\"button\" onClick={this.handleDismissNotices}>\n            > OK\n          </button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Notice)\n","import { Component } from 'react'\nimport _ from 'lodash'\nimport { connect } from 'react-redux'\n\nconst mapStateToProps = ({ gist }) => ({\n  gist\n})\n\nconst mapDispatchToProps = () => ({})\n\nclass Updater extends Component {\n  componentDidMount () {\n    // on component mount,\n    // if we have an id in the gist,\n    // make sure the url reflects this\n    const { gist } = this.props\n    const id = _.get(gist, 'data.id')\n    if (id) {\n      this.updateUrl(id)\n    }\n  }\n\n  componentDidUpdate (prevProps) {\n    // when we get new props,\n    // if the previous gist id is different than this one,\n    // update url!\n    const { gist } = this.props\n    const oldId = _.get(prevProps, 'gist.data.id')\n    const newId = _.get(gist, 'data.id')\n    if (newId !== oldId) {\n      this.updateUrl(newId)\n    }\n  }\n\n  updateUrl (newId) {\n    const { search } = window.location\n    const params = new window.URLSearchParams(search)\n    const urlId = params.get('id')\n    if (urlId !== newId) {\n      window.history.pushState(null, null, newId ? `/?id=${newId}` : '/')\n    }\n  }\n\n  render () {\n    return null\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Updater)\n","import equal from 'deep-equal'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst isBlank = ({ game, sprites, map, phrases, chains, songs }) =>\n  equal(game, initialState.game) &&\n  equal(sprites, initialState.sprites) &&\n  equal(map, initialState.map) &&\n  equal(phrases, initialState.phrases) &&\n  equal(chains, initialState.chains) &&\n  equal(songs, initialState.songs)\n\nexport default isBlank\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport classNames from 'classnames'\nimport _ from 'lodash'\nimport screenTypes, {\n  getPreviousScreen,\n  getNextScreen\n} from '../iframe/src/utils/screenTypes.js'\nimport isDirty from '../utils/isDirty.js'\nimport getGameTitle from '../utils/getGameTitle.js'\nimport canRecord from '../utils/canRecord.js'\nimport isBlank from '../utils/isBlank.js'\nimport actions, {\n  saveGist,\n  fetchToken,\n  putOnShelf\n} from '../actions/actions.js'\nimport { getActive } from '../reducers/game.js'\nimport { assembleOrderedGame } from '../iframe/src/gistParsers/game.js'\nimport { version } from '../iframe/package.json'\n\nconst { platform } = window.navigator\n\nconst downloadHtml = html => {\n  const element = document.createElement('a')\n  element.setAttribute(\n    'href',\n    'data:text/plain;charset=utf-8,' + encodeURIComponent(html)\n  )\n  element.setAttribute('download', 'index.html')\n  element.style.display = 'none'\n  document.body.appendChild(element)\n  element.click()\n  document.body.removeChild(element)\n}\n\nconst mapStateToProps = ({\n  iframeVersion,\n  gist,\n  game,\n  sprites,\n  map,\n  phrases,\n  chains,\n  songs,\n  token,\n  shelving,\n  screen,\n  nextAction,\n  sound\n}) => ({\n  iframeVersion,\n  screen,\n  gist,\n  game,\n  sprites,\n  map,\n  phrases,\n  chains,\n  songs,\n  token,\n  isFetching: gist.isFetching || token.isFetching || shelving,\n  nextAction,\n  sound\n})\n\nconst mapDispatchToProps = dispatch => ({\n  updateIframeVersion: () => dispatch(actions.updateIframeVersion()),\n  clearToken: () => dispatch(actions.clearToken()),\n  setCodeTab: tab => dispatch(actions.setCodeTab(tab)),\n  toggleSound: () => dispatch(actions.toggleSound()),\n  clearNextAction: () => dispatch(actions.clearNextAction()),\n  fetchToken: token => dispatch(fetchToken(token)),\n  newGame: screen => dispatch(actions.newGame(screen)),\n  putOnShelf: ({ user, gist, cover, title, isFork, isPrivate, token }) =>\n    dispatch(\n      putOnShelf({ user, gist, cover, title, isFork, isPrivate, token })\n    ),\n  saveGist: ({\n    iframeVersion,\n    game,\n    token,\n    gist,\n    sprites,\n    map,\n    phrases,\n    chains,\n    songs,\n    toFork\n  }) =>\n    dispatch(\n      saveGist({\n        iframeVersion,\n        game,\n        token,\n        gist,\n        sprites,\n        map,\n        phrases,\n        chains,\n        songs,\n        toFork\n      })\n    ),\n  setNextAction: nextAction => dispatch(actions.setNextAction(nextAction)),\n  setScreen: screen => dispatch(actions.setScreen(screen))\n})\n\nclass Menu extends Component {\n  constructor(props) {\n    super(props)\n    this.keydown = this.keydown.bind(this)\n    this.onExport = this.onExport.bind(this)\n    this.onRecordClick = this.onRecordClick.bind(this)\n    this.onLoginClick = this.onLoginClick.bind(this)\n    this.onInsertBlankClick = this.onInsertBlankClick.bind(this)\n    this.onPutOnShelfClick = this.onPutOnShelfClick.bind(this)\n    this.record = this.record.bind(this)\n    this.onClose = this.onClose.bind(this)\n    this.onUpdateIframeVersion = this.onUpdateIframeVersion.bind(this)\n    window.script8.handleCode = props.fetchToken\n\n    window.addEventListener('beforeunload', this.onClose)\n  }\n\n  componentDidUpdate() {\n    const { token, nextAction, clearNextAction } = this.props\n    if (token.value && nextAction) {\n      clearNextAction()\n      if (nextAction === 'record') {\n        this.record()\n      }\n      if (nextAction === 'recordToFork') {\n        this.record(true)\n      }\n    }\n  }\n\n  keydown(event) {\n    const { screen, game, setCodeTab, setScreen, token } = this.props\n\n    const { altKey, code, metaKey, ctrlKey } = event\n\n    // If we pressed Cmd-S or Ctrl-S,\n    if (\n      (metaKey && code === 'KeyS' && _.includes(platform, 'Mac')) ||\n      (ctrlKey && code === 'KeyS' && !_.includes(platform, 'Mac'))\n    ) {\n      // and we're logged in,\n      // and we can save,\n      if (token.value && canRecord(this.props)) {\n        // save.\n        this.onRecordClick(false)\n        event.preventDefault()\n      }\n    }\n\n    // If we pressed Alt,\n    if (altKey) {\n      // and we're on the CODE screen,\n      if (screen === screenTypes.CODE) {\n        // Get the current code tab.\n        const codeTab = +getActive(game).key\n\n        // Then see if we pressed [ or ],\n        // and if so, cycle through tabs appropriately.\n        if (code === 'BracketLeft') {\n          setCodeTab((codeTab - 1 + 8) % 8)\n          event.preventDefault()\n        }\n        if (code === 'BracketRight') {\n          setCodeTab((codeTab + 1) % 8)\n          event.preventDefault()\n        }\n      }\n\n      if (code === 'Period') {\n        setScreen(getPreviousScreen(screen))\n        event.preventDefault()\n      }\n      if (code === 'Slash') {\n        setScreen(getNextScreen(screen))\n        event.preventDefault()\n      }\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.keydown)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('beforeunload', this.onClose)\n    window.removeEventListener('keydown', this.keydown)\n  }\n\n  onUpdateIframeVersion() {\n    if (\n      window.confirm(\n        'Do you really want to update to the latest SCRIPT-8 API? This change cannot be reverted.'\n      )\n    ) {\n      this.props.updateIframeVersion()\n    }\n  }\n\n  onExport() {\n    const { gist, game } = this.props\n    const title = getGameTitle(game).toUpperCase()\n    const gistId = _.get(gist, 'data.id', null)\n\n    window\n      .fetch(`https://script8.github.io/iframe-v${version}.html`)\n      .then(response => response.text())\n      .then(text => {\n        const html = text\n          .replace(\n            '<title>script-8-iframe</title>',\n            `<title>${title}</title><style>#root canvas.master { width: 100vmin; height: 100vmin; }</style>`\n          )\n          .replace(\n            '<body>',\n            `<body><script>window.SCRIPT_8_EMBEDDED_GIST_ID=\"${gistId}\";</script>`\n          )\n        downloadHtml(html)\n      })\n  }\n\n  onClose(e) {\n    const {\n      gist,\n      game,\n      sprites,\n      map,\n      phrases,\n      chains,\n      songs,\n      iframeVersion\n    } = this.props\n    const dirty = isDirty({\n      gist,\n      game,\n      sprites,\n      map,\n      phrases,\n      chains,\n      songs,\n      iframeVersion\n    })\n    if (dirty) {\n      const message = 'Leave site? Changes you made may not be saved.'\n      e.returnValue = message\n      return message\n    }\n  }\n\n  onLoginClick() {\n    const { token, clearToken } = this.props\n    const loggedIn = !!token.value\n\n    if (loggedIn) {\n      clearToken()\n    } else {\n      window.open(\n        `https://github.com/login/oauth/authorize?client_id=${process.env.REACT_APP_CLIENT_ID}&scope=gist`,\n        'popup',\n        'width=600,height=700'\n      )\n    }\n  }\n\n  onInsertBlankClick() {\n    const {\n      gist,\n      game,\n      sprites,\n      map,\n      phrases,\n      chains,\n      songs,\n      iframeVersion\n    } = this.props\n\n    const dirty = isDirty({\n      gist,\n      game,\n      sprites,\n      map,\n      phrases,\n      chains,\n      songs,\n      iframeVersion\n    })\n\n    if (\n      !dirty ||\n      window.confirm(\n        'You have not recorded the cassette. Changes will be lost. Are you sure?'\n      )\n    ) {\n      this.props.newGame(this.props.screen)\n    }\n  }\n\n  onPutOnShelfClick(isPrivate) {\n    const { putOnShelf, gist, game, token } = this.props\n\n    const gistUser = _.get(gist, 'data.owner.login', null)\n    const gistId = _.get(gist, 'data.id', null)\n    const isFork = !!_.get(gist, 'data.fork_of', null)\n\n    const title = getGameTitle(game)\n\n    const payload = {\n      user: gistUser,\n      gist: gistId,\n      title,\n      isFork,\n      isPrivate,\n      token\n    }\n\n    const iframe = document.querySelector('iframe')\n\n    if (iframe) {\n      const channel = new window.MessageChannel()\n      iframe.contentWindow.postMessage(\n        {\n          type: 'image'\n        },\n        '*',\n        [channel.port2]\n      )\n      channel.port1.onmessage = e => {\n        const { data } = e\n        putOnShelf({\n          ...payload,\n          cover: data\n        })\n      }\n    } else {\n      putOnShelf(payload)\n    }\n  }\n\n  onRecordClick(toFork) {\n    const { token, setNextAction } = this.props\n\n    if (\n      !toFork ||\n      window.confirm('Do you really want to record to a blank cassette?')\n    ) {\n      // If we're not logged in,\n      if (!token.value) {\n        // remind ourselves to record next,\n        setNextAction(toFork ? 'recordToFork' : 'record')\n\n        // and log in.\n        window.open(\n          `https://github.com/login/oauth/authorize?client_id=${process.env.REACT_APP_CLIENT_ID}&scope=gist`,\n          'popup',\n          'width=600,height=700'\n        )\n      } else {\n        // If we are logged in, record.\n        this.record(toFork)\n      }\n    }\n  }\n\n  record(toFork) {\n    const {\n      iframeVersion,\n      token,\n      game,\n      saveGist,\n      gist,\n      sprites,\n      map,\n      phrases,\n      chains,\n      songs\n    } = this.props\n    saveGist({\n      iframeVersion,\n      token,\n      game,\n      sprites,\n      map,\n      phrases,\n      chains,\n      songs,\n      gist,\n      toFork\n    })\n  }\n\n  render() {\n    const {\n      screen,\n      gist,\n      token,\n      game,\n      sprites,\n      map,\n      phrases,\n      chains,\n      songs,\n      setScreen,\n      sound,\n      toggleSound,\n      setCodeTab,\n      isFetching,\n      iframeVersion\n    } = this.props\n\n    // If the game isn't equal to the gist,\n    // set flag to dirty.\n    const dirty = isDirty({\n      gist,\n      game,\n      sprites,\n      map,\n      phrases,\n      chains,\n      songs,\n      iframeVersion\n    })\n\n    const blank = isBlank({ game, sprites, map, phrases, chains, songs })\n\n    const contentIsEmpty =\n      _.isEmpty(assembleOrderedGame(game)) &&\n      _.isEmpty(sprites) &&\n      _.isEmpty(map) &&\n      _.isEmpty(phrases) &&\n      _.isEmpty(chains) &&\n      _.isEmpty(songs)\n\n    // If gistLogin is null, gist was created anonymously.\n    const gistLogin = _.get(gist, 'data.owner.login', null)\n\n    // If gistLogin does not match currentLogin, gist wasn't created by us.\n    const currentLogin = _.get(token, 'user.login', null)\n\n    // INSERT BLANK can only be enabled when:\n    // - the gist is not empty\n    // - OR content is not NEW_GAME template\n    const enableInsertBlank = !_.isEmpty(gist) || !blank\n\n    const enableRecord = canRecord(this.props)\n\n    // RECORD TO FORK can only be enabled when:\n    // - gist is NOT empty AND\n    //    - gist is not ours (anonymous or user that is not us)\n    //    - OR there is something to save (content is non-null)\n    const enableRecordToFork =\n      !_.isEmpty(gist) &&\n      (gistLogin === null || gistLogin !== currentLogin || !contentIsEmpty)\n\n    const isMine = currentLogin && currentLogin === gistLogin\n\n    // SHELVE can only happen when:\n    // - gist is ours AND\n    // - content is NOT dirty\n    const canShelve = isMine && !dirty\n\n    const isMusicScreen = [\n      screenTypes.SONG,\n      screenTypes.CHAIN,\n      screenTypes.PHRASE\n    ].includes(screen)\n\n    const isArtScreen = [screenTypes.SPRITE, screenTypes.MAP].includes(screen)\n\n    const codeTab = getActive(game).key\n    const codeTabSuffix = screen === screenTypes.CODE ? ` ${codeTab}` : ''\n\n    const loggedIn = !!token.value\n\n    const canUpdateIframeVersion = iframeVersion && iframeVersion !== version\n\n    return (\n      <nav className=\"Menu\">\n        <ul>\n          <li>\n            <button\n              onClick={() => {\n                setScreen(screenTypes.HOME)\n              }}\n              className={classNames('button', {\n                active: screen === screenTypes.HOME\n              })}\n            >\n              <span className=\"full\">SCRIPT-8</span>\n              <span className=\"mid\">SCRIPT-8</span>\n              <span className=\"small\">\n                {screen === screenTypes.HOME ? 'script-8' : 's-8'}\n              </span>\n            </button>\n            <ul className=\"dropdown\">\n              <li>\n                <button\n                  onClick={this.onLoginClick}\n                  className=\"button\"\n                  disabled={loggedIn}\n                >\n                  Login\n                </button>\n              </li>\n              <li>\n                <button\n                  onClick={this.onLoginClick}\n                  className=\"button\"\n                  disabled={!loggedIn}\n                >\n                  Logout\n                </button>\n              </li>\n            </ul>\n          </li>\n          <li>\n            <button className=\"button\">\n              <span className=\"full\">cassette</span>\n              <span className=\"mid\">cas</span>\n              <span className=\"small\">ca</span>\n              <span className={classNames({ invisible: !dirty })}>*</span>\n            </button>\n            <ul className=\"dropdown\">\n              <li>\n                <button\n                  onClick={this.onInsertBlankClick}\n                  className=\"button\"\n                  disabled={!enableInsertBlank}\n                >\n                  Insert new\n                </button>\n              </li>\n\n              <li>\n                <button\n                  onClick={() => {\n                    this.onRecordClick(false)\n                  }}\n                  className=\"button\"\n                  disabled={!enableRecord}\n                >\n                  Record\n                </button>\n              </li>\n\n              <li>\n                <button\n                  onClick={() => {\n                    this.onRecordClick(true)\n                  }}\n                  className=\"button\"\n                  disabled={!enableRecordToFork}\n                >\n                  Record to blank\n                </button>\n              </li>\n\n              <li>\n                <button\n                  onClick={() => {\n                    this.onPutOnShelfClick(true)\n                  }}\n                  disabled={!canShelve}\n                  className=\"button\"\n                >\n                  Put on private shelf\n                </button>\n              </li>\n              <li>\n                <button\n                  onClick={() => {\n                    this.onPutOnShelfClick(false)\n                  }}\n                  disabled={!canShelve}\n                  className=\"button\"\n                >\n                  Put on public shelf\n                </button>\n              </li>\n              <li>\n                {isMine ? (\n                  <button\n                    onClick={this.onExport}\n                    disabled={!canShelve}\n                    className=\"button\"\n                  >\n                    Export to HTML\n                  </button>\n                ) : null}\n              </li>\n              <li>\n                {canUpdateIframeVersion ? (\n                  <button\n                    onClick={this.onUpdateIframeVersion}\n                    className=\"button\"\n                  >\n                    UPDATE SCRIPT-8 API\n                  </button>\n                ) : null}\n              </li>\n            </ul>\n          </li>\n\n          <li>\n            <button\n              onClick={() => {\n                setScreen(screenTypes.CODE)\n              }}\n              className={classNames('button', {\n                active: screen === screenTypes.CODE\n              })}\n            >\n              <span className=\"full\">CODE{codeTabSuffix}</span>\n              <span className=\"mid\">\n                {screen === screenTypes.CODE\n                  ? `code${codeTabSuffix}`\n                  : `cod${codeTabSuffix}`}\n              </span>\n              <span className=\"small\">\n                {screen === screenTypes.CODE\n                  ? `code${codeTabSuffix}`\n                  : `co${codeTabSuffix}`}\n              </span>\n            </button>\n            <ul className=\"dropdown\">\n              {_.range(8).map(d => (\n                <li key={d}>\n                  <button\n                    className=\"button\"\n                    onClick={() => {\n                      setCodeTab(d)\n                      setScreen(screenTypes.CODE)\n                    }}\n                  >\n                    CODE {d}\n                  </button>\n                </li>\n              ))}\n            </ul>\n          </li>\n\n          <li>\n            <button\n              onClick={() => {\n                setScreen(screenTypes.SPRITE)\n              }}\n              className={classNames('button', {\n                active: isArtScreen\n              })}\n            >\n              <span className=\"full\">{isArtScreen ? screen : 'ART'}</span>\n              <span className=\"mid\">{isArtScreen ? screen : 'ART'}</span>\n              <span className=\"small\">\n                {isArtScreen ? screen.substring(0, 2) : 'AR'}\n              </span>\n            </button>\n            <ul className=\"dropdown\">\n              <li>\n                <button\n                  onClick={() => {\n                    setScreen(screenTypes.SPRITE)\n                  }}\n                  className={classNames('button', {\n                    active: screen === screenTypes.SPRITE\n                  })}\n                >\n                  SPRITE\n                </button>\n              </li>\n\n              <li>\n                <button\n                  onClick={() => {\n                    setScreen(screenTypes.MAP)\n                  }}\n                  className={classNames('button', {\n                    active: screen === screenTypes.MAP\n                  })}\n                >\n                  MAP\n                </button>\n              </li>\n            </ul>\n          </li>\n\n          <li>\n            <button\n              onClick={() => {\n                setScreen(screenTypes.PHRASE)\n              }}\n              className={classNames('button', {\n                active: isMusicScreen\n              })}\n            >\n              <span className=\"full\">{isMusicScreen ? screen : 'music'}</span>\n              <span className=\"mid\">{isMusicScreen ? screen : 'mus'}</span>\n              <span className=\"small\">\n                {isMusicScreen ? screen.substring(0, 2) : 'mu'}\n              </span>\n            </button>\n            <ul className=\"dropdown\">\n              <li>\n                <button\n                  onClick={() => {\n                    setScreen(screenTypes.PHRASE)\n                  }}\n                  className={classNames('button', {\n                    active: screen === screenTypes.PHRASE\n                  })}\n                >\n                  PHRASE\n                </button>\n              </li>\n\n              <li>\n                <button\n                  onClick={() => {\n                    setScreen(screenTypes.CHAIN)\n                  }}\n                  className={classNames('button', {\n                    active: screen === screenTypes.CHAIN\n                  })}\n                >\n                  CHAIN\n                </button>\n              </li>\n\n              <li>\n                <button\n                  onClick={() => {\n                    setScreen(screenTypes.SONG)\n                  }}\n                  className={classNames('button', {\n                    active: screen === screenTypes.SONG\n                  })}\n                >\n                  SONG\n                </button>\n              </li>\n            </ul>\n          </li>\n\n          <li>\n            <button\n              onClick={() => {\n                setScreen(screenTypes.HELP)\n              }}\n              className={classNames('button', {\n                active: screen === screenTypes.HELP\n              })}\n            >\n              <span className=\"full\">HELP</span>\n              <span className=\"mid\">\n                {screen === screenTypes.HELP ? 'help' : 'hel'}\n              </span>\n              <span className=\"small\">\n                {screen === screenTypes.HELP ? 'help' : 'he'}\n              </span>\n            </button>\n          </li>\n\n          <li>\n            <button\n              onClick={() => {\n                setScreen(screenTypes.SHELF)\n              }}\n              className={classNames('button', {\n                active: screen === screenTypes.SHELF\n              })}\n            >\n              <span className=\"full\">SHELF</span>\n              <span className=\"mid\">\n                {screen === screenTypes.SHELF ? 'shelf' : 'she'}\n              </span>\n              <span className=\"small\">\n                {screen === screenTypes.SHELF ? 'shelf' : 'sh'}\n              </span>\n            </button>\n          </li>\n\n          <li>\n            <button\n              onClick={() => {\n                setScreen(screenTypes.RUN)\n              }}\n              className={classNames('button', {\n                active: screen === screenTypes.RUN\n              })}\n            >\n              <span className=\"full\">RUN</span>\n              <span className=\"mid\">run</span>\n              <span className=\"small\">\n                {screen === screenTypes.RUN ? 'run' : 'ru'}\n              </span>\n            </button>\n          </li>\n\n          <li\n            className={classNames({\n              hide: screen !== screenTypes.RUN\n            })}\n          >\n            <button onClick={toggleSound} className=\"button\">\n              <span className=\"full\">{sound ? '' : 'un'}mute</span>\n              <span className=\"mid\">{sound ? '' : 'un'}mute</span>\n              <span className=\"small\">{sound ? '' : 'un'}mute</span>\n            </button>\n          </li>\n        </ul>\n        <ul>\n          <li>\n            <button\n              className={classNames('button', 'title', {\n                'is-fetching': isFetching\n              })}\n            >\n              <span>load</span>\n            </button>\n          </li>\n        </ul>\n      </nav>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Menu)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Updater from '../containers/Updater.js'\nimport Menu from '../containers/Menu.js'\n\nconst TopBar = ({ hideMenu }) => (\n  <div\n    className={classNames('TopBar', {\n      show: !hideMenu\n    })}\n  >\n    <Updater />\n    <Menu />\n  </div>\n)\n\nTopBar.propTypes = {\n  hideMenu: PropTypes.bool\n}\n\nexport default TopBar\n","import React, { Component } from 'react'\n\nclass ErrorBoundary extends Component {\n  constructor (props) {\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  componentDidCatch (error, errorInfo) {\n    this.setState({\n      error,\n      errorInfo\n    })\n  }\n\n  render () {\n    const { error, errorInfo } = this.state\n    if (errorInfo) {\n      // Error path\n      return (\n        <div className='ErrorBoundary'>\n          <h2>Something went wrong.</h2>\n          <details style={{ whiteSpace: 'pre-wrap' }}>\n            {error && error.toString()}\n            <br />\n            {errorInfo.componentStack}\n          </details>\n        </div>\n      )\n    }\n    // Normally, just render children\n    return this.props.children\n  }\n}\n\nexport default ErrorBoundary\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport includes from 'lodash/includes'\nimport classNames from 'classnames'\nimport _ from 'lodash'\nimport Boot from './Boot.js'\nimport Home from './Home.js'\nimport Output from './Output.js'\nimport Sprite from './Sprite.js'\nimport Map from './Map.js'\nimport Phrase from './Phrase.js'\nimport Chain from './Chain.js'\nimport Song from './Song.js'\nimport Tutorial from './Tutorial.js'\nimport Run from './Run.js'\nimport Code from './Code.js'\nimport Help from './Help.js'\nimport Shelf from './Shelf.js'\nimport Notice from './Notice.js'\nimport TopBar from '../components/TopBar.js'\nimport ErrorBoundary from '../components/ErrorBoundary.js'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\nimport notices from '../utils/notices.json'\nimport { version } from '../iframe/package.json'\nimport '../css/App.css'\n\nconsole.log(JSON.stringify(`SCRIPT-8 app v ${version}`, null, 2))\n\nconst mapStateToProps = ({\n  screen,\n  tutorial,\n  dismissedNotices,\n  token,\n  hideMenu\n}) => ({\n  screen,\n  tutorial,\n  dismissedNotices,\n  token,\n  hideMenu\n})\n\nconst mapDispatchToProps = () => ({})\n\n// Show notice only if:\n// - we're logged in\n// - we're the owner of this cassette\n// - there is at least one notice we haven't dismissed\nconst shouldShowNotice = props => {\n  const { gist, token } = props\n\n  // If gistLogin is null, gist was created anonymously.\n  const gistLogin = _.get(gist, 'data.owner.login', null)\n\n  // If gistLogin does not match currentLogin, gist wasn't created by us.\n  const currentLogin = _.get(token, 'user.login', null)\n\n  // Are we owner of this cassette?\n  const isMine = currentLogin && currentLogin === gistLogin\n\n  // Is there at least one notice we haven't dismissed?\n  const newNoticeIds = _.difference(\n    notices.map(d => d.id),\n    props.dismissedNotices\n  )\n\n  return isMine && newNoticeIds.length\n}\n\nconst options = {\n  [screenTypes.BOOT]: () => <Boot />,\n  [screenTypes.HOME]: () => <Home />,\n  [screenTypes.SPRITE]: () => <Sprite />,\n  [screenTypes.MAP]: () => <Map />,\n  [screenTypes.PHRASE]: () => <Phrase />,\n  [screenTypes.CHAIN]: () => <Chain />,\n  [screenTypes.SONG]: () => <Song />,\n  [screenTypes.RUN]: () => <Run />,\n  [screenTypes.CODE]: () => <Code />,\n  [screenTypes.HELP]: () => <Help />,\n  [screenTypes.SHELF]: () => <Shelf />\n}\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n    this.tutorialElement = React.createRef()\n    this.appElement = null\n    this.setAppElementRef = e => {\n      this.appElement = e\n    }\n  }\n\n  componentDidUpdate() {\n    // Get the tutorial's height and set App's padding-bottom to this.\n    if (this.tutorialElement && this.tutorialElement.current) {\n      const { clientHeight } = this.tutorialElement.current\n      this.appElement.style.paddingBottom = `${clientHeight}px`\n    } else {\n      this.appElement.style.paddingBottom = '0'\n    }\n\n    const showNotice = shouldShowNotice(this.props)\n\n    if (showNotice) {\n      document.body.classList.add('overflow-hidden')\n    } else {\n      document.body.classList.remove('overflow-hidden')\n    }\n  }\n\n  render() {\n    const { screen, tutorial, hideMenu } = this.props\n\n    const showNotice = shouldShowNotice(this.props)\n\n    return (\n      <ErrorBoundary>\n        <div\n          ref={this.setAppElementRef}\n          className={classNames('App', `App-${screen}`, {\n            'full-height': includes(\n              [screenTypes.BOOT, screenTypes.RUN, screenTypes.CODE],\n              screen\n            )\n          })}\n        >\n          <TopBar hideMenu={hideMenu} />\n          {options[screen]()}\n          <Output />\n          {tutorial ? (\n            <Tutorial\n              className={classNames({\n                'in-RUN': screen === screenTypes.RUN\n              })}\n              tutorialRef={this.tutorialElement}\n            />\n          ) : null}\n          {showNotice ? <Notice /> : null}\n        </div>\n      </ErrorBoundary>\n    )\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App)\n","import * as Tone from 'tone'\nimport { handleActions } from 'redux-actions'\nimport includes from 'lodash/includes'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst screen = handleActions(\n  {\n    [actionTypes.SET_SCREEN]: (state, action) => {\n      if (\n        includes(\n          [\n            screenTypes.PHRASE,\n            screenTypes.CHAIN,\n            screenTypes.SONG,\n            screenTypes.RUN\n          ],\n          action.payload\n        )\n      ) {\n        if (\n          Tone &&\n          Tone.context &&\n          Tone.context.state &&\n          Tone.context.state !== 'running'\n        ) {\n          Tone.start()\n        }\n      }\n      return action.payload\n    }\n  },\n  initialState.screen\n)\n\nexport default screen\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst gist = handleActions(\n  {\n    [actionTypes.NEW_GAME]: () => {},\n    [actionTypes.FETCH_GIST_REQUEST]: () => ({\n      isFetching: true\n    }),\n    [actionTypes.FETCH_GIST_SUCCESS]: (state, action) => ({\n      isFetching: false,\n      data: action.payload\n    }),\n    [actionTypes.SAVE_GIST_REQUEST]: state => ({\n      data: state.data,\n      isFetching: true\n    }),\n    [actionTypes.SAVE_GIST_SUCCESS]: (state, action) => ({\n      isFetching: false,\n      data: action.payload\n    })\n  },\n  initialState.gist\n)\n\nexport default gist\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst booted = handleActions(\n  {\n    [actionTypes.FINISH_BOOT]: (state, action) => true\n  },\n  initialState.booted\n)\n\nexport default booted\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst token = handleActions(\n  {\n    [actionTypes.CLEAR_TOKEN]: () => initialState.token,\n    [actionTypes.TOKEN_REQUEST]: () => ({\n      isFetching: true\n    }),\n    [actionTypes.TOKEN_SUCCESS]: (state, action) => ({\n      value: action.payload.token,\n      user: action.payload.user\n    })\n  },\n  initialState.token\n)\n\nexport default token\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst nextAction = handleActions(\n  {\n    [actionTypes.SET_NEXT_ACTION]: (state, action) => action.payload,\n    [actionTypes.CLEAR_NEXT_ACTION]: () => null\n  },\n  initialState.nextAction\n)\n\nexport default nextAction\n","import omitEmpty from 'omit-empty'\nimport { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\nimport { extractGistSprites } from '../iframe/src/gistParsers/sprites.js'\n\nconst sprites = handleActions(\n  {\n    [actionTypes.NEW_GAME]: () => initialState.sprites,\n    [actionTypes.FETCH_GIST_SUCCESS]: (state, action) =>\n      extractGistSprites(action.payload),\n    [actionTypes.UPDATE_SPRITE]: (state, { payload }) => {\n      const { sprite } = payload\n      return omitEmpty({\n        ...state,\n        [payload.index]:\n          sprite && sprite.slice(0, 8).filter(d => d !== '        ').length\n            ? sprite\n            : null\n      })\n    }\n  },\n  initialState.sprites\n)\n\nexport default sprites\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\nimport { extractGistMap } from '../iframe/src/gistParsers/map.js'\n\nconst map = handleActions(\n  {\n    [actionTypes.NEW_GAME]: () => initialState.map,\n    [actionTypes.FETCH_GIST_SUCCESS]: (state, action) =>\n      extractGistMap(action.payload),\n    [actionTypes.UPDATE_MAP]: (state, action) => action.payload\n  },\n  initialState.map\n)\n\nexport default map\n","import _ from 'lodash'\nimport omitEmpty from 'omit-empty'\nimport { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\nimport { extractGistPhrases } from '../iframe/src/gistParsers/phrases.js'\n\nconst phrases = handleActions(\n  {\n    [actionTypes.NEW_GAME]: () => initialState.phrases,\n    [actionTypes.FETCH_GIST_SUCCESS]: (state, action) =>\n      extractGistPhrases(action.payload),\n    [actionTypes.UPDATE_PHRASE]: (state, { payload }) => {\n      const { index, phrase } = payload\n      return omitEmpty({\n        ...state,\n        [index]:\n          phrase &&\n          !_.isEmpty(phrase.notes) &&\n          Object.values(phrase.notes).filter(d => !_.isNil(d)).length\n            ? phrase\n            : null\n      })\n    }\n  },\n  initialState.phrases\n)\n\nexport default phrases\n","import omitEmpty from 'omit-empty'\nimport { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\nimport { extractGistChains } from '../iframe/src/gistParsers/chains.js'\n\nconst chains = handleActions(\n  {\n    [actionTypes.NEW_GAME]: () => initialState.chains,\n    [actionTypes.FETCH_GIST_SUCCESS]: (state, action) =>\n      extractGistChains(action.payload),\n    [actionTypes.UPDATE_CHAIN]: (state, { payload }) =>\n      omitEmpty({\n        ...state,\n        [payload.index]: payload.chain\n      })\n  },\n  initialState.chains\n)\n\nexport default chains\n","import omitEmpty from 'omit-empty'\nimport { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\nimport { extractGistSongs } from '../iframe/src/gistParsers/songs.js'\n\nconst songs = handleActions(\n  {\n    [actionTypes.NEW_GAME]: () => initialState.songs,\n    [actionTypes.FETCH_GIST_SUCCESS]: (state, action) =>\n      extractGistSongs(action.payload),\n    [actionTypes.UPDATE_SONG]: (state, { payload }) =>\n      omitEmpty({\n        ...state,\n        [payload.index]: payload.song\n      })\n  },\n  initialState.songs\n)\n\nexport default songs\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst tutorial = handleActions(\n  {\n    [actionTypes.CLOSE_TUTORIAL]: () => null,\n    [actionTypes.SET_TUTORIAL_SLIDE]: (state, action) => action.payload\n  },\n  initialState.tutorial\n)\n\nexport default tutorial\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst sound = handleActions(\n  {\n    [actionTypes.TOGGLE_SOUND]: (state, action) => !state\n  },\n  initialState.sound\n)\n\nexport default sound\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst shelving = handleActions(\n  {\n    [actionTypes.UNSHELVE_CASSETTE_REQUEST]: () => true,\n    [actionTypes.UNSHELVE_CASSETTE_SUCCESS]: () => false,\n    [actionTypes.SHELVE_CASSETTE_REQUEST]: () => true,\n    [actionTypes.SHELVE_CASSETTE_SUCCESS]: () => false,\n    [actionTypes.SET_VISIBILITY_REQUEST]: () => true,\n    [actionTypes.SET_VISIBILITY_SUCCESS]: () => false\n  },\n  initialState.shelving\n)\n\nexport default shelving\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst docHistories = handleActions(\n  {\n    [actionTypes.NEW_GAME]: () => initialState.docHistories,\n    [actionTypes.UPDATE_HISTORY]: (state, { payload }) => ({\n      ...state,\n      [payload.index]: payload.history\n    })\n  },\n  initialState.docHistories\n)\n\nexport default docHistories\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst dismissedNotices = handleActions(\n  {\n    [actionTypes.DISMISS_NOTICES]: (state, { payload }) => [...payload]\n  },\n  initialState.dismissedNotices\n)\n\nexport default dismissedNotices\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst selectedUi = handleActions(\n  {\n    [actionTypes.SELECT_UI]: (state, { payload }) => ({\n      ...payload\n    })\n  },\n  initialState.selectedUi\n)\n\nexport default selectedUi\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\n\nconst errorLine = handleActions(\n  {\n    [actionTypes.SET_ERROR_LINE]: (state, action) => action.payload\n  },\n  initialState.errorLine\n)\n\nexport default errorLine\n","import { handleActions } from 'redux-actions'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\nimport { parseGistIframeVersion } from '../iframe/src/gistParsers/iframeVersion.js'\n\nconst iframeVersion = handleActions(\n  {\n    [actionTypes.UPDATE_IFRAME_VERSION]: () => initialState.iframeVersion,\n    [actionTypes.NEW_GAME]: () => initialState.iframeVersion,\n    [actionTypes.FETCH_GIST_SUCCESS]: (state, action) =>\n      parseGistIframeVersion(action.payload)\n  },\n  initialState.iframeVersion\n)\n\nexport default iframeVersion\n","import { handleActions } from 'redux-actions'\nimport includes from 'lodash/includes'\nimport actionTypes from '../actions/actionTypes.js'\nimport initialState from '../iframe/src/store/initialState.js'\nimport screenTypes from '../iframe/src/utils/screenTypes.js'\n\nconst hideMenu = handleActions(\n  {\n    [actionTypes.TOGGLE_MENU]: (state, action) => !state,\n    [actionTypes.SET_SCREEN]: (state, action) => {\n      if (!includes([screenTypes.BOOT, screenTypes.RUN], action.payload)) {\n        return false\n      } else {\n        return state\n      }\n    }\n  },\n  initialState.hideMenu\n)\n\nexport default hideMenu\n","import { combineReducers } from 'redux'\nimport screen from './screen.js'\nimport gist from './gist.js'\nimport booted from './booted.js'\nimport game from './game.js'\nimport token from './token.js'\nimport nextAction from './nextAction.js'\nimport sprites from './sprites.js'\nimport map from './map.js'\nimport phrases from './phrases.js'\nimport chains from './chains.js'\nimport songs from './songs.js'\nimport tutorial from './tutorial.js'\nimport sound from './sound.js'\nimport shelving from './shelving.js'\nimport docHistories from './docHistories.js'\nimport dismissedNotices from './dismissedNotices.js'\nimport selectedUi from './selectedUi.js'\nimport errorLine from './errorLine.js'\nimport iframeVersion from './iframeVersion.js'\nimport hideMenu from './hideMenu.js'\n\nconst reducer = combineReducers({\n  hideMenu,\n  iframeVersion,\n  errorLine,\n  screen,\n  gist,\n  booted,\n  token,\n  game,\n  nextAction,\n  sprites,\n  map,\n  phrases,\n  chains,\n  songs,\n  tutorial,\n  sound,\n  shelving,\n  docHistories,\n  dismissedNotices,\n  selectedUi\n})\n\nexport default reducer\n","import thunkMiddleware from 'redux-thunk'\nimport { createStore, applyMiddleware, compose } from 'redux'\nimport reducer from '../reducers/reducer.js'\nimport { loadState, saveState } from './localStorage.js'\n// import setupSocket from './setupSocket.js'\n\nconst persistedState = loadState()\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\n\nconst store = createStore(\n  reducer,\n  persistedState,\n  composeEnhancers(applyMiddleware(thunkMiddleware))\n)\n\n// if (process.env.NODE_ENV !== 'production') {\n//   setupSocket(store.dispatch)\n// }\n\nstore.subscribe(() => {\n  saveState({\n    token: store.getState().token,\n    dismissedNotices: store.getState().dismissedNotices\n  })\n})\n\nexport default store\n","const key = 'script-8-1'\n\nconst loadState = () => {\n  try {\n    const serializedState = localStorage.getItem(key)\n    if (serializedState === null) {\n      return undefined\n    }\n    return JSON.parse(serializedState)\n  } catch (error) {\n    return undefined\n  }\n}\n\nconst saveState = state => {\n  try {\n    const serializedState = JSON.stringify(state)\n    localStorage.setItem(key, serializedState)\n  } catch (error) {\n    console.error(error)\n  }\n}\n\nexport { loadState, saveState }\n","import React from 'react'\nimport { render } from 'react-dom'\nimport { Provider } from 'react-redux'\nimport App from './containers/App.js'\nimport store from './store/store.js'\n\nwindow.script8 = window.script8 || {}\n\nrender(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n)\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlAAAAAoCAIAAAC+blOXAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBQTRCNkU3RDBEOTExMUU5Qjk3MkFERTEyRkI4RjBCQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBQTRCNkU3RTBEOTExMUU5Qjk3MkFERTEyRkI4RjBCQSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkFBNEI2RTdCMEQ5MTExRTlCOTcyQURFMTJGQjhGMEJBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkFBNEI2RTdDMEQ5MTExRTlCOTcyQURFMTJGQjhGMEJBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+HvluxAAAAUhJREFUeNrs3TFOQkEQgGEwL7RIaAxHsJDiWXsZzsVJ6Kx5hRYcwdAQpDKhorGE4pFZ1sHvKzGZLFL82WKyw5/NahBh8rY4+/n+fWn+Hc8vLfv5a4n6v3VdFzJn87kPmbPdHUPmrL9izvNx+A6ZMx8/hsx5nU1C5jxNRyFznl9iztO2bcichwEA/AOCB4DgAYDgAYDgAYDgAYDgAUAJzaU/lN5bqjW/735S3zlR3yv7+UsrvXcIuOEBgOABgOABgOABgOABgOABgOABwK+Le3hR+161ZN8zy7JPVuu9Ovt2gBseAAgeAIIHAIIHAIIHAIIHAIIHADfS3Ov+U/Z34LK/S/fXfl8ANzwABA8ABA8ABA8ABA8ABA8ABA8ArtTU2lvK8t5e33Nmf4cvC/t2gBseAAgeAIIHAIIHAIIHAIIHAIIHADdyEmAARD5eRI/K+WsAAAAASUVORK5CYII=\""],"sourceRoot":""}